<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.0.0"/>
    <title>src.fairreckitlib.data.set.processor.dataset_processor_lfm360k API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../processor.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;src.fairreckitlib.data.set.processor</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#DatasetProcessorLFM360K">DatasetProcessorLFM360K</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DatasetProcessorLFM360K.__init__">DatasetProcessorLFM360K</a>
                        </li>
                        <li>
                                <a class="function" href="#DatasetProcessorLFM360K.create_listening_events_config">create_listening_events_config</a>
                        </li>
                        <li>
                                <a class="function" href="#DatasetProcessorLFM360K.create_user_table_config">create_user_table_config</a>
                        </li>
                        <li>
                                <a class="function" href="#DatasetProcessorLFM360K.get_matrix_configs">get_matrix_configs</a>
                        </li>
                        <li>
                                <a class="function" href="#DatasetProcessorLFM360K.get_table_configs">get_table_configs</a>
                        </li>
                        <li>
                                <a class="function" href="#DatasetProcessorLFM360K.load_artist_gender_json">load_artist_gender_json</a>
                        </li>
                        <li>
                                <a class="function" href="#DatasetProcessorLFM360K.load_user_table">load_user_table</a>
                        </li>
                        <li>
                                <a class="function" href="#DatasetProcessorLFM360K.process_artist_table">process_artist_table</a>
                        </li>
                        <li>
                                <a class="function" href="#DatasetProcessorLFM360K.process_user_artist_matrix">process_user_artist_matrix</a>
                        </li>
                        <li>
                                <a class="function" href="#DatasetProcessorLFM360K.process_user_table">process_user_table</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
src<wbr>.<a href="./../../../../fairreckitlib.html">fairreckitlib</a><wbr>.<a href="./../../../data.html">data</a><wbr>.<a href="./../../set.html">set</a><wbr>.<a href="./../processor.html">processor</a><wbr>.dataset_processor_lfm360k    </h1>

                        <div class="docstring"><p>This modules contains the class to process the LastFM-360K dataset.</p>

<p>Classes:</p>

<pre><code>DatasetProcessorLFM360K: data processor implementation for the LFM-360K dataset.
</code></pre>

<p>This program has been developed by students from the bachelor Computer Science at
Utrecht University within the Software Project course.
© Copyright Utrecht University (Department of Information and Computing Sciences)</p>
</div>

                        <input id="dataset_processor_lfm360k-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="dataset_processor_lfm360k-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;This modules contains the class to process the LastFM-360K dataset.</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">Classes:</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">    DatasetProcessorLFM360K: data processor implementation for the LFM-360K dataset.</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">This program has been developed by students from the bachelor Computer Science at</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">Utrecht University within the Software Project course.</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">© Copyright Utrecht University (Department of Information and Computing Sciences)</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">from</span> <span class="nn">..dataset_config</span> <span class="kn">import</span> <span class="n">create_dataset_table_config</span><span class="p">,</span> <span class="n">DatasetMatrixConfig</span><span class="p">,</span> <span class="n">DatasetTableConfig</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span> <span class="nn">..dataset_constants</span> <span class="kn">import</span> <span class="n">TABLE_FILE_PREFIX</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span> <span class="nn">.dataset_processor_lfm</span> <span class="kn">import</span> <span class="n">DatasetProcessorLFM</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="k">class</span> <span class="nc">DatasetProcessorLFM360K</span><span class="p">(</span><span class="n">DatasetProcessorLFM</span><span class="p">):</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>    <span class="sd">&quot;&quot;&quot;DatasetProcessor for the LastFM-360K dataset.</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">    The dataset can be downloaded from the website below.</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    https://www.upf.edu/web/mtg/lastfm360k</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">    The enriched artist gender information can be retrieved from:</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    https://zenodo.org/record/3748787#.YowEBqhByUk</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    The processor handles the following files:</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">    usersha1-artmbid-artname-plays.tsv (required)</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">    usersha1-profile.tsv (optional)</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">    lfm-360-gender.json (optional)</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>        <span class="sd">&quot;&quot;&quot;Construct the DatasetProcessorLFM360K.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        Args:</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">            dataset_name: path of the dataset directory.</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">            dataset_name: name of the dataset (processor).</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>        <span class="n">DatasetProcessorLFM</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>        <span class="c1"># buffer for the user sha and artist name lists</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">user_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>        <span class="c1"># buffer for the artist name/musicbrainzID dataframe</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>    <span class="k">def</span> <span class="nf">create_listening_events_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetTableConfig</span><span class="p">]:</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        <span class="sd">&quot;&quot;&quot;Create the listening event table configuration.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">        No listening events are available for this dataset.</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">        Returns:</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">            None.</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>    <span class="k">def</span> <span class="nf">create_user_table_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetTableConfig</span><span class="p">:</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>        <span class="sd">&quot;&quot;&quot;Create the user table configuration.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        The base user configuration that contains the generated user ids</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        and corresponding user sha.</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        Returns:</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">            the configuration of the user table.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="k">return</span> <span class="n">create_dataset_table_config</span><span class="p">(</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>            <span class="n">TABLE_FILE_PREFIX</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s1">&#39;_users.tsv.bz2&#39;</span><span class="p">,</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>            <span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">],</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>            <span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">],</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>            <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;bz2&#39;</span><span class="p">,</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>            <span class="n">num_records</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_list</span><span class="p">)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>        <span class="p">)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="k">def</span> <span class="nf">get_matrix_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetMatrixConfig</span><span class="p">]]]]:</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>        <span class="sd">&quot;&quot;&quot;Get matrix configuration processors.</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">        Returns:</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">            a list containing the user-artist-count matrix processor.</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>        <span class="k">return</span> <span class="p">[(</span><span class="s1">&#39;user-artist-count&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_user_artist_matrix</span><span class="p">)]</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>    <span class="k">def</span> <span class="nf">get_table_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetTableConfig</span><span class="p">]]]]:</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="sd">&quot;&quot;&quot;Get table configuration processors.</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">        Returns:</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">            a list containing the artist and user table processors.</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>        <span class="k">return</span> <span class="n">DatasetProcessorLFM</span><span class="o">.</span><span class="n">get_table_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="p">[(</span><span class="s1">&#39;artist&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">process_artist_table</span><span class="p">)]</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    <span class="k">def</span> <span class="nf">load_artist_gender_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>        <span class="sd">&quot;&quot;&quot;Load the artist gender json file.</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        Returns:</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">            the loaded artist musicbrainzID/gender table or None on failure.</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>            <span class="n">gender_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="s1">&#39;lfm-360-gender.json&#39;</span><span class="p">),</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>                <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>            <span class="p">)</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>            <span class="n">gender_table</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>            <span class="n">gender_table</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;artist_mbID&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;artist_gender&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>            <span class="k">return</span> <span class="n">gender_table</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>    <span class="k">def</span> <span class="nf">load_user_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>        <span class="sd">&quot;&quot;&quot;Load the original user table.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">        Changes the contents of the age and gender columns to be more user-friendly,</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">        and the contents of the country column to ISO 3166 Alpha-2 country codes.</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">        Returns:</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">            the loaded user table on None on failure.</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>        <span class="n">user_table_columns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>            <span class="s1">&#39;user_sha&#39;</span><span class="p">,</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>            <span class="s1">&#39;user_gender&#39;</span><span class="p">,</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>            <span class="s1">&#39;user_age&#39;</span><span class="p">,</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>            <span class="s1">&#39;user_country&#39;</span><span class="p">,</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>            <span class="s1">&#39;user_signup&#39;</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="p">]</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>            <span class="c1"># load original user table</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>            <span class="n">user_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="s1">&#39;usersha1-profile.tsv&#39;</span><span class="p">),</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>                <span class="n">names</span><span class="o">=</span><span class="n">user_table_columns</span><span class="p">,</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>                <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>            <span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="c1"># mask user age not between 1-100 as NaN</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>        <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="c1"># convert gender to more user-friendly names</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>        <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="s1">&#39;Female&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>        <span class="c1"># convert country to ISO 3166 Alpha-2 country code</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>            <span class="s1">&#39;Afghanistan&#39;</span><span class="p">:</span> <span class="s1">&#39;AF&#39;</span><span class="p">,</span> <span class="s1">&#39;Albania&#39;</span><span class="p">:</span> <span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;Algeria&#39;</span><span class="p">:</span> <span class="s1">&#39;DZ&#39;</span><span class="p">,</span> <span class="s1">&#39;American Samoa&#39;</span><span class="p">:</span> <span class="s1">&#39;AS&#39;</span><span class="p">,</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>            <span class="s1">&#39;Andorra&#39;</span><span class="p">:</span> <span class="s1">&#39;AD&#39;</span><span class="p">,</span> <span class="s1">&#39;Angola&#39;</span><span class="p">:</span> <span class="s1">&#39;AO&#39;</span><span class="p">,</span> <span class="s1">&#39;Anguilla&#39;</span><span class="p">:</span> <span class="s1">&#39;AI&#39;</span><span class="p">,</span> <span class="s1">&#39;Antarctica&#39;</span><span class="p">:</span> <span class="s1">&#39;AQ&#39;</span><span class="p">,</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>            <span class="s1">&#39;Antigua and Barbuda&#39;</span><span class="p">:</span> <span class="s1">&#39;AG&#39;</span><span class="p">,</span> <span class="s1">&#39;Argentina&#39;</span><span class="p">:</span> <span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;Armenia&#39;</span><span class="p">:</span> <span class="s1">&#39;AM&#39;</span><span class="p">,</span> <span class="s1">&#39;Aruba&#39;</span><span class="p">:</span> <span class="s1">&#39;AW&#39;</span><span class="p">,</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>            <span class="s1">&#39;Australia&#39;</span><span class="p">:</span> <span class="s1">&#39;AU&#39;</span><span class="p">,</span> <span class="s1">&#39;Austria&#39;</span><span class="p">:</span> <span class="s1">&#39;AT&#39;</span><span class="p">,</span> <span class="s1">&#39;Azerbaijan&#39;</span><span class="p">:</span> <span class="s1">&#39;AZ&#39;</span><span class="p">,</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>            <span class="s1">&#39;Bahamas&#39;</span><span class="p">:</span> <span class="s1">&#39;BS&#39;</span><span class="p">,</span> <span class="s1">&#39;Bahrain&#39;</span><span class="p">:</span> <span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="s1">&#39;Bangladesh&#39;</span><span class="p">:</span> <span class="s1">&#39;BD&#39;</span><span class="p">,</span> <span class="s1">&#39;Barbados&#39;</span><span class="p">:</span> <span class="s1">&#39;BB&#39;</span><span class="p">,</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>            <span class="s1">&#39;Belarus&#39;</span><span class="p">:</span> <span class="s1">&#39;BY&#39;</span><span class="p">,</span> <span class="s1">&#39;Belgium&#39;</span><span class="p">:</span> <span class="s1">&#39;BE&#39;</span><span class="p">,</span> <span class="s1">&#39;Belize&#39;</span><span class="p">:</span> <span class="s1">&#39;BZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Benin&#39;</span><span class="p">:</span> <span class="s1">&#39;BJ&#39;</span><span class="p">,</span> <span class="s1">&#39;Bermuda&#39;</span><span class="p">:</span> <span class="s1">&#39;BM&#39;</span><span class="p">,</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>            <span class="s1">&#39;Bhutan&#39;</span><span class="p">:</span> <span class="s1">&#39;BT&#39;</span><span class="p">,</span> <span class="s1">&#39;Bolivia&#39;</span><span class="p">:</span> <span class="s1">&#39;BO&#39;</span><span class="p">,</span> <span class="s1">&#39;Bosnia and Herzegovina&#39;</span><span class="p">:</span> <span class="s1">&#39;BA&#39;</span><span class="p">,</span> <span class="s1">&#39;Botswana&#39;</span><span class="p">:</span> <span class="s1">&#39;BW&#39;</span><span class="p">,</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>            <span class="s1">&#39;Bouvet Island&#39;</span><span class="p">:</span> <span class="s1">&#39;BV&#39;</span><span class="p">,</span> <span class="s1">&#39;Brazil&#39;</span><span class="p">:</span> <span class="s1">&#39;BR&#39;</span><span class="p">,</span> <span class="s1">&#39;British Indian Ocean Territory&#39;</span><span class="p">:</span> <span class="s1">&#39;IO&#39;</span><span class="p">,</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>            <span class="s1">&#39;Brunei Darussalam&#39;</span><span class="p">:</span> <span class="s1">&#39;BN&#39;</span><span class="p">,</span> <span class="s1">&#39;Bulgaria&#39;</span><span class="p">:</span> <span class="s1">&#39;BG&#39;</span><span class="p">,</span> <span class="s1">&#39;Burkina Faso&#39;</span><span class="p">:</span> <span class="s1">&#39;BF&#39;</span><span class="p">,</span> <span class="s1">&#39;Burundi&#39;</span><span class="p">:</span> <span class="s1">&#39;BI&#39;</span><span class="p">,</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>            <span class="s1">&#39;Cambodia&#39;</span><span class="p">:</span> <span class="s1">&#39;KH&#39;</span><span class="p">,</span> <span class="s1">&#39;Cameroon&#39;</span><span class="p">:</span> <span class="s1">&#39;CM&#39;</span><span class="p">,</span> <span class="s1">&#39;Canada&#39;</span><span class="p">:</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39;Cape Verde&#39;</span><span class="p">:</span> <span class="s1">&#39;CV&#39;</span><span class="p">,</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>            <span class="s1">&#39;Cayman Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;KY&#39;</span><span class="p">,</span> <span class="s1">&#39;Central African Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;CF&#39;</span><span class="p">,</span> <span class="s1">&#39;Chad&#39;</span><span class="p">:</span> <span class="s1">&#39;TD&#39;</span><span class="p">,</span> <span class="s1">&#39;Chile&#39;</span><span class="p">:</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>            <span class="s1">&#39;China&#39;</span><span class="p">:</span> <span class="s1">&#39;CN&#39;</span><span class="p">,</span> <span class="s1">&#39;Christmas Island&#39;</span><span class="p">:</span> <span class="s1">&#39;CX&#39;</span><span class="p">,</span> <span class="s1">&#39;Cocos (Keeling) Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>            <span class="s1">&#39;Colombia&#39;</span><span class="p">:</span> <span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;Comoros&#39;</span><span class="p">:</span> <span class="s1">&#39;KM&#39;</span><span class="p">,</span> <span class="s1">&#39;Congo&#39;</span><span class="p">:</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="s1">&#39;Czech Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;CZ&#39;</span><span class="p">,</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>            <span class="s1">&#39;Congo, the Democratic Republic of the&#39;</span><span class="p">:</span> <span class="s1">&#39;CD&#39;</span><span class="p">,</span> <span class="s1">&#39;Cook Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;CK&#39;</span><span class="p">,</span> <span class="s1">&#39;Cyprus&#39;</span><span class="p">:</span> <span class="s1">&#39;CY&#39;</span><span class="p">,</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>            <span class="s1">&#39;Costa Rica&#39;</span><span class="p">:</span> <span class="s1">&#39;CR&#39;</span><span class="p">,</span> <span class="s1">&#39;Cote D</span><span class="se">\&#39;</span><span class="s1">Ivoire&#39;</span><span class="p">:</span> <span class="s1">&#39;CI&#39;</span><span class="p">,</span> <span class="s1">&#39;Croatia&#39;</span><span class="p">:</span> <span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Cuba&#39;</span><span class="p">:</span> <span class="s1">&#39;CU&#39;</span><span class="p">,</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>            <span class="s1">&#39;Denmark&#39;</span><span class="p">:</span> <span class="s1">&#39;DK&#39;</span><span class="p">,</span> <span class="s1">&#39;Djibouti&#39;</span><span class="p">:</span> <span class="s1">&#39;DJ&#39;</span><span class="p">,</span> <span class="s1">&#39;Dominica&#39;</span><span class="p">:</span> <span class="s1">&#39;DM&#39;</span><span class="p">,</span> <span class="s1">&#39;Dominican Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;DO&#39;</span><span class="p">,</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>            <span class="s1">&#39;Ecuador&#39;</span><span class="p">:</span> <span class="s1">&#39;EC&#39;</span><span class="p">,</span> <span class="s1">&#39;Egypt&#39;</span><span class="p">:</span> <span class="s1">&#39;EG&#39;</span><span class="p">,</span> <span class="s1">&#39;El Salvador&#39;</span><span class="p">:</span> <span class="s1">&#39;SV&#39;</span><span class="p">,</span> <span class="s1">&#39;Equatorial Guinea&#39;</span><span class="p">:</span> <span class="s1">&#39;GQ&#39;</span><span class="p">,</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>            <span class="s1">&#39;Eritrea&#39;</span><span class="p">:</span> <span class="s1">&#39;ER&#39;</span><span class="p">,</span> <span class="s1">&#39;Estonia&#39;</span><span class="p">:</span> <span class="s1">&#39;EE&#39;</span><span class="p">,</span> <span class="s1">&#39;Ethiopia&#39;</span><span class="p">:</span> <span class="s1">&#39;ET&#39;</span><span class="p">,</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>            <span class="s1">&#39;Falkland Islands (Malvinas)&#39;</span><span class="p">:</span> <span class="s1">&#39;FK&#39;</span><span class="p">,</span> <span class="s1">&#39;Faroe Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;FO&#39;</span><span class="p">,</span> <span class="s1">&#39;Fiji&#39;</span><span class="p">:</span> <span class="s1">&#39;FJ&#39;</span><span class="p">,</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>            <span class="s1">&#39;Finland&#39;</span><span class="p">:</span> <span class="s1">&#39;FI&#39;</span><span class="p">,</span> <span class="s1">&#39;France&#39;</span><span class="p">:</span> <span class="s1">&#39;FR&#39;</span><span class="p">,</span> <span class="s1">&#39;French Guiana&#39;</span><span class="p">:</span> <span class="s1">&#39;GF&#39;</span><span class="p">,</span> <span class="s1">&#39;French Polynesia&#39;</span><span class="p">:</span> <span class="s1">&#39;PF&#39;</span><span class="p">,</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>            <span class="s1">&#39;French Southern Territories&#39;</span><span class="p">:</span> <span class="s1">&#39;TF&#39;</span><span class="p">,</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>            <span class="s1">&#39;Gabon&#39;</span><span class="p">:</span> <span class="s1">&#39;GA&#39;</span><span class="p">,</span> <span class="s1">&#39;Gambia&#39;</span><span class="p">:</span> <span class="s1">&#39;GM&#39;</span><span class="p">,</span> <span class="s1">&#39;Georgia&#39;</span><span class="p">:</span> <span class="s1">&#39;GE&#39;</span><span class="p">,</span> <span class="s1">&#39;Germany&#39;</span><span class="p">:</span> <span class="s1">&#39;DE&#39;</span><span class="p">,</span> <span class="s1">&#39;Ghana&#39;</span><span class="p">:</span> <span class="s1">&#39;GH&#39;</span><span class="p">,</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>            <span class="s1">&#39;Grenada&#39;</span><span class="p">:</span> <span class="s1">&#39;GD&#39;</span><span class="p">,</span> <span class="s1">&#39;Gibraltar&#39;</span><span class="p">:</span> <span class="s1">&#39;GI&#39;</span><span class="p">,</span> <span class="s1">&#39;Greece&#39;</span><span class="p">:</span> <span class="s1">&#39;GR&#39;</span><span class="p">,</span> <span class="s1">&#39;Greenland&#39;</span><span class="p">:</span> <span class="s1">&#39;GL&#39;</span><span class="p">,</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>            <span class="s1">&#39;Guadeloupe&#39;</span><span class="p">:</span> <span class="s1">&#39;GP&#39;</span><span class="p">,</span> <span class="s1">&#39;Guam&#39;</span><span class="p">:</span> <span class="s1">&#39;GU&#39;</span><span class="p">,</span> <span class="s1">&#39;Guatemala&#39;</span><span class="p">:</span> <span class="s1">&#39;GT&#39;</span><span class="p">,</span> <span class="s1">&#39;Guinea-Bissau&#39;</span><span class="p">:</span> <span class="s1">&#39;GW&#39;</span><span class="p">,</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>            <span class="s1">&#39;Guyana&#39;</span><span class="p">:</span> <span class="s1">&#39;GY&#39;</span><span class="p">,</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>            <span class="s1">&#39;Haiti&#39;</span><span class="p">:</span> <span class="s1">&#39;HT&#39;</span><span class="p">,</span> <span class="s1">&#39;Heard Island and Mcdonald Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;HM&#39;</span><span class="p">,</span> <span class="s1">&#39;Hungary&#39;</span><span class="p">:</span> <span class="s1">&#39;HU&#39;</span><span class="p">,</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>            <span class="s1">&#39;Holy See (Vatican City State)&#39;</span><span class="p">:</span> <span class="s1">&#39;VA&#39;</span><span class="p">,</span> <span class="s1">&#39;Honduras&#39;</span><span class="p">:</span> <span class="s1">&#39;HN&#39;</span><span class="p">,</span> <span class="s1">&#39;Hong Kong&#39;</span><span class="p">:</span> <span class="s1">&#39;HK&#39;</span><span class="p">,</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>            <span class="s1">&#39;Iceland&#39;</span><span class="p">:</span> <span class="s1">&#39;IS&#39;</span><span class="p">,</span> <span class="s1">&#39;India&#39;</span><span class="p">:</span> <span class="s1">&#39;IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Indonesia&#39;</span><span class="p">:</span> <span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Iran, Islamic Republic of&#39;</span><span class="p">:</span> <span class="s1">&#39;IR&#39;</span><span class="p">,</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>            <span class="s1">&#39;Iraq&#39;</span><span class="p">:</span> <span class="s1">&#39;IQ&#39;</span><span class="p">,</span> <span class="s1">&#39;Ireland&#39;</span><span class="p">:</span> <span class="s1">&#39;IE&#39;</span><span class="p">,</span> <span class="s1">&#39;Israel&#39;</span><span class="p">:</span> <span class="s1">&#39;IL&#39;</span><span class="p">,</span> <span class="s1">&#39;Italy&#39;</span><span class="p">:</span> <span class="s1">&#39;IT&#39;</span><span class="p">,</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>            <span class="s1">&#39;Jamaica&#39;</span><span class="p">:</span> <span class="s1">&#39;JM&#39;</span><span class="p">,</span> <span class="s1">&#39;Japan&#39;</span><span class="p">:</span> <span class="s1">&#39;JP&#39;</span><span class="p">,</span> <span class="s1">&#39;Jordan&#39;</span><span class="p">:</span> <span class="s1">&#39;JO&#39;</span><span class="p">,</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>            <span class="s1">&#39;Kazakhstan&#39;</span><span class="p">:</span> <span class="s1">&#39;KZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Kenya&#39;</span><span class="p">:</span> <span class="s1">&#39;KE&#39;</span><span class="p">,</span> <span class="s1">&#39;Kiribati&#39;</span><span class="p">:</span> <span class="s1">&#39;KI&#39;</span><span class="p">,</span> <span class="s1">&#39;Kyrgyzstan&#39;</span><span class="p">:</span> <span class="s1">&#39;KG&#39;</span><span class="p">,</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>            <span class="s1">&#39;Korea, Democratic People</span><span class="se">\&#39;</span><span class="s1">s Republic of&#39;</span><span class="p">:</span><span class="s1">&#39;KP&#39;</span><span class="p">,</span><span class="s1">&#39;Korea, Republic of&#39;</span><span class="p">:</span><span class="s1">&#39;KR&#39;</span><span class="p">,</span><span class="s1">&#39;Kuwait&#39;</span><span class="p">:</span><span class="s1">&#39;KW&#39;</span><span class="p">,</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>            <span class="s1">&#39;Lao People</span><span class="se">\&#39;</span><span class="s1">s Democratic Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;LA&#39;</span><span class="p">,</span><span class="s1">&#39;Latvia&#39;</span><span class="p">:</span> <span class="s1">&#39;LV&#39;</span><span class="p">,</span><span class="s1">&#39;Lebanon&#39;</span><span class="p">:</span> <span class="s1">&#39;LB&#39;</span><span class="p">,</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>            <span class="s1">&#39;Lesotho&#39;</span><span class="p">:</span> <span class="s1">&#39;LS&#39;</span><span class="p">,</span> <span class="s1">&#39;Liberia&#39;</span><span class="p">:</span> <span class="s1">&#39;LR&#39;</span><span class="p">,</span> <span class="s1">&#39;Libyan Arab Jamahiriya&#39;</span><span class="p">:</span> <span class="s1">&#39;LY&#39;</span><span class="p">,</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>            <span class="s1">&#39;Liechtenstein&#39;</span><span class="p">:</span> <span class="s1">&#39;LI&#39;</span><span class="p">,</span> <span class="s1">&#39;Lithuania&#39;</span><span class="p">:</span> <span class="s1">&#39;LT&#39;</span><span class="p">,</span> <span class="s1">&#39;Luxembourg&#39;</span><span class="p">:</span> <span class="s1">&#39;LU&#39;</span><span class="p">,</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>            <span class="s1">&#39;Macao&#39;</span><span class="p">:</span> <span class="s1">&#39;MO&#39;</span><span class="p">,</span> <span class="s1">&#39;Macedonia&#39;</span><span class="p">:</span> <span class="s1">&#39;MK&#39;</span><span class="p">,</span> <span class="s1">&#39;Madagascar&#39;</span><span class="p">:</span> <span class="s1">&#39;MG&#39;</span><span class="p">,</span> <span class="s1">&#39;Mali&#39;</span><span class="p">:</span> <span class="s1">&#39;ML&#39;</span><span class="p">,</span> <span class="s1">&#39;Malta&#39;</span><span class="p">:</span> <span class="s1">&#39;MT&#39;</span><span class="p">,</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>            <span class="s1">&#39;Malaysia&#39;</span><span class="p">:</span> <span class="s1">&#39;MY&#39;</span><span class="p">,</span> <span class="s1">&#39;Malawi&#39;</span><span class="p">:</span> <span class="s1">&#39;MW&#39;</span><span class="p">,</span> <span class="s1">&#39;Maldives&#39;</span><span class="p">:</span> <span class="s1">&#39;MV&#39;</span><span class="p">,</span> <span class="s1">&#39;Mauritania&#39;</span><span class="p">:</span> <span class="s1">&#39;MR&#39;</span><span class="p">,</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>            <span class="s1">&#39;Mauritius&#39;</span><span class="p">:</span> <span class="s1">&#39;MU&#39;</span><span class="p">,</span> <span class="s1">&#39;Marshall Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;MH&#39;</span><span class="p">,</span> <span class="s1">&#39;Martinique&#39;</span><span class="p">:</span> <span class="s1">&#39;MQ&#39;</span><span class="p">,</span> <span class="s1">&#39;Mayotte&#39;</span><span class="p">:</span> <span class="s1">&#39;YT&#39;</span><span class="p">,</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>            <span class="s1">&#39;Mexico&#39;</span><span class="p">:</span> <span class="s1">&#39;MX&#39;</span><span class="p">,</span> <span class="s1">&#39;Micronesia, Federated States of&#39;</span><span class="p">:</span> <span class="s1">&#39;FM&#39;</span><span class="p">,</span><span class="s1">&#39;Moldova&#39;</span><span class="p">:</span> <span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;Monaco&#39;</span><span class="p">:</span> <span class="s1">&#39;MC&#39;</span><span class="p">,</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>            <span class="s1">&#39;Mongolia&#39;</span><span class="p">:</span> <span class="s1">&#39;MN&#39;</span><span class="p">,</span> <span class="s1">&#39;Montenegro&#39;</span><span class="p">:</span> <span class="s1">&#39;ME&#39;</span><span class="p">,</span> <span class="s1">&#39;Montserrat&#39;</span><span class="p">:</span>  <span class="s1">&#39;MS&#39;</span><span class="p">,</span> <span class="s1">&#39;Morocco&#39;</span><span class="p">:</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>            <span class="s1">&#39;Mozambique&#39;</span><span class="p">:</span> <span class="s1">&#39;MZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Myanmar&#39;</span><span class="p">:</span> <span class="s1">&#39;MM&#39;</span><span class="p">,</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>            <span class="s1">&#39;Namibia&#39;</span><span class="p">:</span> <span class="s1">&#39;NA&#39;</span><span class="p">,</span> <span class="s1">&#39;Nauru&#39;</span><span class="p">:</span> <span class="s1">&#39;NR&#39;</span><span class="p">,</span> <span class="s1">&#39;Nepal&#39;</span><span class="p">:</span> <span class="s1">&#39;NP&#39;</span><span class="p">,</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>            <span class="s1">&#39;Netherlands&#39;</span><span class="p">:</span> <span class="s1">&#39;NL&#39;</span><span class="p">,</span> <span class="s1">&#39;Netherlands Antilles&#39;</span><span class="p">:</span> <span class="s1">&#39;NL&#39;</span><span class="p">,</span> <span class="s1">&#39;New Caledonia&#39;</span><span class="p">:</span> <span class="s1">&#39;NC&#39;</span><span class="p">,</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>            <span class="s1">&#39;New Zealand&#39;</span><span class="p">:</span> <span class="s1">&#39;NZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Nicaragua&#39;</span><span class="p">:</span> <span class="s1">&#39;NI&#39;</span><span class="p">,</span> <span class="s1">&#39;Niger&#39;</span><span class="p">:</span> <span class="s1">&#39;NE&#39;</span><span class="p">,</span> <span class="s1">&#39;Nigeria&#39;</span><span class="p">:</span> <span class="s1">&#39;NG&#39;</span><span class="p">,</span> <span class="s1">&#39;Niue&#39;</span><span class="p">:</span> <span class="s1">&#39;NU&#39;</span><span class="p">,</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>            <span class="s1">&#39;Norfolk Island&#39;</span><span class="p">:</span> <span class="s1">&#39;NF&#39;</span><span class="p">,</span> <span class="s1">&#39;Northern Mariana Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;MP&#39;</span><span class="p">,</span> <span class="s1">&#39;Norway&#39;</span><span class="p">:</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>            <span class="s1">&#39;Oman&#39;</span><span class="p">:</span> <span class="s1">&#39;OM&#39;</span><span class="p">,</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>            <span class="s1">&#39;Pakistan&#39;</span><span class="p">:</span> <span class="s1">&#39;PK&#39;</span><span class="p">,</span> <span class="s1">&#39;Palau&#39;</span><span class="p">:</span> <span class="s1">&#39;PW&#39;</span><span class="p">,</span><span class="s1">&#39;Palestinian Territory, Occupied&#39;</span><span class="p">:</span> <span class="s1">&#39;PS&#39;</span><span class="p">,</span><span class="s1">&#39;Panama&#39;</span><span class="p">:</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>            <span class="s1">&#39;Papua New Guinea&#39;</span><span class="p">:</span> <span class="s1">&#39;PG&#39;</span><span class="p">,</span> <span class="s1">&#39;Paraguay&#39;</span><span class="p">:</span> <span class="s1">&#39;PY&#39;</span><span class="p">,</span> <span class="s1">&#39;Peru&#39;</span><span class="p">:</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span> <span class="s1">&#39;Philippines&#39;</span><span class="p">:</span> <span class="s1">&#39;PH&#39;</span><span class="p">,</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>            <span class="s1">&#39;Pitcairn&#39;</span><span class="p">:</span> <span class="s1">&#39;PN&#39;</span><span class="p">,</span> <span class="s1">&#39;Poland&#39;</span><span class="p">:</span> <span class="s1">&#39;PL&#39;</span><span class="p">,</span> <span class="s1">&#39;Portugal&#39;</span><span class="p">:</span> <span class="s1">&#39;PT&#39;</span><span class="p">,</span> <span class="s1">&#39;Puerto Rico&#39;</span><span class="p">:</span> <span class="s1">&#39;PR&#39;</span><span class="p">,</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>            <span class="s1">&#39;Qatar&#39;</span><span class="p">:</span> <span class="s1">&#39;QA&#39;</span><span class="p">,</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>            <span class="s1">&#39;Reunion&#39;</span><span class="p">:</span> <span class="s1">&#39;RE&#39;</span><span class="p">,</span> <span class="s1">&#39;Romania&#39;</span><span class="p">:</span> <span class="s1">&#39;RO&#39;</span><span class="p">,</span> <span class="s1">&#39;Russian Federation&#39;</span><span class="p">:</span> <span class="s1">&#39;RU&#39;</span><span class="p">,</span> <span class="s1">&#39;Rwanda&#39;</span><span class="p">:</span> <span class="s1">&#39;RW&#39;</span><span class="p">,</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>            <span class="s1">&#39;Saint Helena&#39;</span><span class="p">:</span> <span class="s1">&#39;SH&#39;</span><span class="p">,</span> <span class="s1">&#39;Saint Kitts and Nevis&#39;</span><span class="p">:</span> <span class="s1">&#39;KN&#39;</span><span class="p">,</span> <span class="s1">&#39;Saint Lucia&#39;</span><span class="p">:</span> <span class="s1">&#39;LC&#39;</span><span class="p">,</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>            <span class="s1">&#39;Saint Pierre and Miquelon&#39;</span><span class="p">:</span> <span class="s1">&#39;PM&#39;</span><span class="p">,</span> <span class="s1">&#39;Saint Vincent and the Grenadines&#39;</span><span class="p">:</span> <span class="s1">&#39;VC&#39;</span><span class="p">,</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>            <span class="s1">&#39;Samoa&#39;</span><span class="p">:</span> <span class="s1">&#39;WS&#39;</span><span class="p">,</span> <span class="s1">&#39;San Marino&#39;</span><span class="p">:</span> <span class="s1">&#39;SM&#39;</span><span class="p">,</span> <span class="s1">&#39;Sao Tome and Principe&#39;</span><span class="p">:</span> <span class="s1">&#39;ST&#39;</span><span class="p">,</span> <span class="s1">&#39;Saudi Arabia&#39;</span><span class="p">:</span> <span class="s1">&#39;SA&#39;</span><span class="p">,</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>            <span class="s1">&#39;Senegal&#39;</span><span class="p">:</span> <span class="s1">&#39;SN&#39;</span><span class="p">,</span> <span class="s1">&#39;Serbia&#39;</span><span class="p">:</span> <span class="s1">&#39;RS&#39;</span><span class="p">,</span> <span class="s1">&#39;Seychelles&#39;</span><span class="p">:</span> <span class="s1">&#39;SC&#39;</span><span class="p">,</span> <span class="s1">&#39;Sierra Leone&#39;</span><span class="p">:</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>            <span class="s1">&#39;Singapore&#39;</span><span class="p">:</span> <span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;Solomon Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;SB&#39;</span><span class="p">,</span> <span class="s1">&#39;Somalia&#39;</span><span class="p">:</span> <span class="s1">&#39;SO&#39;</span><span class="p">,</span> <span class="s1">&#39;South Africa&#39;</span><span class="p">:</span> <span class="s1">&#39;ZA&#39;</span><span class="p">,</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="s1">&#39;Slovakia&#39;</span><span class="p">:</span> <span class="s1">&#39;SK&#39;</span><span class="p">,</span><span class="s1">&#39;Slovenia&#39;</span><span class="p">:</span> <span class="s1">&#39;SI&#39;</span><span class="p">,</span><span class="s1">&#39;South Georgia and the South Sandwich Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;GS&#39;</span><span class="p">,</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>            <span class="s1">&#39;Spain&#39;</span><span class="p">:</span> <span class="s1">&#39;ES&#39;</span><span class="p">,</span> <span class="s1">&#39;Sri Lanka&#39;</span><span class="p">:</span> <span class="s1">&#39;LK&#39;</span><span class="p">,</span> <span class="s1">&#39;Sudan&#39;</span><span class="p">:</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;Suriname&#39;</span><span class="p">:</span> <span class="s1">&#39;SR&#39;</span><span class="p">,</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>            <span class="s1">&#39;Svalbard and Jan Mayen&#39;</span><span class="p">:</span> <span class="s1">&#39;SJ&#39;</span><span class="p">,</span> <span class="s1">&#39;Syrian Arab Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;SY&#39;</span><span class="p">,</span> <span class="s1">&#39;Swaziland&#39;</span><span class="p">:</span> <span class="s1">&#39;SZ&#39;</span><span class="p">,</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>            <span class="s1">&#39;Sweden&#39;</span><span class="p">:</span> <span class="s1">&#39;SE&#39;</span><span class="p">,</span> <span class="s1">&#39;Switzerland&#39;</span><span class="p">:</span> <span class="s1">&#39;CH&#39;</span><span class="p">,</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>            <span class="s1">&#39;Taiwan&#39;</span><span class="p">:</span> <span class="s1">&#39;TW&#39;</span><span class="p">,</span> <span class="s1">&#39;Tajikistan&#39;</span><span class="p">:</span> <span class="s1">&#39;TJ&#39;</span><span class="p">,</span> <span class="s1">&#39;Tanzania, United Republic of&#39;</span><span class="p">:</span> <span class="s1">&#39;TZ&#39;</span><span class="p">,</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>            <span class="s1">&#39;Thailand&#39;</span><span class="p">:</span> <span class="s1">&#39;TH&#39;</span><span class="p">,</span> <span class="s1">&#39;Timor-Leste&#39;</span><span class="p">:</span> <span class="s1">&#39;TL&#39;</span><span class="p">,</span> <span class="s1">&#39;Togo&#39;</span><span class="p">:</span> <span class="s1">&#39;TG&#39;</span><span class="p">,</span> <span class="s1">&#39;Tokelau&#39;</span><span class="p">:</span> <span class="s1">&#39;TK&#39;</span><span class="p">,</span> <span class="s1">&#39;Tonga&#39;</span><span class="p">:</span> <span class="s1">&#39;TO&#39;</span><span class="p">,</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>            <span class="s1">&#39;Trinidad and Tobago&#39;</span><span class="p">:</span> <span class="s1">&#39;TT&#39;</span><span class="p">,</span> <span class="s1">&#39;Tunisia&#39;</span><span class="p">:</span> <span class="s1">&#39;TN&#39;</span><span class="p">,</span> <span class="s1">&#39;Turkey&#39;</span><span class="p">:</span> <span class="s1">&#39;TR&#39;</span><span class="p">,</span> <span class="s1">&#39;Turkmenistan&#39;</span><span class="p">:</span> <span class="s1">&#39;TM&#39;</span><span class="p">,</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>            <span class="s1">&#39;Turks and Caicos Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;TC&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuvalu&#39;</span><span class="p">:</span> <span class="s1">&#39;TV&#39;</span><span class="p">,</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>            <span class="s1">&#39;Uganda&#39;</span><span class="p">:</span> <span class="s1">&#39;UG&#39;</span><span class="p">,</span> <span class="s1">&#39;Ukraine&#39;</span><span class="p">:</span> <span class="s1">&#39;UA&#39;</span><span class="p">,</span> <span class="s1">&#39;United Arab Emirates&#39;</span><span class="p">:</span> <span class="s1">&#39;AE&#39;</span><span class="p">,</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>            <span class="s1">&#39;United Kingdom&#39;</span><span class="p">:</span><span class="s1">&#39;GB&#39;</span><span class="p">,</span><span class="s1">&#39;United States&#39;</span><span class="p">:</span><span class="s1">&#39;US&#39;</span><span class="p">,</span><span class="s1">&#39;United States Minor Outlying Islands&#39;</span><span class="p">:</span><span class="s1">&#39;UM&#39;</span><span class="p">,</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>            <span class="s1">&#39;Uruguay&#39;</span><span class="p">:</span> <span class="s1">&#39;UY&#39;</span><span class="p">,</span> <span class="s1">&#39;Uzbekistan&#39;</span><span class="p">:</span> <span class="s1">&#39;UZ&#39;</span><span class="p">,</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>            <span class="s1">&#39;Vanuatu&#39;</span><span class="p">:</span> <span class="s1">&#39;VU&#39;</span><span class="p">,</span> <span class="s1">&#39;Venezuela&#39;</span><span class="p">:</span> <span class="s1">&#39;VE&#39;</span><span class="p">,</span> <span class="s1">&#39;Viet Nam&#39;</span><span class="p">:</span> <span class="s1">&#39;VN&#39;</span><span class="p">,</span> <span class="s1">&#39;Virgin Islands, British&#39;</span><span class="p">:</span> <span class="s1">&#39;VG&#39;</span><span class="p">,</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>            <span class="s1">&#39;Virgin Islands, U.s.&#39;</span><span class="p">:</span> <span class="s1">&#39;VI&#39;</span><span class="p">,</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>            <span class="s1">&#39;Yemen&#39;</span><span class="p">:</span> <span class="s1">&#39;YE&#39;</span><span class="p">,</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>            <span class="s1">&#39;Wallis and Futuna&#39;</span><span class="p">:</span> <span class="s1">&#39;WF&#39;</span><span class="p">,</span> <span class="s1">&#39;Western Sahara&#39;</span><span class="p">:</span> <span class="s1">&#39;EH&#39;</span><span class="p">,</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>            <span class="s1">&#39;Zambia&#39;</span><span class="p">:</span> <span class="s1">&#39;ZM&#39;</span><span class="p">,</span> <span class="s1">&#39;Zimbabwe&#39;</span><span class="p">:</span> <span class="s1">&#39;ZW&#39;</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="k">return</span> <span class="n">user_table</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>    <span class="k">def</span> <span class="nf">process_artist_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetTableConfig</span><span class="p">]:</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="sd">&quot;&quot;&quot;Process the artist table.</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">        Creates the artist table with the musicbrainzID and gender information when available.</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a><span class="sd">        Returns:</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="sd">            the artist table configuration or None on failure.</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>        <span class="n">artist_key</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;artist_id&#39;</span><span class="p">]</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>        <span class="n">artist_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="c1"># connect artist id to name</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>        <span class="n">artist_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>            <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">artist_list</span><span class="p">)),</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>            <span class="n">columns</span><span class="o">=</span><span class="n">artist_key</span> <span class="o">+</span> <span class="n">artist_columns</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>        <span class="p">)</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>        <span class="c1"># merge the artist musicbrainzID on name</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>        <span class="n">artist_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">artist_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;artist_name&#39;</span><span class="p">)</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>        <span class="n">artist_table</span><span class="p">[</span><span class="s1">&#39;artist_mbID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>        <span class="n">artist_columns</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;artist_mbID&#39;</span><span class="p">]</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>        <span class="n">artist_gender</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_artist_gender_json</span><span class="p">()</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="n">artist_gender</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>            <span class="c1"># merge artists with gender and update columns</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>            <span class="n">artist_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">artist_table</span><span class="p">,</span> <span class="n">artist_gender</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;artist_mbID&#39;</span><span class="p">)</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>            <span class="n">artist_columns</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;artist_gender&#39;</span><span class="p">]</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>        <span class="c1"># create artist table configuration</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="n">artist_table_config</span> <span class="o">=</span> <span class="n">create_dataset_table_config</span><span class="p">(</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>            <span class="n">TABLE_FILE_PREFIX</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s1">&#39;_artists.tsv.bz2&#39;</span><span class="p">,</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>            <span class="n">artist_key</span><span class="p">,</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>            <span class="n">artist_columns</span><span class="p">,</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>            <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;bz2&#39;</span><span class="p">,</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>            <span class="n">num_records</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">artist_list</span><span class="p">)</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>        <span class="p">)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>        <span class="c1"># store the generated artist table</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>        <span class="n">artist_table_config</span><span class="o">.</span><span class="n">save_table</span><span class="p">(</span><span class="n">artist_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">)</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="k">return</span> <span class="n">artist_table_config</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>    <span class="k">def</span> <span class="nf">process_user_artist_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetMatrixConfig</span><span class="p">]:</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>        <span class="sd">&quot;&quot;&quot;Process the user-artist-count matrix.</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">        The user-item matrix is stored in a file that also contains a musicbrainzID.</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">        The users are hashes and the items are names, both are converted to integers</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">        to comply to the CSR compatible format. In addition, any rows that contain</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">        corrupt data are removed in the process.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">        Returns:</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">            the matrix configuration or None on failure.</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="s1">&#39;usersha1-artmbid-artname-plays.tsv&#39;</span><span class="p">),</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>                <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_mbID&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_name&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_count&#39;</span><span class="p">]</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>            <span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="c1"># remove rows from a user that is not a hash</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;sep 20, 2008&#39;</span><span class="p">]</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="c1"># map users/items to category and ratings to be floating-point</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;matrix_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;matrix_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>        <span class="c1"># remove rows that contain items that failed to map to category</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>        <span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="c1"># remove rows that have unusable ratings</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>        <span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;matrix_count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="n">dataframe</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_name&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="c1"># extract user/item indirection arrays</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">user_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="c1"># extract artist name/musicbrainzID combinations</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_mbID&#39;</span><span class="p">]]</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="c1"># remove duplicates combinations</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="c1"># remove duplicates where the artist has more than one musicbrainzID</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;artist_name&#39;</span><span class="p">)</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="c1"># add the correct user/item integers</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="c1"># create matrix by removing other columns</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>        <span class="n">user_artist_matrix</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_id&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_count&#39;</span><span class="p">]]</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="n">user_artist_matrix_table_config</span> <span class="o">=</span> <span class="n">create_dataset_table_config</span><span class="p">(</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>            <span class="n">TABLE_FILE_PREFIX</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s1">&#39;_user-artist-count_matrix.tsv.bz2&#39;</span><span class="p">,</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>            <span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_id&#39;</span><span class="p">],</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>            <span class="p">[</span><span class="s1">&#39;matrix_count&#39;</span><span class="p">],</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>            <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;bz2&#39;</span><span class="p">,</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>            <span class="n">foreign_keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_id&#39;</span><span class="p">]</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>        <span class="p">)</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>        <span class="c1"># store the resulting matrix</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="n">user_artist_matrix_table_config</span><span class="o">.</span><span class="n">save_table</span><span class="p">(</span><span class="n">user_artist_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">)</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_matrix</span><span class="p">(</span><span class="n">user_artist_matrix_table_config</span><span class="p">)</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>    <span class="k">def</span> <span class="nf">process_user_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetTableConfig</span><span class="p">]:</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="sd">&quot;&quot;&quot;Process the user table.</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a><span class="sd">        Extends the original user table with unique user ids.</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a><span class="sd">        Returns:</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="sd">            the user table configuration or None on failure.</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>        <span class="n">user_table_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_user_table_config</span><span class="p">()</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>        <span class="c1"># connect user id to sha</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        <span class="n">user_sha_ids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_list</span><span class="p">)),</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;user_sha&#39;</span><span class="p">]</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="p">)</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>        <span class="c1"># load original user table and when available, add it to user id/sha</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>        <span class="n">user_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_user_table</span><span class="p">()</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>        <span class="k">if</span> <span class="n">user_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>            <span class="n">user_table</span> <span class="o">=</span> <span class="n">user_sha_ids</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">user_table</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>                <span class="n">user_table_config</span><span class="o">.</span><span class="n">columns</span> <span class="o">+=</span> <span class="p">[</span><span class="n">user_table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>            <span class="c1"># join user table with user ids</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="n">user_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">user_sha_ids</span><span class="p">,</span> <span class="n">user_table</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;user_sha&#39;</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>            <span class="c1"># fill unknown user age with -1 and cast back to int</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>            <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="c1"># store the generated user table</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="n">user_table_config</span><span class="o">.</span><span class="n">save_table</span><span class="p">(</span><span class="n">user_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">)</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>        <span class="k">return</span> <span class="n">user_table_config</span>
</span></pre></div>


            </section>
                <section id="DatasetProcessorLFM360K">
                            <input id="DatasetProcessorLFM360K-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DatasetProcessorLFM360K</span><wbr>(<span class="base"><a href="dataset_processor_lfm.html#DatasetProcessorLFM">src.fairreckitlib.data.set.processor.dataset_processor_lfm.DatasetProcessorLFM</a></span>):

                <label class="view-source-button" for="DatasetProcessorLFM360K-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatasetProcessorLFM360K"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatasetProcessorLFM360K-23"><a href="#DatasetProcessorLFM360K-23"><span class="linenos"> 23</span></a><span class="k">class</span> <span class="nc">DatasetProcessorLFM360K</span><span class="p">(</span><span class="n">DatasetProcessorLFM</span><span class="p">):</span>
</span><span id="DatasetProcessorLFM360K-24"><a href="#DatasetProcessorLFM360K-24"><span class="linenos"> 24</span></a>    <span class="sd">&quot;&quot;&quot;DatasetProcessor for the LastFM-360K dataset.</span>
</span><span id="DatasetProcessorLFM360K-25"><a href="#DatasetProcessorLFM360K-25"><span class="linenos"> 25</span></a>
</span><span id="DatasetProcessorLFM360K-26"><a href="#DatasetProcessorLFM360K-26"><span class="linenos"> 26</span></a><span class="sd">    The dataset can be downloaded from the website below.</span>
</span><span id="DatasetProcessorLFM360K-27"><a href="#DatasetProcessorLFM360K-27"><span class="linenos"> 27</span></a><span class="sd">    https://www.upf.edu/web/mtg/lastfm360k</span>
</span><span id="DatasetProcessorLFM360K-28"><a href="#DatasetProcessorLFM360K-28"><span class="linenos"> 28</span></a>
</span><span id="DatasetProcessorLFM360K-29"><a href="#DatasetProcessorLFM360K-29"><span class="linenos"> 29</span></a><span class="sd">    The enriched artist gender information can be retrieved from:</span>
</span><span id="DatasetProcessorLFM360K-30"><a href="#DatasetProcessorLFM360K-30"><span class="linenos"> 30</span></a><span class="sd">    https://zenodo.org/record/3748787#.YowEBqhByUk</span>
</span><span id="DatasetProcessorLFM360K-31"><a href="#DatasetProcessorLFM360K-31"><span class="linenos"> 31</span></a>
</span><span id="DatasetProcessorLFM360K-32"><a href="#DatasetProcessorLFM360K-32"><span class="linenos"> 32</span></a><span class="sd">    The processor handles the following files:</span>
</span><span id="DatasetProcessorLFM360K-33"><a href="#DatasetProcessorLFM360K-33"><span class="linenos"> 33</span></a>
</span><span id="DatasetProcessorLFM360K-34"><a href="#DatasetProcessorLFM360K-34"><span class="linenos"> 34</span></a><span class="sd">    usersha1-artmbid-artname-plays.tsv (required)</span>
</span><span id="DatasetProcessorLFM360K-35"><a href="#DatasetProcessorLFM360K-35"><span class="linenos"> 35</span></a><span class="sd">    usersha1-profile.tsv (optional)</span>
</span><span id="DatasetProcessorLFM360K-36"><a href="#DatasetProcessorLFM360K-36"><span class="linenos"> 36</span></a><span class="sd">    lfm-360-gender.json (optional)</span>
</span><span id="DatasetProcessorLFM360K-37"><a href="#DatasetProcessorLFM360K-37"><span class="linenos"> 37</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K-38"><a href="#DatasetProcessorLFM360K-38"><span class="linenos"> 38</span></a>
</span><span id="DatasetProcessorLFM360K-39"><a href="#DatasetProcessorLFM360K-39"><span class="linenos"> 39</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="DatasetProcessorLFM360K-40"><a href="#DatasetProcessorLFM360K-40"><span class="linenos"> 40</span></a>        <span class="sd">&quot;&quot;&quot;Construct the DatasetProcessorLFM360K.</span>
</span><span id="DatasetProcessorLFM360K-41"><a href="#DatasetProcessorLFM360K-41"><span class="linenos"> 41</span></a>
</span><span id="DatasetProcessorLFM360K-42"><a href="#DatasetProcessorLFM360K-42"><span class="linenos"> 42</span></a><span class="sd">        Args:</span>
</span><span id="DatasetProcessorLFM360K-43"><a href="#DatasetProcessorLFM360K-43"><span class="linenos"> 43</span></a><span class="sd">            dataset_name: path of the dataset directory.</span>
</span><span id="DatasetProcessorLFM360K-44"><a href="#DatasetProcessorLFM360K-44"><span class="linenos"> 44</span></a><span class="sd">            dataset_name: name of the dataset (processor).</span>
</span><span id="DatasetProcessorLFM360K-45"><a href="#DatasetProcessorLFM360K-45"><span class="linenos"> 45</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K-46"><a href="#DatasetProcessorLFM360K-46"><span class="linenos"> 46</span></a>        <span class="n">DatasetProcessorLFM</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-47"><a href="#DatasetProcessorLFM360K-47"><span class="linenos"> 47</span></a>        <span class="c1"># buffer for the user sha and artist name lists</span>
</span><span id="DatasetProcessorLFM360K-48"><a href="#DatasetProcessorLFM360K-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">user_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DatasetProcessorLFM360K-49"><a href="#DatasetProcessorLFM360K-49"><span class="linenos"> 49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DatasetProcessorLFM360K-50"><a href="#DatasetProcessorLFM360K-50"><span class="linenos"> 50</span></a>        <span class="c1"># buffer for the artist name/musicbrainzID dataframe</span>
</span><span id="DatasetProcessorLFM360K-51"><a href="#DatasetProcessorLFM360K-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DatasetProcessorLFM360K-52"><a href="#DatasetProcessorLFM360K-52"><span class="linenos"> 52</span></a>
</span><span id="DatasetProcessorLFM360K-53"><a href="#DatasetProcessorLFM360K-53"><span class="linenos"> 53</span></a>    <span class="k">def</span> <span class="nf">create_listening_events_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetTableConfig</span><span class="p">]:</span>
</span><span id="DatasetProcessorLFM360K-54"><a href="#DatasetProcessorLFM360K-54"><span class="linenos"> 54</span></a>        <span class="sd">&quot;&quot;&quot;Create the listening event table configuration.</span>
</span><span id="DatasetProcessorLFM360K-55"><a href="#DatasetProcessorLFM360K-55"><span class="linenos"> 55</span></a>
</span><span id="DatasetProcessorLFM360K-56"><a href="#DatasetProcessorLFM360K-56"><span class="linenos"> 56</span></a><span class="sd">        No listening events are available for this dataset.</span>
</span><span id="DatasetProcessorLFM360K-57"><a href="#DatasetProcessorLFM360K-57"><span class="linenos"> 57</span></a>
</span><span id="DatasetProcessorLFM360K-58"><a href="#DatasetProcessorLFM360K-58"><span class="linenos"> 58</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K-59"><a href="#DatasetProcessorLFM360K-59"><span class="linenos"> 59</span></a><span class="sd">            None.</span>
</span><span id="DatasetProcessorLFM360K-60"><a href="#DatasetProcessorLFM360K-60"><span class="linenos"> 60</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K-61"><a href="#DatasetProcessorLFM360K-61"><span class="linenos"> 61</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="DatasetProcessorLFM360K-62"><a href="#DatasetProcessorLFM360K-62"><span class="linenos"> 62</span></a>
</span><span id="DatasetProcessorLFM360K-63"><a href="#DatasetProcessorLFM360K-63"><span class="linenos"> 63</span></a>    <span class="k">def</span> <span class="nf">create_user_table_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetTableConfig</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K-64"><a href="#DatasetProcessorLFM360K-64"><span class="linenos"> 64</span></a>        <span class="sd">&quot;&quot;&quot;Create the user table configuration.</span>
</span><span id="DatasetProcessorLFM360K-65"><a href="#DatasetProcessorLFM360K-65"><span class="linenos"> 65</span></a>
</span><span id="DatasetProcessorLFM360K-66"><a href="#DatasetProcessorLFM360K-66"><span class="linenos"> 66</span></a><span class="sd">        The base user configuration that contains the generated user ids</span>
</span><span id="DatasetProcessorLFM360K-67"><a href="#DatasetProcessorLFM360K-67"><span class="linenos"> 67</span></a><span class="sd">        and corresponding user sha.</span>
</span><span id="DatasetProcessorLFM360K-68"><a href="#DatasetProcessorLFM360K-68"><span class="linenos"> 68</span></a>
</span><span id="DatasetProcessorLFM360K-69"><a href="#DatasetProcessorLFM360K-69"><span class="linenos"> 69</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K-70"><a href="#DatasetProcessorLFM360K-70"><span class="linenos"> 70</span></a><span class="sd">            the configuration of the user table.</span>
</span><span id="DatasetProcessorLFM360K-71"><a href="#DatasetProcessorLFM360K-71"><span class="linenos"> 71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K-72"><a href="#DatasetProcessorLFM360K-72"><span class="linenos"> 72</span></a>        <span class="k">return</span> <span class="n">create_dataset_table_config</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K-73"><a href="#DatasetProcessorLFM360K-73"><span class="linenos"> 73</span></a>            <span class="n">TABLE_FILE_PREFIX</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s1">&#39;_users.tsv.bz2&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-74"><a href="#DatasetProcessorLFM360K-74"><span class="linenos"> 74</span></a>            <span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">],</span>
</span><span id="DatasetProcessorLFM360K-75"><a href="#DatasetProcessorLFM360K-75"><span class="linenos"> 75</span></a>            <span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">],</span>
</span><span id="DatasetProcessorLFM360K-76"><a href="#DatasetProcessorLFM360K-76"><span class="linenos"> 76</span></a>            <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;bz2&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-77"><a href="#DatasetProcessorLFM360K-77"><span class="linenos"> 77</span></a>            <span class="n">num_records</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_list</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-78"><a href="#DatasetProcessorLFM360K-78"><span class="linenos"> 78</span></a>        <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-79"><a href="#DatasetProcessorLFM360K-79"><span class="linenos"> 79</span></a>
</span><span id="DatasetProcessorLFM360K-80"><a href="#DatasetProcessorLFM360K-80"><span class="linenos"> 80</span></a>    <span class="k">def</span> <span class="nf">get_matrix_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetMatrixConfig</span><span class="p">]]]]:</span>
</span><span id="DatasetProcessorLFM360K-81"><a href="#DatasetProcessorLFM360K-81"><span class="linenos"> 81</span></a>        <span class="sd">&quot;&quot;&quot;Get matrix configuration processors.</span>
</span><span id="DatasetProcessorLFM360K-82"><a href="#DatasetProcessorLFM360K-82"><span class="linenos"> 82</span></a>
</span><span id="DatasetProcessorLFM360K-83"><a href="#DatasetProcessorLFM360K-83"><span class="linenos"> 83</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K-84"><a href="#DatasetProcessorLFM360K-84"><span class="linenos"> 84</span></a><span class="sd">            a list containing the user-artist-count matrix processor.</span>
</span><span id="DatasetProcessorLFM360K-85"><a href="#DatasetProcessorLFM360K-85"><span class="linenos"> 85</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K-86"><a href="#DatasetProcessorLFM360K-86"><span class="linenos"> 86</span></a>        <span class="k">return</span> <span class="p">[(</span><span class="s1">&#39;user-artist-count&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_user_artist_matrix</span><span class="p">)]</span>
</span><span id="DatasetProcessorLFM360K-87"><a href="#DatasetProcessorLFM360K-87"><span class="linenos"> 87</span></a>
</span><span id="DatasetProcessorLFM360K-88"><a href="#DatasetProcessorLFM360K-88"><span class="linenos"> 88</span></a>    <span class="k">def</span> <span class="nf">get_table_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetTableConfig</span><span class="p">]]]]:</span>
</span><span id="DatasetProcessorLFM360K-89"><a href="#DatasetProcessorLFM360K-89"><span class="linenos"> 89</span></a>        <span class="sd">&quot;&quot;&quot;Get table configuration processors.</span>
</span><span id="DatasetProcessorLFM360K-90"><a href="#DatasetProcessorLFM360K-90"><span class="linenos"> 90</span></a>
</span><span id="DatasetProcessorLFM360K-91"><a href="#DatasetProcessorLFM360K-91"><span class="linenos"> 91</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K-92"><a href="#DatasetProcessorLFM360K-92"><span class="linenos"> 92</span></a><span class="sd">            a list containing the artist and user table processors.</span>
</span><span id="DatasetProcessorLFM360K-93"><a href="#DatasetProcessorLFM360K-93"><span class="linenos"> 93</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K-94"><a href="#DatasetProcessorLFM360K-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="n">DatasetProcessorLFM</span><span class="o">.</span><span class="n">get_table_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="p">[(</span><span class="s1">&#39;artist&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">process_artist_table</span><span class="p">)]</span>
</span><span id="DatasetProcessorLFM360K-95"><a href="#DatasetProcessorLFM360K-95"><span class="linenos"> 95</span></a>
</span><span id="DatasetProcessorLFM360K-96"><a href="#DatasetProcessorLFM360K-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">load_artist_gender_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="DatasetProcessorLFM360K-97"><a href="#DatasetProcessorLFM360K-97"><span class="linenos"> 97</span></a>        <span class="sd">&quot;&quot;&quot;Load the artist gender json file.</span>
</span><span id="DatasetProcessorLFM360K-98"><a href="#DatasetProcessorLFM360K-98"><span class="linenos"> 98</span></a>
</span><span id="DatasetProcessorLFM360K-99"><a href="#DatasetProcessorLFM360K-99"><span class="linenos"> 99</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K-100"><a href="#DatasetProcessorLFM360K-100"><span class="linenos">100</span></a><span class="sd">            the loaded artist musicbrainzID/gender table or None on failure.</span>
</span><span id="DatasetProcessorLFM360K-101"><a href="#DatasetProcessorLFM360K-101"><span class="linenos">101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K-102"><a href="#DatasetProcessorLFM360K-102"><span class="linenos">102</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K-103"><a href="#DatasetProcessorLFM360K-103"><span class="linenos">103</span></a>            <span class="n">gender_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K-104"><a href="#DatasetProcessorLFM360K-104"><span class="linenos">104</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="s1">&#39;lfm-360-gender.json&#39;</span><span class="p">),</span>
</span><span id="DatasetProcessorLFM360K-105"><a href="#DatasetProcessorLFM360K-105"><span class="linenos">105</span></a>                <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span>
</span><span id="DatasetProcessorLFM360K-106"><a href="#DatasetProcessorLFM360K-106"><span class="linenos">106</span></a>            <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-107"><a href="#DatasetProcessorLFM360K-107"><span class="linenos">107</span></a>            <span class="n">gender_table</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-108"><a href="#DatasetProcessorLFM360K-108"><span class="linenos">108</span></a>            <span class="n">gender_table</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;artist_mbID&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;artist_gender&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-109"><a href="#DatasetProcessorLFM360K-109"><span class="linenos">109</span></a>            <span class="k">return</span> <span class="n">gender_table</span>
</span><span id="DatasetProcessorLFM360K-110"><a href="#DatasetProcessorLFM360K-110"><span class="linenos">110</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K-111"><a href="#DatasetProcessorLFM360K-111"><span class="linenos">111</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="DatasetProcessorLFM360K-112"><a href="#DatasetProcessorLFM360K-112"><span class="linenos">112</span></a>
</span><span id="DatasetProcessorLFM360K-113"><a href="#DatasetProcessorLFM360K-113"><span class="linenos">113</span></a>    <span class="k">def</span> <span class="nf">load_user_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="DatasetProcessorLFM360K-114"><a href="#DatasetProcessorLFM360K-114"><span class="linenos">114</span></a>        <span class="sd">&quot;&quot;&quot;Load the original user table.</span>
</span><span id="DatasetProcessorLFM360K-115"><a href="#DatasetProcessorLFM360K-115"><span class="linenos">115</span></a>
</span><span id="DatasetProcessorLFM360K-116"><a href="#DatasetProcessorLFM360K-116"><span class="linenos">116</span></a><span class="sd">        Changes the contents of the age and gender columns to be more user-friendly,</span>
</span><span id="DatasetProcessorLFM360K-117"><a href="#DatasetProcessorLFM360K-117"><span class="linenos">117</span></a><span class="sd">        and the contents of the country column to ISO 3166 Alpha-2 country codes.</span>
</span><span id="DatasetProcessorLFM360K-118"><a href="#DatasetProcessorLFM360K-118"><span class="linenos">118</span></a>
</span><span id="DatasetProcessorLFM360K-119"><a href="#DatasetProcessorLFM360K-119"><span class="linenos">119</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K-120"><a href="#DatasetProcessorLFM360K-120"><span class="linenos">120</span></a><span class="sd">            the loaded user table on None on failure.</span>
</span><span id="DatasetProcessorLFM360K-121"><a href="#DatasetProcessorLFM360K-121"><span class="linenos">121</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K-122"><a href="#DatasetProcessorLFM360K-122"><span class="linenos">122</span></a>        <span class="n">user_table_columns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DatasetProcessorLFM360K-123"><a href="#DatasetProcessorLFM360K-123"><span class="linenos">123</span></a>            <span class="s1">&#39;user_sha&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-124"><a href="#DatasetProcessorLFM360K-124"><span class="linenos">124</span></a>            <span class="s1">&#39;user_gender&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-125"><a href="#DatasetProcessorLFM360K-125"><span class="linenos">125</span></a>            <span class="s1">&#39;user_age&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-126"><a href="#DatasetProcessorLFM360K-126"><span class="linenos">126</span></a>            <span class="s1">&#39;user_country&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-127"><a href="#DatasetProcessorLFM360K-127"><span class="linenos">127</span></a>            <span class="s1">&#39;user_signup&#39;</span>
</span><span id="DatasetProcessorLFM360K-128"><a href="#DatasetProcessorLFM360K-128"><span class="linenos">128</span></a>        <span class="p">]</span>
</span><span id="DatasetProcessorLFM360K-129"><a href="#DatasetProcessorLFM360K-129"><span class="linenos">129</span></a>
</span><span id="DatasetProcessorLFM360K-130"><a href="#DatasetProcessorLFM360K-130"><span class="linenos">130</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K-131"><a href="#DatasetProcessorLFM360K-131"><span class="linenos">131</span></a>            <span class="c1"># load original user table</span>
</span><span id="DatasetProcessorLFM360K-132"><a href="#DatasetProcessorLFM360K-132"><span class="linenos">132</span></a>            <span class="n">user_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K-133"><a href="#DatasetProcessorLFM360K-133"><span class="linenos">133</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="s1">&#39;usersha1-profile.tsv&#39;</span><span class="p">),</span>
</span><span id="DatasetProcessorLFM360K-134"><a href="#DatasetProcessorLFM360K-134"><span class="linenos">134</span></a>                <span class="n">names</span><span class="o">=</span><span class="n">user_table_columns</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-135"><a href="#DatasetProcessorLFM360K-135"><span class="linenos">135</span></a>                <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span>
</span><span id="DatasetProcessorLFM360K-136"><a href="#DatasetProcessorLFM360K-136"><span class="linenos">136</span></a>            <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-137"><a href="#DatasetProcessorLFM360K-137"><span class="linenos">137</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K-138"><a href="#DatasetProcessorLFM360K-138"><span class="linenos">138</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="DatasetProcessorLFM360K-139"><a href="#DatasetProcessorLFM360K-139"><span class="linenos">139</span></a>
</span><span id="DatasetProcessorLFM360K-140"><a href="#DatasetProcessorLFM360K-140"><span class="linenos">140</span></a>        <span class="c1"># mask user age not between 1-100 as NaN</span>
</span><span id="DatasetProcessorLFM360K-141"><a href="#DatasetProcessorLFM360K-141"><span class="linenos">141</span></a>        <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-142"><a href="#DatasetProcessorLFM360K-142"><span class="linenos">142</span></a>        <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-143"><a href="#DatasetProcessorLFM360K-143"><span class="linenos">143</span></a>
</span><span id="DatasetProcessorLFM360K-144"><a href="#DatasetProcessorLFM360K-144"><span class="linenos">144</span></a>        <span class="c1"># convert gender to more user-friendly names</span>
</span><span id="DatasetProcessorLFM360K-145"><a href="#DatasetProcessorLFM360K-145"><span class="linenos">145</span></a>        <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="s1">&#39;Female&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-146"><a href="#DatasetProcessorLFM360K-146"><span class="linenos">146</span></a>
</span><span id="DatasetProcessorLFM360K-147"><a href="#DatasetProcessorLFM360K-147"><span class="linenos">147</span></a>        <span class="c1"># convert country to ISO 3166 Alpha-2 country code</span>
</span><span id="DatasetProcessorLFM360K-148"><a href="#DatasetProcessorLFM360K-148"><span class="linenos">148</span></a>        <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span>
</span><span id="DatasetProcessorLFM360K-149"><a href="#DatasetProcessorLFM360K-149"><span class="linenos">149</span></a>            <span class="s1">&#39;Afghanistan&#39;</span><span class="p">:</span> <span class="s1">&#39;AF&#39;</span><span class="p">,</span> <span class="s1">&#39;Albania&#39;</span><span class="p">:</span> <span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;Algeria&#39;</span><span class="p">:</span> <span class="s1">&#39;DZ&#39;</span><span class="p">,</span> <span class="s1">&#39;American Samoa&#39;</span><span class="p">:</span> <span class="s1">&#39;AS&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-150"><a href="#DatasetProcessorLFM360K-150"><span class="linenos">150</span></a>            <span class="s1">&#39;Andorra&#39;</span><span class="p">:</span> <span class="s1">&#39;AD&#39;</span><span class="p">,</span> <span class="s1">&#39;Angola&#39;</span><span class="p">:</span> <span class="s1">&#39;AO&#39;</span><span class="p">,</span> <span class="s1">&#39;Anguilla&#39;</span><span class="p">:</span> <span class="s1">&#39;AI&#39;</span><span class="p">,</span> <span class="s1">&#39;Antarctica&#39;</span><span class="p">:</span> <span class="s1">&#39;AQ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-151"><a href="#DatasetProcessorLFM360K-151"><span class="linenos">151</span></a>            <span class="s1">&#39;Antigua and Barbuda&#39;</span><span class="p">:</span> <span class="s1">&#39;AG&#39;</span><span class="p">,</span> <span class="s1">&#39;Argentina&#39;</span><span class="p">:</span> <span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;Armenia&#39;</span><span class="p">:</span> <span class="s1">&#39;AM&#39;</span><span class="p">,</span> <span class="s1">&#39;Aruba&#39;</span><span class="p">:</span> <span class="s1">&#39;AW&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-152"><a href="#DatasetProcessorLFM360K-152"><span class="linenos">152</span></a>            <span class="s1">&#39;Australia&#39;</span><span class="p">:</span> <span class="s1">&#39;AU&#39;</span><span class="p">,</span> <span class="s1">&#39;Austria&#39;</span><span class="p">:</span> <span class="s1">&#39;AT&#39;</span><span class="p">,</span> <span class="s1">&#39;Azerbaijan&#39;</span><span class="p">:</span> <span class="s1">&#39;AZ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-153"><a href="#DatasetProcessorLFM360K-153"><span class="linenos">153</span></a>            <span class="s1">&#39;Bahamas&#39;</span><span class="p">:</span> <span class="s1">&#39;BS&#39;</span><span class="p">,</span> <span class="s1">&#39;Bahrain&#39;</span><span class="p">:</span> <span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="s1">&#39;Bangladesh&#39;</span><span class="p">:</span> <span class="s1">&#39;BD&#39;</span><span class="p">,</span> <span class="s1">&#39;Barbados&#39;</span><span class="p">:</span> <span class="s1">&#39;BB&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-154"><a href="#DatasetProcessorLFM360K-154"><span class="linenos">154</span></a>            <span class="s1">&#39;Belarus&#39;</span><span class="p">:</span> <span class="s1">&#39;BY&#39;</span><span class="p">,</span> <span class="s1">&#39;Belgium&#39;</span><span class="p">:</span> <span class="s1">&#39;BE&#39;</span><span class="p">,</span> <span class="s1">&#39;Belize&#39;</span><span class="p">:</span> <span class="s1">&#39;BZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Benin&#39;</span><span class="p">:</span> <span class="s1">&#39;BJ&#39;</span><span class="p">,</span> <span class="s1">&#39;Bermuda&#39;</span><span class="p">:</span> <span class="s1">&#39;BM&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-155"><a href="#DatasetProcessorLFM360K-155"><span class="linenos">155</span></a>            <span class="s1">&#39;Bhutan&#39;</span><span class="p">:</span> <span class="s1">&#39;BT&#39;</span><span class="p">,</span> <span class="s1">&#39;Bolivia&#39;</span><span class="p">:</span> <span class="s1">&#39;BO&#39;</span><span class="p">,</span> <span class="s1">&#39;Bosnia and Herzegovina&#39;</span><span class="p">:</span> <span class="s1">&#39;BA&#39;</span><span class="p">,</span> <span class="s1">&#39;Botswana&#39;</span><span class="p">:</span> <span class="s1">&#39;BW&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-156"><a href="#DatasetProcessorLFM360K-156"><span class="linenos">156</span></a>            <span class="s1">&#39;Bouvet Island&#39;</span><span class="p">:</span> <span class="s1">&#39;BV&#39;</span><span class="p">,</span> <span class="s1">&#39;Brazil&#39;</span><span class="p">:</span> <span class="s1">&#39;BR&#39;</span><span class="p">,</span> <span class="s1">&#39;British Indian Ocean Territory&#39;</span><span class="p">:</span> <span class="s1">&#39;IO&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-157"><a href="#DatasetProcessorLFM360K-157"><span class="linenos">157</span></a>            <span class="s1">&#39;Brunei Darussalam&#39;</span><span class="p">:</span> <span class="s1">&#39;BN&#39;</span><span class="p">,</span> <span class="s1">&#39;Bulgaria&#39;</span><span class="p">:</span> <span class="s1">&#39;BG&#39;</span><span class="p">,</span> <span class="s1">&#39;Burkina Faso&#39;</span><span class="p">:</span> <span class="s1">&#39;BF&#39;</span><span class="p">,</span> <span class="s1">&#39;Burundi&#39;</span><span class="p">:</span> <span class="s1">&#39;BI&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-158"><a href="#DatasetProcessorLFM360K-158"><span class="linenos">158</span></a>            <span class="s1">&#39;Cambodia&#39;</span><span class="p">:</span> <span class="s1">&#39;KH&#39;</span><span class="p">,</span> <span class="s1">&#39;Cameroon&#39;</span><span class="p">:</span> <span class="s1">&#39;CM&#39;</span><span class="p">,</span> <span class="s1">&#39;Canada&#39;</span><span class="p">:</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39;Cape Verde&#39;</span><span class="p">:</span> <span class="s1">&#39;CV&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-159"><a href="#DatasetProcessorLFM360K-159"><span class="linenos">159</span></a>            <span class="s1">&#39;Cayman Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;KY&#39;</span><span class="p">,</span> <span class="s1">&#39;Central African Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;CF&#39;</span><span class="p">,</span> <span class="s1">&#39;Chad&#39;</span><span class="p">:</span> <span class="s1">&#39;TD&#39;</span><span class="p">,</span> <span class="s1">&#39;Chile&#39;</span><span class="p">:</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-160"><a href="#DatasetProcessorLFM360K-160"><span class="linenos">160</span></a>            <span class="s1">&#39;China&#39;</span><span class="p">:</span> <span class="s1">&#39;CN&#39;</span><span class="p">,</span> <span class="s1">&#39;Christmas Island&#39;</span><span class="p">:</span> <span class="s1">&#39;CX&#39;</span><span class="p">,</span> <span class="s1">&#39;Cocos (Keeling) Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-161"><a href="#DatasetProcessorLFM360K-161"><span class="linenos">161</span></a>            <span class="s1">&#39;Colombia&#39;</span><span class="p">:</span> <span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;Comoros&#39;</span><span class="p">:</span> <span class="s1">&#39;KM&#39;</span><span class="p">,</span> <span class="s1">&#39;Congo&#39;</span><span class="p">:</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="s1">&#39;Czech Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;CZ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-162"><a href="#DatasetProcessorLFM360K-162"><span class="linenos">162</span></a>            <span class="s1">&#39;Congo, the Democratic Republic of the&#39;</span><span class="p">:</span> <span class="s1">&#39;CD&#39;</span><span class="p">,</span> <span class="s1">&#39;Cook Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;CK&#39;</span><span class="p">,</span> <span class="s1">&#39;Cyprus&#39;</span><span class="p">:</span> <span class="s1">&#39;CY&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-163"><a href="#DatasetProcessorLFM360K-163"><span class="linenos">163</span></a>            <span class="s1">&#39;Costa Rica&#39;</span><span class="p">:</span> <span class="s1">&#39;CR&#39;</span><span class="p">,</span> <span class="s1">&#39;Cote D</span><span class="se">\&#39;</span><span class="s1">Ivoire&#39;</span><span class="p">:</span> <span class="s1">&#39;CI&#39;</span><span class="p">,</span> <span class="s1">&#39;Croatia&#39;</span><span class="p">:</span> <span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Cuba&#39;</span><span class="p">:</span> <span class="s1">&#39;CU&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-164"><a href="#DatasetProcessorLFM360K-164"><span class="linenos">164</span></a>            <span class="s1">&#39;Denmark&#39;</span><span class="p">:</span> <span class="s1">&#39;DK&#39;</span><span class="p">,</span> <span class="s1">&#39;Djibouti&#39;</span><span class="p">:</span> <span class="s1">&#39;DJ&#39;</span><span class="p">,</span> <span class="s1">&#39;Dominica&#39;</span><span class="p">:</span> <span class="s1">&#39;DM&#39;</span><span class="p">,</span> <span class="s1">&#39;Dominican Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;DO&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-165"><a href="#DatasetProcessorLFM360K-165"><span class="linenos">165</span></a>            <span class="s1">&#39;Ecuador&#39;</span><span class="p">:</span> <span class="s1">&#39;EC&#39;</span><span class="p">,</span> <span class="s1">&#39;Egypt&#39;</span><span class="p">:</span> <span class="s1">&#39;EG&#39;</span><span class="p">,</span> <span class="s1">&#39;El Salvador&#39;</span><span class="p">:</span> <span class="s1">&#39;SV&#39;</span><span class="p">,</span> <span class="s1">&#39;Equatorial Guinea&#39;</span><span class="p">:</span> <span class="s1">&#39;GQ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-166"><a href="#DatasetProcessorLFM360K-166"><span class="linenos">166</span></a>            <span class="s1">&#39;Eritrea&#39;</span><span class="p">:</span> <span class="s1">&#39;ER&#39;</span><span class="p">,</span> <span class="s1">&#39;Estonia&#39;</span><span class="p">:</span> <span class="s1">&#39;EE&#39;</span><span class="p">,</span> <span class="s1">&#39;Ethiopia&#39;</span><span class="p">:</span> <span class="s1">&#39;ET&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-167"><a href="#DatasetProcessorLFM360K-167"><span class="linenos">167</span></a>            <span class="s1">&#39;Falkland Islands (Malvinas)&#39;</span><span class="p">:</span> <span class="s1">&#39;FK&#39;</span><span class="p">,</span> <span class="s1">&#39;Faroe Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;FO&#39;</span><span class="p">,</span> <span class="s1">&#39;Fiji&#39;</span><span class="p">:</span> <span class="s1">&#39;FJ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-168"><a href="#DatasetProcessorLFM360K-168"><span class="linenos">168</span></a>            <span class="s1">&#39;Finland&#39;</span><span class="p">:</span> <span class="s1">&#39;FI&#39;</span><span class="p">,</span> <span class="s1">&#39;France&#39;</span><span class="p">:</span> <span class="s1">&#39;FR&#39;</span><span class="p">,</span> <span class="s1">&#39;French Guiana&#39;</span><span class="p">:</span> <span class="s1">&#39;GF&#39;</span><span class="p">,</span> <span class="s1">&#39;French Polynesia&#39;</span><span class="p">:</span> <span class="s1">&#39;PF&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-169"><a href="#DatasetProcessorLFM360K-169"><span class="linenos">169</span></a>            <span class="s1">&#39;French Southern Territories&#39;</span><span class="p">:</span> <span class="s1">&#39;TF&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-170"><a href="#DatasetProcessorLFM360K-170"><span class="linenos">170</span></a>            <span class="s1">&#39;Gabon&#39;</span><span class="p">:</span> <span class="s1">&#39;GA&#39;</span><span class="p">,</span> <span class="s1">&#39;Gambia&#39;</span><span class="p">:</span> <span class="s1">&#39;GM&#39;</span><span class="p">,</span> <span class="s1">&#39;Georgia&#39;</span><span class="p">:</span> <span class="s1">&#39;GE&#39;</span><span class="p">,</span> <span class="s1">&#39;Germany&#39;</span><span class="p">:</span> <span class="s1">&#39;DE&#39;</span><span class="p">,</span> <span class="s1">&#39;Ghana&#39;</span><span class="p">:</span> <span class="s1">&#39;GH&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-171"><a href="#DatasetProcessorLFM360K-171"><span class="linenos">171</span></a>            <span class="s1">&#39;Grenada&#39;</span><span class="p">:</span> <span class="s1">&#39;GD&#39;</span><span class="p">,</span> <span class="s1">&#39;Gibraltar&#39;</span><span class="p">:</span> <span class="s1">&#39;GI&#39;</span><span class="p">,</span> <span class="s1">&#39;Greece&#39;</span><span class="p">:</span> <span class="s1">&#39;GR&#39;</span><span class="p">,</span> <span class="s1">&#39;Greenland&#39;</span><span class="p">:</span> <span class="s1">&#39;GL&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-172"><a href="#DatasetProcessorLFM360K-172"><span class="linenos">172</span></a>            <span class="s1">&#39;Guadeloupe&#39;</span><span class="p">:</span> <span class="s1">&#39;GP&#39;</span><span class="p">,</span> <span class="s1">&#39;Guam&#39;</span><span class="p">:</span> <span class="s1">&#39;GU&#39;</span><span class="p">,</span> <span class="s1">&#39;Guatemala&#39;</span><span class="p">:</span> <span class="s1">&#39;GT&#39;</span><span class="p">,</span> <span class="s1">&#39;Guinea-Bissau&#39;</span><span class="p">:</span> <span class="s1">&#39;GW&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-173"><a href="#DatasetProcessorLFM360K-173"><span class="linenos">173</span></a>            <span class="s1">&#39;Guyana&#39;</span><span class="p">:</span> <span class="s1">&#39;GY&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-174"><a href="#DatasetProcessorLFM360K-174"><span class="linenos">174</span></a>            <span class="s1">&#39;Haiti&#39;</span><span class="p">:</span> <span class="s1">&#39;HT&#39;</span><span class="p">,</span> <span class="s1">&#39;Heard Island and Mcdonald Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;HM&#39;</span><span class="p">,</span> <span class="s1">&#39;Hungary&#39;</span><span class="p">:</span> <span class="s1">&#39;HU&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-175"><a href="#DatasetProcessorLFM360K-175"><span class="linenos">175</span></a>            <span class="s1">&#39;Holy See (Vatican City State)&#39;</span><span class="p">:</span> <span class="s1">&#39;VA&#39;</span><span class="p">,</span> <span class="s1">&#39;Honduras&#39;</span><span class="p">:</span> <span class="s1">&#39;HN&#39;</span><span class="p">,</span> <span class="s1">&#39;Hong Kong&#39;</span><span class="p">:</span> <span class="s1">&#39;HK&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-176"><a href="#DatasetProcessorLFM360K-176"><span class="linenos">176</span></a>            <span class="s1">&#39;Iceland&#39;</span><span class="p">:</span> <span class="s1">&#39;IS&#39;</span><span class="p">,</span> <span class="s1">&#39;India&#39;</span><span class="p">:</span> <span class="s1">&#39;IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Indonesia&#39;</span><span class="p">:</span> <span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Iran, Islamic Republic of&#39;</span><span class="p">:</span> <span class="s1">&#39;IR&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-177"><a href="#DatasetProcessorLFM360K-177"><span class="linenos">177</span></a>            <span class="s1">&#39;Iraq&#39;</span><span class="p">:</span> <span class="s1">&#39;IQ&#39;</span><span class="p">,</span> <span class="s1">&#39;Ireland&#39;</span><span class="p">:</span> <span class="s1">&#39;IE&#39;</span><span class="p">,</span> <span class="s1">&#39;Israel&#39;</span><span class="p">:</span> <span class="s1">&#39;IL&#39;</span><span class="p">,</span> <span class="s1">&#39;Italy&#39;</span><span class="p">:</span> <span class="s1">&#39;IT&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-178"><a href="#DatasetProcessorLFM360K-178"><span class="linenos">178</span></a>            <span class="s1">&#39;Jamaica&#39;</span><span class="p">:</span> <span class="s1">&#39;JM&#39;</span><span class="p">,</span> <span class="s1">&#39;Japan&#39;</span><span class="p">:</span> <span class="s1">&#39;JP&#39;</span><span class="p">,</span> <span class="s1">&#39;Jordan&#39;</span><span class="p">:</span> <span class="s1">&#39;JO&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-179"><a href="#DatasetProcessorLFM360K-179"><span class="linenos">179</span></a>            <span class="s1">&#39;Kazakhstan&#39;</span><span class="p">:</span> <span class="s1">&#39;KZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Kenya&#39;</span><span class="p">:</span> <span class="s1">&#39;KE&#39;</span><span class="p">,</span> <span class="s1">&#39;Kiribati&#39;</span><span class="p">:</span> <span class="s1">&#39;KI&#39;</span><span class="p">,</span> <span class="s1">&#39;Kyrgyzstan&#39;</span><span class="p">:</span> <span class="s1">&#39;KG&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-180"><a href="#DatasetProcessorLFM360K-180"><span class="linenos">180</span></a>            <span class="s1">&#39;Korea, Democratic People</span><span class="se">\&#39;</span><span class="s1">s Republic of&#39;</span><span class="p">:</span><span class="s1">&#39;KP&#39;</span><span class="p">,</span><span class="s1">&#39;Korea, Republic of&#39;</span><span class="p">:</span><span class="s1">&#39;KR&#39;</span><span class="p">,</span><span class="s1">&#39;Kuwait&#39;</span><span class="p">:</span><span class="s1">&#39;KW&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-181"><a href="#DatasetProcessorLFM360K-181"><span class="linenos">181</span></a>            <span class="s1">&#39;Lao People</span><span class="se">\&#39;</span><span class="s1">s Democratic Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;LA&#39;</span><span class="p">,</span><span class="s1">&#39;Latvia&#39;</span><span class="p">:</span> <span class="s1">&#39;LV&#39;</span><span class="p">,</span><span class="s1">&#39;Lebanon&#39;</span><span class="p">:</span> <span class="s1">&#39;LB&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-182"><a href="#DatasetProcessorLFM360K-182"><span class="linenos">182</span></a>            <span class="s1">&#39;Lesotho&#39;</span><span class="p">:</span> <span class="s1">&#39;LS&#39;</span><span class="p">,</span> <span class="s1">&#39;Liberia&#39;</span><span class="p">:</span> <span class="s1">&#39;LR&#39;</span><span class="p">,</span> <span class="s1">&#39;Libyan Arab Jamahiriya&#39;</span><span class="p">:</span> <span class="s1">&#39;LY&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-183"><a href="#DatasetProcessorLFM360K-183"><span class="linenos">183</span></a>            <span class="s1">&#39;Liechtenstein&#39;</span><span class="p">:</span> <span class="s1">&#39;LI&#39;</span><span class="p">,</span> <span class="s1">&#39;Lithuania&#39;</span><span class="p">:</span> <span class="s1">&#39;LT&#39;</span><span class="p">,</span> <span class="s1">&#39;Luxembourg&#39;</span><span class="p">:</span> <span class="s1">&#39;LU&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-184"><a href="#DatasetProcessorLFM360K-184"><span class="linenos">184</span></a>            <span class="s1">&#39;Macao&#39;</span><span class="p">:</span> <span class="s1">&#39;MO&#39;</span><span class="p">,</span> <span class="s1">&#39;Macedonia&#39;</span><span class="p">:</span> <span class="s1">&#39;MK&#39;</span><span class="p">,</span> <span class="s1">&#39;Madagascar&#39;</span><span class="p">:</span> <span class="s1">&#39;MG&#39;</span><span class="p">,</span> <span class="s1">&#39;Mali&#39;</span><span class="p">:</span> <span class="s1">&#39;ML&#39;</span><span class="p">,</span> <span class="s1">&#39;Malta&#39;</span><span class="p">:</span> <span class="s1">&#39;MT&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-185"><a href="#DatasetProcessorLFM360K-185"><span class="linenos">185</span></a>            <span class="s1">&#39;Malaysia&#39;</span><span class="p">:</span> <span class="s1">&#39;MY&#39;</span><span class="p">,</span> <span class="s1">&#39;Malawi&#39;</span><span class="p">:</span> <span class="s1">&#39;MW&#39;</span><span class="p">,</span> <span class="s1">&#39;Maldives&#39;</span><span class="p">:</span> <span class="s1">&#39;MV&#39;</span><span class="p">,</span> <span class="s1">&#39;Mauritania&#39;</span><span class="p">:</span> <span class="s1">&#39;MR&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-186"><a href="#DatasetProcessorLFM360K-186"><span class="linenos">186</span></a>            <span class="s1">&#39;Mauritius&#39;</span><span class="p">:</span> <span class="s1">&#39;MU&#39;</span><span class="p">,</span> <span class="s1">&#39;Marshall Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;MH&#39;</span><span class="p">,</span> <span class="s1">&#39;Martinique&#39;</span><span class="p">:</span> <span class="s1">&#39;MQ&#39;</span><span class="p">,</span> <span class="s1">&#39;Mayotte&#39;</span><span class="p">:</span> <span class="s1">&#39;YT&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-187"><a href="#DatasetProcessorLFM360K-187"><span class="linenos">187</span></a>            <span class="s1">&#39;Mexico&#39;</span><span class="p">:</span> <span class="s1">&#39;MX&#39;</span><span class="p">,</span> <span class="s1">&#39;Micronesia, Federated States of&#39;</span><span class="p">:</span> <span class="s1">&#39;FM&#39;</span><span class="p">,</span><span class="s1">&#39;Moldova&#39;</span><span class="p">:</span> <span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;Monaco&#39;</span><span class="p">:</span> <span class="s1">&#39;MC&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-188"><a href="#DatasetProcessorLFM360K-188"><span class="linenos">188</span></a>            <span class="s1">&#39;Mongolia&#39;</span><span class="p">:</span> <span class="s1">&#39;MN&#39;</span><span class="p">,</span> <span class="s1">&#39;Montenegro&#39;</span><span class="p">:</span> <span class="s1">&#39;ME&#39;</span><span class="p">,</span> <span class="s1">&#39;Montserrat&#39;</span><span class="p">:</span>  <span class="s1">&#39;MS&#39;</span><span class="p">,</span> <span class="s1">&#39;Morocco&#39;</span><span class="p">:</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-189"><a href="#DatasetProcessorLFM360K-189"><span class="linenos">189</span></a>            <span class="s1">&#39;Mozambique&#39;</span><span class="p">:</span> <span class="s1">&#39;MZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Myanmar&#39;</span><span class="p">:</span> <span class="s1">&#39;MM&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-190"><a href="#DatasetProcessorLFM360K-190"><span class="linenos">190</span></a>            <span class="s1">&#39;Namibia&#39;</span><span class="p">:</span> <span class="s1">&#39;NA&#39;</span><span class="p">,</span> <span class="s1">&#39;Nauru&#39;</span><span class="p">:</span> <span class="s1">&#39;NR&#39;</span><span class="p">,</span> <span class="s1">&#39;Nepal&#39;</span><span class="p">:</span> <span class="s1">&#39;NP&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-191"><a href="#DatasetProcessorLFM360K-191"><span class="linenos">191</span></a>            <span class="s1">&#39;Netherlands&#39;</span><span class="p">:</span> <span class="s1">&#39;NL&#39;</span><span class="p">,</span> <span class="s1">&#39;Netherlands Antilles&#39;</span><span class="p">:</span> <span class="s1">&#39;NL&#39;</span><span class="p">,</span> <span class="s1">&#39;New Caledonia&#39;</span><span class="p">:</span> <span class="s1">&#39;NC&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-192"><a href="#DatasetProcessorLFM360K-192"><span class="linenos">192</span></a>            <span class="s1">&#39;New Zealand&#39;</span><span class="p">:</span> <span class="s1">&#39;NZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Nicaragua&#39;</span><span class="p">:</span> <span class="s1">&#39;NI&#39;</span><span class="p">,</span> <span class="s1">&#39;Niger&#39;</span><span class="p">:</span> <span class="s1">&#39;NE&#39;</span><span class="p">,</span> <span class="s1">&#39;Nigeria&#39;</span><span class="p">:</span> <span class="s1">&#39;NG&#39;</span><span class="p">,</span> <span class="s1">&#39;Niue&#39;</span><span class="p">:</span> <span class="s1">&#39;NU&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-193"><a href="#DatasetProcessorLFM360K-193"><span class="linenos">193</span></a>            <span class="s1">&#39;Norfolk Island&#39;</span><span class="p">:</span> <span class="s1">&#39;NF&#39;</span><span class="p">,</span> <span class="s1">&#39;Northern Mariana Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;MP&#39;</span><span class="p">,</span> <span class="s1">&#39;Norway&#39;</span><span class="p">:</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-194"><a href="#DatasetProcessorLFM360K-194"><span class="linenos">194</span></a>            <span class="s1">&#39;Oman&#39;</span><span class="p">:</span> <span class="s1">&#39;OM&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-195"><a href="#DatasetProcessorLFM360K-195"><span class="linenos">195</span></a>            <span class="s1">&#39;Pakistan&#39;</span><span class="p">:</span> <span class="s1">&#39;PK&#39;</span><span class="p">,</span> <span class="s1">&#39;Palau&#39;</span><span class="p">:</span> <span class="s1">&#39;PW&#39;</span><span class="p">,</span><span class="s1">&#39;Palestinian Territory, Occupied&#39;</span><span class="p">:</span> <span class="s1">&#39;PS&#39;</span><span class="p">,</span><span class="s1">&#39;Panama&#39;</span><span class="p">:</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-196"><a href="#DatasetProcessorLFM360K-196"><span class="linenos">196</span></a>            <span class="s1">&#39;Papua New Guinea&#39;</span><span class="p">:</span> <span class="s1">&#39;PG&#39;</span><span class="p">,</span> <span class="s1">&#39;Paraguay&#39;</span><span class="p">:</span> <span class="s1">&#39;PY&#39;</span><span class="p">,</span> <span class="s1">&#39;Peru&#39;</span><span class="p">:</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span> <span class="s1">&#39;Philippines&#39;</span><span class="p">:</span> <span class="s1">&#39;PH&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-197"><a href="#DatasetProcessorLFM360K-197"><span class="linenos">197</span></a>            <span class="s1">&#39;Pitcairn&#39;</span><span class="p">:</span> <span class="s1">&#39;PN&#39;</span><span class="p">,</span> <span class="s1">&#39;Poland&#39;</span><span class="p">:</span> <span class="s1">&#39;PL&#39;</span><span class="p">,</span> <span class="s1">&#39;Portugal&#39;</span><span class="p">:</span> <span class="s1">&#39;PT&#39;</span><span class="p">,</span> <span class="s1">&#39;Puerto Rico&#39;</span><span class="p">:</span> <span class="s1">&#39;PR&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-198"><a href="#DatasetProcessorLFM360K-198"><span class="linenos">198</span></a>            <span class="s1">&#39;Qatar&#39;</span><span class="p">:</span> <span class="s1">&#39;QA&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-199"><a href="#DatasetProcessorLFM360K-199"><span class="linenos">199</span></a>            <span class="s1">&#39;Reunion&#39;</span><span class="p">:</span> <span class="s1">&#39;RE&#39;</span><span class="p">,</span> <span class="s1">&#39;Romania&#39;</span><span class="p">:</span> <span class="s1">&#39;RO&#39;</span><span class="p">,</span> <span class="s1">&#39;Russian Federation&#39;</span><span class="p">:</span> <span class="s1">&#39;RU&#39;</span><span class="p">,</span> <span class="s1">&#39;Rwanda&#39;</span><span class="p">:</span> <span class="s1">&#39;RW&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-200"><a href="#DatasetProcessorLFM360K-200"><span class="linenos">200</span></a>            <span class="s1">&#39;Saint Helena&#39;</span><span class="p">:</span> <span class="s1">&#39;SH&#39;</span><span class="p">,</span> <span class="s1">&#39;Saint Kitts and Nevis&#39;</span><span class="p">:</span> <span class="s1">&#39;KN&#39;</span><span class="p">,</span> <span class="s1">&#39;Saint Lucia&#39;</span><span class="p">:</span> <span class="s1">&#39;LC&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-201"><a href="#DatasetProcessorLFM360K-201"><span class="linenos">201</span></a>            <span class="s1">&#39;Saint Pierre and Miquelon&#39;</span><span class="p">:</span> <span class="s1">&#39;PM&#39;</span><span class="p">,</span> <span class="s1">&#39;Saint Vincent and the Grenadines&#39;</span><span class="p">:</span> <span class="s1">&#39;VC&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-202"><a href="#DatasetProcessorLFM360K-202"><span class="linenos">202</span></a>            <span class="s1">&#39;Samoa&#39;</span><span class="p">:</span> <span class="s1">&#39;WS&#39;</span><span class="p">,</span> <span class="s1">&#39;San Marino&#39;</span><span class="p">:</span> <span class="s1">&#39;SM&#39;</span><span class="p">,</span> <span class="s1">&#39;Sao Tome and Principe&#39;</span><span class="p">:</span> <span class="s1">&#39;ST&#39;</span><span class="p">,</span> <span class="s1">&#39;Saudi Arabia&#39;</span><span class="p">:</span> <span class="s1">&#39;SA&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-203"><a href="#DatasetProcessorLFM360K-203"><span class="linenos">203</span></a>            <span class="s1">&#39;Senegal&#39;</span><span class="p">:</span> <span class="s1">&#39;SN&#39;</span><span class="p">,</span> <span class="s1">&#39;Serbia&#39;</span><span class="p">:</span> <span class="s1">&#39;RS&#39;</span><span class="p">,</span> <span class="s1">&#39;Seychelles&#39;</span><span class="p">:</span> <span class="s1">&#39;SC&#39;</span><span class="p">,</span> <span class="s1">&#39;Sierra Leone&#39;</span><span class="p">:</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-204"><a href="#DatasetProcessorLFM360K-204"><span class="linenos">204</span></a>            <span class="s1">&#39;Singapore&#39;</span><span class="p">:</span> <span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;Solomon Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;SB&#39;</span><span class="p">,</span> <span class="s1">&#39;Somalia&#39;</span><span class="p">:</span> <span class="s1">&#39;SO&#39;</span><span class="p">,</span> <span class="s1">&#39;South Africa&#39;</span><span class="p">:</span> <span class="s1">&#39;ZA&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-205"><a href="#DatasetProcessorLFM360K-205"><span class="linenos">205</span></a>            <span class="s1">&#39;Slovakia&#39;</span><span class="p">:</span> <span class="s1">&#39;SK&#39;</span><span class="p">,</span><span class="s1">&#39;Slovenia&#39;</span><span class="p">:</span> <span class="s1">&#39;SI&#39;</span><span class="p">,</span><span class="s1">&#39;South Georgia and the South Sandwich Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;GS&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-206"><a href="#DatasetProcessorLFM360K-206"><span class="linenos">206</span></a>            <span class="s1">&#39;Spain&#39;</span><span class="p">:</span> <span class="s1">&#39;ES&#39;</span><span class="p">,</span> <span class="s1">&#39;Sri Lanka&#39;</span><span class="p">:</span> <span class="s1">&#39;LK&#39;</span><span class="p">,</span> <span class="s1">&#39;Sudan&#39;</span><span class="p">:</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;Suriname&#39;</span><span class="p">:</span> <span class="s1">&#39;SR&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-207"><a href="#DatasetProcessorLFM360K-207"><span class="linenos">207</span></a>            <span class="s1">&#39;Svalbard and Jan Mayen&#39;</span><span class="p">:</span> <span class="s1">&#39;SJ&#39;</span><span class="p">,</span> <span class="s1">&#39;Syrian Arab Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;SY&#39;</span><span class="p">,</span> <span class="s1">&#39;Swaziland&#39;</span><span class="p">:</span> <span class="s1">&#39;SZ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-208"><a href="#DatasetProcessorLFM360K-208"><span class="linenos">208</span></a>            <span class="s1">&#39;Sweden&#39;</span><span class="p">:</span> <span class="s1">&#39;SE&#39;</span><span class="p">,</span> <span class="s1">&#39;Switzerland&#39;</span><span class="p">:</span> <span class="s1">&#39;CH&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-209"><a href="#DatasetProcessorLFM360K-209"><span class="linenos">209</span></a>            <span class="s1">&#39;Taiwan&#39;</span><span class="p">:</span> <span class="s1">&#39;TW&#39;</span><span class="p">,</span> <span class="s1">&#39;Tajikistan&#39;</span><span class="p">:</span> <span class="s1">&#39;TJ&#39;</span><span class="p">,</span> <span class="s1">&#39;Tanzania, United Republic of&#39;</span><span class="p">:</span> <span class="s1">&#39;TZ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-210"><a href="#DatasetProcessorLFM360K-210"><span class="linenos">210</span></a>            <span class="s1">&#39;Thailand&#39;</span><span class="p">:</span> <span class="s1">&#39;TH&#39;</span><span class="p">,</span> <span class="s1">&#39;Timor-Leste&#39;</span><span class="p">:</span> <span class="s1">&#39;TL&#39;</span><span class="p">,</span> <span class="s1">&#39;Togo&#39;</span><span class="p">:</span> <span class="s1">&#39;TG&#39;</span><span class="p">,</span> <span class="s1">&#39;Tokelau&#39;</span><span class="p">:</span> <span class="s1">&#39;TK&#39;</span><span class="p">,</span> <span class="s1">&#39;Tonga&#39;</span><span class="p">:</span> <span class="s1">&#39;TO&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-211"><a href="#DatasetProcessorLFM360K-211"><span class="linenos">211</span></a>            <span class="s1">&#39;Trinidad and Tobago&#39;</span><span class="p">:</span> <span class="s1">&#39;TT&#39;</span><span class="p">,</span> <span class="s1">&#39;Tunisia&#39;</span><span class="p">:</span> <span class="s1">&#39;TN&#39;</span><span class="p">,</span> <span class="s1">&#39;Turkey&#39;</span><span class="p">:</span> <span class="s1">&#39;TR&#39;</span><span class="p">,</span> <span class="s1">&#39;Turkmenistan&#39;</span><span class="p">:</span> <span class="s1">&#39;TM&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-212"><a href="#DatasetProcessorLFM360K-212"><span class="linenos">212</span></a>            <span class="s1">&#39;Turks and Caicos Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;TC&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuvalu&#39;</span><span class="p">:</span> <span class="s1">&#39;TV&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-213"><a href="#DatasetProcessorLFM360K-213"><span class="linenos">213</span></a>            <span class="s1">&#39;Uganda&#39;</span><span class="p">:</span> <span class="s1">&#39;UG&#39;</span><span class="p">,</span> <span class="s1">&#39;Ukraine&#39;</span><span class="p">:</span> <span class="s1">&#39;UA&#39;</span><span class="p">,</span> <span class="s1">&#39;United Arab Emirates&#39;</span><span class="p">:</span> <span class="s1">&#39;AE&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-214"><a href="#DatasetProcessorLFM360K-214"><span class="linenos">214</span></a>            <span class="s1">&#39;United Kingdom&#39;</span><span class="p">:</span><span class="s1">&#39;GB&#39;</span><span class="p">,</span><span class="s1">&#39;United States&#39;</span><span class="p">:</span><span class="s1">&#39;US&#39;</span><span class="p">,</span><span class="s1">&#39;United States Minor Outlying Islands&#39;</span><span class="p">:</span><span class="s1">&#39;UM&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-215"><a href="#DatasetProcessorLFM360K-215"><span class="linenos">215</span></a>            <span class="s1">&#39;Uruguay&#39;</span><span class="p">:</span> <span class="s1">&#39;UY&#39;</span><span class="p">,</span> <span class="s1">&#39;Uzbekistan&#39;</span><span class="p">:</span> <span class="s1">&#39;UZ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-216"><a href="#DatasetProcessorLFM360K-216"><span class="linenos">216</span></a>            <span class="s1">&#39;Vanuatu&#39;</span><span class="p">:</span> <span class="s1">&#39;VU&#39;</span><span class="p">,</span> <span class="s1">&#39;Venezuela&#39;</span><span class="p">:</span> <span class="s1">&#39;VE&#39;</span><span class="p">,</span> <span class="s1">&#39;Viet Nam&#39;</span><span class="p">:</span> <span class="s1">&#39;VN&#39;</span><span class="p">,</span> <span class="s1">&#39;Virgin Islands, British&#39;</span><span class="p">:</span> <span class="s1">&#39;VG&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-217"><a href="#DatasetProcessorLFM360K-217"><span class="linenos">217</span></a>            <span class="s1">&#39;Virgin Islands, U.s.&#39;</span><span class="p">:</span> <span class="s1">&#39;VI&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-218"><a href="#DatasetProcessorLFM360K-218"><span class="linenos">218</span></a>            <span class="s1">&#39;Yemen&#39;</span><span class="p">:</span> <span class="s1">&#39;YE&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-219"><a href="#DatasetProcessorLFM360K-219"><span class="linenos">219</span></a>            <span class="s1">&#39;Wallis and Futuna&#39;</span><span class="p">:</span> <span class="s1">&#39;WF&#39;</span><span class="p">,</span> <span class="s1">&#39;Western Sahara&#39;</span><span class="p">:</span> <span class="s1">&#39;EH&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-220"><a href="#DatasetProcessorLFM360K-220"><span class="linenos">220</span></a>            <span class="s1">&#39;Zambia&#39;</span><span class="p">:</span> <span class="s1">&#39;ZM&#39;</span><span class="p">,</span> <span class="s1">&#39;Zimbabwe&#39;</span><span class="p">:</span> <span class="s1">&#39;ZW&#39;</span>
</span><span id="DatasetProcessorLFM360K-221"><a href="#DatasetProcessorLFM360K-221"><span class="linenos">221</span></a>        <span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-222"><a href="#DatasetProcessorLFM360K-222"><span class="linenos">222</span></a>
</span><span id="DatasetProcessorLFM360K-223"><a href="#DatasetProcessorLFM360K-223"><span class="linenos">223</span></a>        <span class="k">return</span> <span class="n">user_table</span>
</span><span id="DatasetProcessorLFM360K-224"><a href="#DatasetProcessorLFM360K-224"><span class="linenos">224</span></a>
</span><span id="DatasetProcessorLFM360K-225"><a href="#DatasetProcessorLFM360K-225"><span class="linenos">225</span></a>    <span class="k">def</span> <span class="nf">process_artist_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetTableConfig</span><span class="p">]:</span>
</span><span id="DatasetProcessorLFM360K-226"><a href="#DatasetProcessorLFM360K-226"><span class="linenos">226</span></a>        <span class="sd">&quot;&quot;&quot;Process the artist table.</span>
</span><span id="DatasetProcessorLFM360K-227"><a href="#DatasetProcessorLFM360K-227"><span class="linenos">227</span></a>
</span><span id="DatasetProcessorLFM360K-228"><a href="#DatasetProcessorLFM360K-228"><span class="linenos">228</span></a><span class="sd">        Creates the artist table with the musicbrainzID and gender information when available.</span>
</span><span id="DatasetProcessorLFM360K-229"><a href="#DatasetProcessorLFM360K-229"><span class="linenos">229</span></a>
</span><span id="DatasetProcessorLFM360K-230"><a href="#DatasetProcessorLFM360K-230"><span class="linenos">230</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K-231"><a href="#DatasetProcessorLFM360K-231"><span class="linenos">231</span></a><span class="sd">            the artist table configuration or None on failure.</span>
</span><span id="DatasetProcessorLFM360K-232"><a href="#DatasetProcessorLFM360K-232"><span class="linenos">232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K-233"><a href="#DatasetProcessorLFM360K-233"><span class="linenos">233</span></a>        <span class="n">artist_key</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;artist_id&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K-234"><a href="#DatasetProcessorLFM360K-234"><span class="linenos">234</span></a>        <span class="n">artist_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K-235"><a href="#DatasetProcessorLFM360K-235"><span class="linenos">235</span></a>
</span><span id="DatasetProcessorLFM360K-236"><a href="#DatasetProcessorLFM360K-236"><span class="linenos">236</span></a>        <span class="c1"># connect artist id to name</span>
</span><span id="DatasetProcessorLFM360K-237"><a href="#DatasetProcessorLFM360K-237"><span class="linenos">237</span></a>        <span class="n">artist_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K-238"><a href="#DatasetProcessorLFM360K-238"><span class="linenos">238</span></a>            <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">artist_list</span><span class="p">)),</span>
</span><span id="DatasetProcessorLFM360K-239"><a href="#DatasetProcessorLFM360K-239"><span class="linenos">239</span></a>            <span class="n">columns</span><span class="o">=</span><span class="n">artist_key</span> <span class="o">+</span> <span class="n">artist_columns</span>
</span><span id="DatasetProcessorLFM360K-240"><a href="#DatasetProcessorLFM360K-240"><span class="linenos">240</span></a>        <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-241"><a href="#DatasetProcessorLFM360K-241"><span class="linenos">241</span></a>
</span><span id="DatasetProcessorLFM360K-242"><a href="#DatasetProcessorLFM360K-242"><span class="linenos">242</span></a>        <span class="c1"># merge the artist musicbrainzID on name</span>
</span><span id="DatasetProcessorLFM360K-243"><a href="#DatasetProcessorLFM360K-243"><span class="linenos">243</span></a>        <span class="n">artist_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">artist_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;artist_name&#39;</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-244"><a href="#DatasetProcessorLFM360K-244"><span class="linenos">244</span></a>        <span class="n">artist_table</span><span class="p">[</span><span class="s1">&#39;artist_mbID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-245"><a href="#DatasetProcessorLFM360K-245"><span class="linenos">245</span></a>        <span class="n">artist_columns</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;artist_mbID&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K-246"><a href="#DatasetProcessorLFM360K-246"><span class="linenos">246</span></a>
</span><span id="DatasetProcessorLFM360K-247"><a href="#DatasetProcessorLFM360K-247"><span class="linenos">247</span></a>        <span class="n">artist_gender</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_artist_gender_json</span><span class="p">()</span>
</span><span id="DatasetProcessorLFM360K-248"><a href="#DatasetProcessorLFM360K-248"><span class="linenos">248</span></a>        <span class="k">if</span> <span class="n">artist_gender</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K-249"><a href="#DatasetProcessorLFM360K-249"><span class="linenos">249</span></a>            <span class="c1"># merge artists with gender and update columns</span>
</span><span id="DatasetProcessorLFM360K-250"><a href="#DatasetProcessorLFM360K-250"><span class="linenos">250</span></a>            <span class="n">artist_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">artist_table</span><span class="p">,</span> <span class="n">artist_gender</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;artist_mbID&#39;</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-251"><a href="#DatasetProcessorLFM360K-251"><span class="linenos">251</span></a>            <span class="n">artist_columns</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;artist_gender&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K-252"><a href="#DatasetProcessorLFM360K-252"><span class="linenos">252</span></a>
</span><span id="DatasetProcessorLFM360K-253"><a href="#DatasetProcessorLFM360K-253"><span class="linenos">253</span></a>        <span class="c1"># create artist table configuration</span>
</span><span id="DatasetProcessorLFM360K-254"><a href="#DatasetProcessorLFM360K-254"><span class="linenos">254</span></a>        <span class="n">artist_table_config</span> <span class="o">=</span> <span class="n">create_dataset_table_config</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K-255"><a href="#DatasetProcessorLFM360K-255"><span class="linenos">255</span></a>            <span class="n">TABLE_FILE_PREFIX</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s1">&#39;_artists.tsv.bz2&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-256"><a href="#DatasetProcessorLFM360K-256"><span class="linenos">256</span></a>            <span class="n">artist_key</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-257"><a href="#DatasetProcessorLFM360K-257"><span class="linenos">257</span></a>            <span class="n">artist_columns</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-258"><a href="#DatasetProcessorLFM360K-258"><span class="linenos">258</span></a>            <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;bz2&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-259"><a href="#DatasetProcessorLFM360K-259"><span class="linenos">259</span></a>            <span class="n">num_records</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">artist_list</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-260"><a href="#DatasetProcessorLFM360K-260"><span class="linenos">260</span></a>        <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-261"><a href="#DatasetProcessorLFM360K-261"><span class="linenos">261</span></a>
</span><span id="DatasetProcessorLFM360K-262"><a href="#DatasetProcessorLFM360K-262"><span class="linenos">262</span></a>        <span class="c1"># store the generated artist table</span>
</span><span id="DatasetProcessorLFM360K-263"><a href="#DatasetProcessorLFM360K-263"><span class="linenos">263</span></a>        <span class="n">artist_table_config</span><span class="o">.</span><span class="n">save_table</span><span class="p">(</span><span class="n">artist_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-264"><a href="#DatasetProcessorLFM360K-264"><span class="linenos">264</span></a>
</span><span id="DatasetProcessorLFM360K-265"><a href="#DatasetProcessorLFM360K-265"><span class="linenos">265</span></a>        <span class="k">return</span> <span class="n">artist_table_config</span>
</span><span id="DatasetProcessorLFM360K-266"><a href="#DatasetProcessorLFM360K-266"><span class="linenos">266</span></a>
</span><span id="DatasetProcessorLFM360K-267"><a href="#DatasetProcessorLFM360K-267"><span class="linenos">267</span></a>    <span class="k">def</span> <span class="nf">process_user_artist_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetMatrixConfig</span><span class="p">]:</span>
</span><span id="DatasetProcessorLFM360K-268"><a href="#DatasetProcessorLFM360K-268"><span class="linenos">268</span></a>        <span class="sd">&quot;&quot;&quot;Process the user-artist-count matrix.</span>
</span><span id="DatasetProcessorLFM360K-269"><a href="#DatasetProcessorLFM360K-269"><span class="linenos">269</span></a>
</span><span id="DatasetProcessorLFM360K-270"><a href="#DatasetProcessorLFM360K-270"><span class="linenos">270</span></a><span class="sd">        The user-item matrix is stored in a file that also contains a musicbrainzID.</span>
</span><span id="DatasetProcessorLFM360K-271"><a href="#DatasetProcessorLFM360K-271"><span class="linenos">271</span></a><span class="sd">        The users are hashes and the items are names, both are converted to integers</span>
</span><span id="DatasetProcessorLFM360K-272"><a href="#DatasetProcessorLFM360K-272"><span class="linenos">272</span></a><span class="sd">        to comply to the CSR compatible format. In addition, any rows that contain</span>
</span><span id="DatasetProcessorLFM360K-273"><a href="#DatasetProcessorLFM360K-273"><span class="linenos">273</span></a><span class="sd">        corrupt data are removed in the process.</span>
</span><span id="DatasetProcessorLFM360K-274"><a href="#DatasetProcessorLFM360K-274"><span class="linenos">274</span></a>
</span><span id="DatasetProcessorLFM360K-275"><a href="#DatasetProcessorLFM360K-275"><span class="linenos">275</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K-276"><a href="#DatasetProcessorLFM360K-276"><span class="linenos">276</span></a><span class="sd">            the matrix configuration or None on failure.</span>
</span><span id="DatasetProcessorLFM360K-277"><a href="#DatasetProcessorLFM360K-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K-278"><a href="#DatasetProcessorLFM360K-278"><span class="linenos">278</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K-279"><a href="#DatasetProcessorLFM360K-279"><span class="linenos">279</span></a>            <span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K-280"><a href="#DatasetProcessorLFM360K-280"><span class="linenos">280</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="s1">&#39;usersha1-artmbid-artname-plays.tsv&#39;</span><span class="p">),</span>
</span><span id="DatasetProcessorLFM360K-281"><a href="#DatasetProcessorLFM360K-281"><span class="linenos">281</span></a>                <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_mbID&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_name&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_count&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K-282"><a href="#DatasetProcessorLFM360K-282"><span class="linenos">282</span></a>            <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-283"><a href="#DatasetProcessorLFM360K-283"><span class="linenos">283</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K-284"><a href="#DatasetProcessorLFM360K-284"><span class="linenos">284</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="DatasetProcessorLFM360K-285"><a href="#DatasetProcessorLFM360K-285"><span class="linenos">285</span></a>
</span><span id="DatasetProcessorLFM360K-286"><a href="#DatasetProcessorLFM360K-286"><span class="linenos">286</span></a>        <span class="c1"># remove rows from a user that is not a hash</span>
</span><span id="DatasetProcessorLFM360K-287"><a href="#DatasetProcessorLFM360K-287"><span class="linenos">287</span></a>        <span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;sep 20, 2008&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K-288"><a href="#DatasetProcessorLFM360K-288"><span class="linenos">288</span></a>
</span><span id="DatasetProcessorLFM360K-289"><a href="#DatasetProcessorLFM360K-289"><span class="linenos">289</span></a>        <span class="c1"># map users/items to category and ratings to be floating-point</span>
</span><span id="DatasetProcessorLFM360K-290"><a href="#DatasetProcessorLFM360K-290"><span class="linenos">290</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-291"><a href="#DatasetProcessorLFM360K-291"><span class="linenos">291</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-292"><a href="#DatasetProcessorLFM360K-292"><span class="linenos">292</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;matrix_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;matrix_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-293"><a href="#DatasetProcessorLFM360K-293"><span class="linenos">293</span></a>
</span><span id="DatasetProcessorLFM360K-294"><a href="#DatasetProcessorLFM360K-294"><span class="linenos">294</span></a>        <span class="c1"># remove rows that contain items that failed to map to category</span>
</span><span id="DatasetProcessorLFM360K-295"><a href="#DatasetProcessorLFM360K-295"><span class="linenos">295</span></a>        <span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K-296"><a href="#DatasetProcessorLFM360K-296"><span class="linenos">296</span></a>        <span class="c1"># remove rows that have unusable ratings</span>
</span><span id="DatasetProcessorLFM360K-297"><a href="#DatasetProcessorLFM360K-297"><span class="linenos">297</span></a>        <span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;matrix_count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K-298"><a href="#DatasetProcessorLFM360K-298"><span class="linenos">298</span></a>
</span><span id="DatasetProcessorLFM360K-299"><a href="#DatasetProcessorLFM360K-299"><span class="linenos">299</span></a>        <span class="n">dataframe</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_name&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-300"><a href="#DatasetProcessorLFM360K-300"><span class="linenos">300</span></a>
</span><span id="DatasetProcessorLFM360K-301"><a href="#DatasetProcessorLFM360K-301"><span class="linenos">301</span></a>        <span class="c1"># extract user/item indirection arrays</span>
</span><span id="DatasetProcessorLFM360K-302"><a href="#DatasetProcessorLFM360K-302"><span class="linenos">302</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">user_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-303"><a href="#DatasetProcessorLFM360K-303"><span class="linenos">303</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-304"><a href="#DatasetProcessorLFM360K-304"><span class="linenos">304</span></a>
</span><span id="DatasetProcessorLFM360K-305"><a href="#DatasetProcessorLFM360K-305"><span class="linenos">305</span></a>        <span class="c1"># extract artist name/musicbrainzID combinations</span>
</span><span id="DatasetProcessorLFM360K-306"><a href="#DatasetProcessorLFM360K-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_mbID&#39;</span><span class="p">]]</span>
</span><span id="DatasetProcessorLFM360K-307"><a href="#DatasetProcessorLFM360K-307"><span class="linenos">307</span></a>        <span class="c1"># remove duplicates combinations</span>
</span><span id="DatasetProcessorLFM360K-308"><a href="#DatasetProcessorLFM360K-308"><span class="linenos">308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</span><span id="DatasetProcessorLFM360K-309"><a href="#DatasetProcessorLFM360K-309"><span class="linenos">309</span></a>        <span class="c1"># remove duplicates where the artist has more than one musicbrainzID</span>
</span><span id="DatasetProcessorLFM360K-310"><a href="#DatasetProcessorLFM360K-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;artist_name&#39;</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-311"><a href="#DatasetProcessorLFM360K-311"><span class="linenos">311</span></a>
</span><span id="DatasetProcessorLFM360K-312"><a href="#DatasetProcessorLFM360K-312"><span class="linenos">312</span></a>        <span class="c1"># add the correct user/item integers</span>
</span><span id="DatasetProcessorLFM360K-313"><a href="#DatasetProcessorLFM360K-313"><span class="linenos">313</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DatasetProcessorLFM360K-314"><a href="#DatasetProcessorLFM360K-314"><span class="linenos">314</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DatasetProcessorLFM360K-315"><a href="#DatasetProcessorLFM360K-315"><span class="linenos">315</span></a>
</span><span id="DatasetProcessorLFM360K-316"><a href="#DatasetProcessorLFM360K-316"><span class="linenos">316</span></a>        <span class="c1"># create matrix by removing other columns</span>
</span><span id="DatasetProcessorLFM360K-317"><a href="#DatasetProcessorLFM360K-317"><span class="linenos">317</span></a>        <span class="n">user_artist_matrix</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_id&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_count&#39;</span><span class="p">]]</span>
</span><span id="DatasetProcessorLFM360K-318"><a href="#DatasetProcessorLFM360K-318"><span class="linenos">318</span></a>        <span class="n">user_artist_matrix_table_config</span> <span class="o">=</span> <span class="n">create_dataset_table_config</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K-319"><a href="#DatasetProcessorLFM360K-319"><span class="linenos">319</span></a>            <span class="n">TABLE_FILE_PREFIX</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s1">&#39;_user-artist-count_matrix.tsv.bz2&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-320"><a href="#DatasetProcessorLFM360K-320"><span class="linenos">320</span></a>            <span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_id&#39;</span><span class="p">],</span>
</span><span id="DatasetProcessorLFM360K-321"><a href="#DatasetProcessorLFM360K-321"><span class="linenos">321</span></a>            <span class="p">[</span><span class="s1">&#39;matrix_count&#39;</span><span class="p">],</span>
</span><span id="DatasetProcessorLFM360K-322"><a href="#DatasetProcessorLFM360K-322"><span class="linenos">322</span></a>            <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;bz2&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K-323"><a href="#DatasetProcessorLFM360K-323"><span class="linenos">323</span></a>            <span class="n">foreign_keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_id&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K-324"><a href="#DatasetProcessorLFM360K-324"><span class="linenos">324</span></a>        <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-325"><a href="#DatasetProcessorLFM360K-325"><span class="linenos">325</span></a>
</span><span id="DatasetProcessorLFM360K-326"><a href="#DatasetProcessorLFM360K-326"><span class="linenos">326</span></a>        <span class="c1"># store the resulting matrix</span>
</span><span id="DatasetProcessorLFM360K-327"><a href="#DatasetProcessorLFM360K-327"><span class="linenos">327</span></a>        <span class="n">user_artist_matrix_table_config</span><span class="o">.</span><span class="n">save_table</span><span class="p">(</span><span class="n">user_artist_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-328"><a href="#DatasetProcessorLFM360K-328"><span class="linenos">328</span></a>
</span><span id="DatasetProcessorLFM360K-329"><a href="#DatasetProcessorLFM360K-329"><span class="linenos">329</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_matrix</span><span class="p">(</span><span class="n">user_artist_matrix_table_config</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-330"><a href="#DatasetProcessorLFM360K-330"><span class="linenos">330</span></a>
</span><span id="DatasetProcessorLFM360K-331"><a href="#DatasetProcessorLFM360K-331"><span class="linenos">331</span></a>    <span class="k">def</span> <span class="nf">process_user_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetTableConfig</span><span class="p">]:</span>
</span><span id="DatasetProcessorLFM360K-332"><a href="#DatasetProcessorLFM360K-332"><span class="linenos">332</span></a>        <span class="sd">&quot;&quot;&quot;Process the user table.</span>
</span><span id="DatasetProcessorLFM360K-333"><a href="#DatasetProcessorLFM360K-333"><span class="linenos">333</span></a>
</span><span id="DatasetProcessorLFM360K-334"><a href="#DatasetProcessorLFM360K-334"><span class="linenos">334</span></a><span class="sd">        Extends the original user table with unique user ids.</span>
</span><span id="DatasetProcessorLFM360K-335"><a href="#DatasetProcessorLFM360K-335"><span class="linenos">335</span></a>
</span><span id="DatasetProcessorLFM360K-336"><a href="#DatasetProcessorLFM360K-336"><span class="linenos">336</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K-337"><a href="#DatasetProcessorLFM360K-337"><span class="linenos">337</span></a><span class="sd">            the user table configuration or None on failure.</span>
</span><span id="DatasetProcessorLFM360K-338"><a href="#DatasetProcessorLFM360K-338"><span class="linenos">338</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K-339"><a href="#DatasetProcessorLFM360K-339"><span class="linenos">339</span></a>        <span class="n">user_table_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_user_table_config</span><span class="p">()</span>
</span><span id="DatasetProcessorLFM360K-340"><a href="#DatasetProcessorLFM360K-340"><span class="linenos">340</span></a>        <span class="c1"># connect user id to sha</span>
</span><span id="DatasetProcessorLFM360K-341"><a href="#DatasetProcessorLFM360K-341"><span class="linenos">341</span></a>        <span class="n">user_sha_ids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K-342"><a href="#DatasetProcessorLFM360K-342"><span class="linenos">342</span></a>            <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_list</span><span class="p">)),</span>
</span><span id="DatasetProcessorLFM360K-343"><a href="#DatasetProcessorLFM360K-343"><span class="linenos">343</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;user_sha&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K-344"><a href="#DatasetProcessorLFM360K-344"><span class="linenos">344</span></a>        <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-345"><a href="#DatasetProcessorLFM360K-345"><span class="linenos">345</span></a>
</span><span id="DatasetProcessorLFM360K-346"><a href="#DatasetProcessorLFM360K-346"><span class="linenos">346</span></a>        <span class="c1"># load original user table and when available, add it to user id/sha</span>
</span><span id="DatasetProcessorLFM360K-347"><a href="#DatasetProcessorLFM360K-347"><span class="linenos">347</span></a>        <span class="n">user_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_user_table</span><span class="p">()</span>
</span><span id="DatasetProcessorLFM360K-348"><a href="#DatasetProcessorLFM360K-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="n">user_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K-349"><a href="#DatasetProcessorLFM360K-349"><span class="linenos">349</span></a>            <span class="n">user_table</span> <span class="o">=</span> <span class="n">user_sha_ids</span>
</span><span id="DatasetProcessorLFM360K-350"><a href="#DatasetProcessorLFM360K-350"><span class="linenos">350</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K-351"><a href="#DatasetProcessorLFM360K-351"><span class="linenos">351</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">user_table</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
</span><span id="DatasetProcessorLFM360K-352"><a href="#DatasetProcessorLFM360K-352"><span class="linenos">352</span></a>                <span class="n">user_table_config</span><span class="o">.</span><span class="n">columns</span> <span class="o">+=</span> <span class="p">[</span><span class="n">user_table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</span><span id="DatasetProcessorLFM360K-353"><a href="#DatasetProcessorLFM360K-353"><span class="linenos">353</span></a>
</span><span id="DatasetProcessorLFM360K-354"><a href="#DatasetProcessorLFM360K-354"><span class="linenos">354</span></a>            <span class="c1"># join user table with user ids</span>
</span><span id="DatasetProcessorLFM360K-355"><a href="#DatasetProcessorLFM360K-355"><span class="linenos">355</span></a>            <span class="n">user_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">user_sha_ids</span><span class="p">,</span> <span class="n">user_table</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;user_sha&#39;</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-356"><a href="#DatasetProcessorLFM360K-356"><span class="linenos">356</span></a>
</span><span id="DatasetProcessorLFM360K-357"><a href="#DatasetProcessorLFM360K-357"><span class="linenos">357</span></a>            <span class="c1"># fill unknown user age with -1 and cast back to int</span>
</span><span id="DatasetProcessorLFM360K-358"><a href="#DatasetProcessorLFM360K-358"><span class="linenos">358</span></a>            <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-359"><a href="#DatasetProcessorLFM360K-359"><span class="linenos">359</span></a>            <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-360"><a href="#DatasetProcessorLFM360K-360"><span class="linenos">360</span></a>
</span><span id="DatasetProcessorLFM360K-361"><a href="#DatasetProcessorLFM360K-361"><span class="linenos">361</span></a>        <span class="c1"># store the generated user table</span>
</span><span id="DatasetProcessorLFM360K-362"><a href="#DatasetProcessorLFM360K-362"><span class="linenos">362</span></a>        <span class="n">user_table_config</span><span class="o">.</span><span class="n">save_table</span><span class="p">(</span><span class="n">user_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K-363"><a href="#DatasetProcessorLFM360K-363"><span class="linenos">363</span></a>
</span><span id="DatasetProcessorLFM360K-364"><a href="#DatasetProcessorLFM360K-364"><span class="linenos">364</span></a>        <span class="k">return</span> <span class="n">user_table_config</span>
</span></pre></div>


            <div class="docstring"><p>DatasetProcessor for the LastFM-360K dataset.</p>

<p>The dataset can be downloaded from the website below.
https://www.upf.edu/web/mtg/lastfm360k</p>

<p>The enriched artist gender information can be retrieved from:
https://zenodo.org/record/3748787#.YowEBqhByUk</p>

<p>The processor handles the following files:</p>

<p>usersha1-artmbid-artname-plays.tsv (required)
usersha1-profile.tsv (optional)
lfm-360-gender.json (optional)</p>
</div>


                            <div id="DatasetProcessorLFM360K.__init__" class="classattr">
                                        <input id="DatasetProcessorLFM360K.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DatasetProcessorLFM360K</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dataset_dir</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">dataset_name</span><span class="p">:</span> <span class="nb">str</span></span>)</span>

                <label class="view-source-button" for="DatasetProcessorLFM360K.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatasetProcessorLFM360K.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatasetProcessorLFM360K.__init__-39"><a href="#DatasetProcessorLFM360K.__init__-39"><span class="linenos">39</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="DatasetProcessorLFM360K.__init__-40"><a href="#DatasetProcessorLFM360K.__init__-40"><span class="linenos">40</span></a>        <span class="sd">&quot;&quot;&quot;Construct the DatasetProcessorLFM360K.</span>
</span><span id="DatasetProcessorLFM360K.__init__-41"><a href="#DatasetProcessorLFM360K.__init__-41"><span class="linenos">41</span></a>
</span><span id="DatasetProcessorLFM360K.__init__-42"><a href="#DatasetProcessorLFM360K.__init__-42"><span class="linenos">42</span></a><span class="sd">        Args:</span>
</span><span id="DatasetProcessorLFM360K.__init__-43"><a href="#DatasetProcessorLFM360K.__init__-43"><span class="linenos">43</span></a><span class="sd">            dataset_name: path of the dataset directory.</span>
</span><span id="DatasetProcessorLFM360K.__init__-44"><a href="#DatasetProcessorLFM360K.__init__-44"><span class="linenos">44</span></a><span class="sd">            dataset_name: name of the dataset (processor).</span>
</span><span id="DatasetProcessorLFM360K.__init__-45"><a href="#DatasetProcessorLFM360K.__init__-45"><span class="linenos">45</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K.__init__-46"><a href="#DatasetProcessorLFM360K.__init__-46"><span class="linenos">46</span></a>        <span class="n">DatasetProcessorLFM</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.__init__-47"><a href="#DatasetProcessorLFM360K.__init__-47"><span class="linenos">47</span></a>        <span class="c1"># buffer for the user sha and artist name lists</span>
</span><span id="DatasetProcessorLFM360K.__init__-48"><a href="#DatasetProcessorLFM360K.__init__-48"><span class="linenos">48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">user_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DatasetProcessorLFM360K.__init__-49"><a href="#DatasetProcessorLFM360K.__init__-49"><span class="linenos">49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DatasetProcessorLFM360K.__init__-50"><a href="#DatasetProcessorLFM360K.__init__-50"><span class="linenos">50</span></a>        <span class="c1"># buffer for the artist name/musicbrainzID dataframe</span>
</span><span id="DatasetProcessorLFM360K.__init__-51"><a href="#DatasetProcessorLFM360K.__init__-51"><span class="linenos">51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Construct the DatasetProcessorLFM360K.</p>

<p>Args:
    dataset_name: path of the dataset directory.
    dataset_name: name of the dataset (processor).</p>
</div>


                            </div>
                            <div id="DatasetProcessorLFM360K.create_listening_events_config" class="classattr">
                                        <input id="DatasetProcessorLFM360K.create_listening_events_config-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_listening_events_config</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="n">src</span><span class="o">.</span><span class="n">fairreckitlib</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">DatasetTableConfig</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DatasetProcessorLFM360K.create_listening_events_config-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatasetProcessorLFM360K.create_listening_events_config"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatasetProcessorLFM360K.create_listening_events_config-53"><a href="#DatasetProcessorLFM360K.create_listening_events_config-53"><span class="linenos">53</span></a>    <span class="k">def</span> <span class="nf">create_listening_events_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetTableConfig</span><span class="p">]:</span>
</span><span id="DatasetProcessorLFM360K.create_listening_events_config-54"><a href="#DatasetProcessorLFM360K.create_listening_events_config-54"><span class="linenos">54</span></a>        <span class="sd">&quot;&quot;&quot;Create the listening event table configuration.</span>
</span><span id="DatasetProcessorLFM360K.create_listening_events_config-55"><a href="#DatasetProcessorLFM360K.create_listening_events_config-55"><span class="linenos">55</span></a>
</span><span id="DatasetProcessorLFM360K.create_listening_events_config-56"><a href="#DatasetProcessorLFM360K.create_listening_events_config-56"><span class="linenos">56</span></a><span class="sd">        No listening events are available for this dataset.</span>
</span><span id="DatasetProcessorLFM360K.create_listening_events_config-57"><a href="#DatasetProcessorLFM360K.create_listening_events_config-57"><span class="linenos">57</span></a>
</span><span id="DatasetProcessorLFM360K.create_listening_events_config-58"><a href="#DatasetProcessorLFM360K.create_listening_events_config-58"><span class="linenos">58</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K.create_listening_events_config-59"><a href="#DatasetProcessorLFM360K.create_listening_events_config-59"><span class="linenos">59</span></a><span class="sd">            None.</span>
</span><span id="DatasetProcessorLFM360K.create_listening_events_config-60"><a href="#DatasetProcessorLFM360K.create_listening_events_config-60"><span class="linenos">60</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K.create_listening_events_config-61"><a href="#DatasetProcessorLFM360K.create_listening_events_config-61"><span class="linenos">61</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Create the listening event table configuration.</p>

<p>No listening events are available for this dataset.</p>

<p>Returns:
    None.</p>
</div>


                            </div>
                            <div id="DatasetProcessorLFM360K.create_user_table_config" class="classattr">
                                        <input id="DatasetProcessorLFM360K.create_user_table_config-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_user_table_config</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">src</span><span class="o">.</span><span class="n">fairreckitlib</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">DatasetTableConfig</span>:</span></span>

                <label class="view-source-button" for="DatasetProcessorLFM360K.create_user_table_config-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatasetProcessorLFM360K.create_user_table_config"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatasetProcessorLFM360K.create_user_table_config-63"><a href="#DatasetProcessorLFM360K.create_user_table_config-63"><span class="linenos">63</span></a>    <span class="k">def</span> <span class="nf">create_user_table_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetTableConfig</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-64"><a href="#DatasetProcessorLFM360K.create_user_table_config-64"><span class="linenos">64</span></a>        <span class="sd">&quot;&quot;&quot;Create the user table configuration.</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-65"><a href="#DatasetProcessorLFM360K.create_user_table_config-65"><span class="linenos">65</span></a>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-66"><a href="#DatasetProcessorLFM360K.create_user_table_config-66"><span class="linenos">66</span></a><span class="sd">        The base user configuration that contains the generated user ids</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-67"><a href="#DatasetProcessorLFM360K.create_user_table_config-67"><span class="linenos">67</span></a><span class="sd">        and corresponding user sha.</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-68"><a href="#DatasetProcessorLFM360K.create_user_table_config-68"><span class="linenos">68</span></a>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-69"><a href="#DatasetProcessorLFM360K.create_user_table_config-69"><span class="linenos">69</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-70"><a href="#DatasetProcessorLFM360K.create_user_table_config-70"><span class="linenos">70</span></a><span class="sd">            the configuration of the user table.</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-71"><a href="#DatasetProcessorLFM360K.create_user_table_config-71"><span class="linenos">71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-72"><a href="#DatasetProcessorLFM360K.create_user_table_config-72"><span class="linenos">72</span></a>        <span class="k">return</span> <span class="n">create_dataset_table_config</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-73"><a href="#DatasetProcessorLFM360K.create_user_table_config-73"><span class="linenos">73</span></a>            <span class="n">TABLE_FILE_PREFIX</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s1">&#39;_users.tsv.bz2&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-74"><a href="#DatasetProcessorLFM360K.create_user_table_config-74"><span class="linenos">74</span></a>            <span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">],</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-75"><a href="#DatasetProcessorLFM360K.create_user_table_config-75"><span class="linenos">75</span></a>            <span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">],</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-76"><a href="#DatasetProcessorLFM360K.create_user_table_config-76"><span class="linenos">76</span></a>            <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;bz2&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-77"><a href="#DatasetProcessorLFM360K.create_user_table_config-77"><span class="linenos">77</span></a>            <span class="n">num_records</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_list</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.create_user_table_config-78"><a href="#DatasetProcessorLFM360K.create_user_table_config-78"><span class="linenos">78</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create the user table configuration.</p>

<p>The base user configuration that contains the generated user ids
and corresponding user sha.</p>

<p>Returns:
    the configuration of the user table.</p>
</div>


                            </div>
                            <div id="DatasetProcessorLFM360K.get_matrix_configs" class="classattr">
                                        <input id="DatasetProcessorLFM360K.get_matrix_configs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_matrix_configs</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">src</span><span class="o">.</span><span class="n">fairreckitlib</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">DatasetMatrixConfig</span><span class="p">]]]]</span>:</span></span>

                <label class="view-source-button" for="DatasetProcessorLFM360K.get_matrix_configs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatasetProcessorLFM360K.get_matrix_configs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatasetProcessorLFM360K.get_matrix_configs-80"><a href="#DatasetProcessorLFM360K.get_matrix_configs-80"><span class="linenos">80</span></a>    <span class="k">def</span> <span class="nf">get_matrix_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetMatrixConfig</span><span class="p">]]]]:</span>
</span><span id="DatasetProcessorLFM360K.get_matrix_configs-81"><a href="#DatasetProcessorLFM360K.get_matrix_configs-81"><span class="linenos">81</span></a>        <span class="sd">&quot;&quot;&quot;Get matrix configuration processors.</span>
</span><span id="DatasetProcessorLFM360K.get_matrix_configs-82"><a href="#DatasetProcessorLFM360K.get_matrix_configs-82"><span class="linenos">82</span></a>
</span><span id="DatasetProcessorLFM360K.get_matrix_configs-83"><a href="#DatasetProcessorLFM360K.get_matrix_configs-83"><span class="linenos">83</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K.get_matrix_configs-84"><a href="#DatasetProcessorLFM360K.get_matrix_configs-84"><span class="linenos">84</span></a><span class="sd">            a list containing the user-artist-count matrix processor.</span>
</span><span id="DatasetProcessorLFM360K.get_matrix_configs-85"><a href="#DatasetProcessorLFM360K.get_matrix_configs-85"><span class="linenos">85</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K.get_matrix_configs-86"><a href="#DatasetProcessorLFM360K.get_matrix_configs-86"><span class="linenos">86</span></a>        <span class="k">return</span> <span class="p">[(</span><span class="s1">&#39;user-artist-count&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_user_artist_matrix</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Get matrix configuration processors.</p>

<p>Returns:
    a list containing the user-artist-count matrix processor.</p>
</div>


                            </div>
                            <div id="DatasetProcessorLFM360K.get_table_configs" class="classattr">
                                        <input id="DatasetProcessorLFM360K.get_table_configs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_table_configs</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">src</span><span class="o">.</span><span class="n">fairreckitlib</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">DatasetTableConfig</span><span class="p">]]]]</span>:</span></span>

                <label class="view-source-button" for="DatasetProcessorLFM360K.get_table_configs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatasetProcessorLFM360K.get_table_configs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatasetProcessorLFM360K.get_table_configs-88"><a href="#DatasetProcessorLFM360K.get_table_configs-88"><span class="linenos">88</span></a>    <span class="k">def</span> <span class="nf">get_table_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetTableConfig</span><span class="p">]]]]:</span>
</span><span id="DatasetProcessorLFM360K.get_table_configs-89"><a href="#DatasetProcessorLFM360K.get_table_configs-89"><span class="linenos">89</span></a>        <span class="sd">&quot;&quot;&quot;Get table configuration processors.</span>
</span><span id="DatasetProcessorLFM360K.get_table_configs-90"><a href="#DatasetProcessorLFM360K.get_table_configs-90"><span class="linenos">90</span></a>
</span><span id="DatasetProcessorLFM360K.get_table_configs-91"><a href="#DatasetProcessorLFM360K.get_table_configs-91"><span class="linenos">91</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K.get_table_configs-92"><a href="#DatasetProcessorLFM360K.get_table_configs-92"><span class="linenos">92</span></a><span class="sd">            a list containing the artist and user table processors.</span>
</span><span id="DatasetProcessorLFM360K.get_table_configs-93"><a href="#DatasetProcessorLFM360K.get_table_configs-93"><span class="linenos">93</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K.get_table_configs-94"><a href="#DatasetProcessorLFM360K.get_table_configs-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="n">DatasetProcessorLFM</span><span class="o">.</span><span class="n">get_table_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="p">[(</span><span class="s1">&#39;artist&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">process_artist_table</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Get table configuration processors.</p>

<p>Returns:
    a list containing the artist and user table processors.</p>
</div>


                            </div>
                            <div id="DatasetProcessorLFM360K.load_artist_gender_json" class="classattr">
                                        <input id="DatasetProcessorLFM360K.load_artist_gender_json-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_artist_gender_json</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DatasetProcessorLFM360K.load_artist_gender_json-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatasetProcessorLFM360K.load_artist_gender_json"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatasetProcessorLFM360K.load_artist_gender_json-96"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">load_artist_gender_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-97"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-97"><span class="linenos"> 97</span></a>        <span class="sd">&quot;&quot;&quot;Load the artist gender json file.</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-98"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-98"><span class="linenos"> 98</span></a>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-99"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-99"><span class="linenos"> 99</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-100"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-100"><span class="linenos">100</span></a><span class="sd">            the loaded artist musicbrainzID/gender table or None on failure.</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-101"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-101"><span class="linenos">101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-102"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-102"><span class="linenos">102</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-103"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-103"><span class="linenos">103</span></a>            <span class="n">gender_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-104"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-104"><span class="linenos">104</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="s1">&#39;lfm-360-gender.json&#39;</span><span class="p">),</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-105"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-105"><span class="linenos">105</span></a>                <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-106"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-106"><span class="linenos">106</span></a>            <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-107"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-107"><span class="linenos">107</span></a>            <span class="n">gender_table</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-108"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-108"><span class="linenos">108</span></a>            <span class="n">gender_table</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;artist_mbID&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;artist_gender&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-109"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-109"><span class="linenos">109</span></a>            <span class="k">return</span> <span class="n">gender_table</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-110"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-110"><span class="linenos">110</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K.load_artist_gender_json-111"><a href="#DatasetProcessorLFM360K.load_artist_gender_json-111"><span class="linenos">111</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Load the artist gender json file.</p>

<p>Returns:
    the loaded artist musicbrainzID/gender table or None on failure.</p>
</div>


                            </div>
                            <div id="DatasetProcessorLFM360K.load_user_table" class="classattr">
                                        <input id="DatasetProcessorLFM360K.load_user_table-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_user_table</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DatasetProcessorLFM360K.load_user_table-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatasetProcessorLFM360K.load_user_table"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatasetProcessorLFM360K.load_user_table-113"><a href="#DatasetProcessorLFM360K.load_user_table-113"><span class="linenos">113</span></a>    <span class="k">def</span> <span class="nf">load_user_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-114"><a href="#DatasetProcessorLFM360K.load_user_table-114"><span class="linenos">114</span></a>        <span class="sd">&quot;&quot;&quot;Load the original user table.</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-115"><a href="#DatasetProcessorLFM360K.load_user_table-115"><span class="linenos">115</span></a>
</span><span id="DatasetProcessorLFM360K.load_user_table-116"><a href="#DatasetProcessorLFM360K.load_user_table-116"><span class="linenos">116</span></a><span class="sd">        Changes the contents of the age and gender columns to be more user-friendly,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-117"><a href="#DatasetProcessorLFM360K.load_user_table-117"><span class="linenos">117</span></a><span class="sd">        and the contents of the country column to ISO 3166 Alpha-2 country codes.</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-118"><a href="#DatasetProcessorLFM360K.load_user_table-118"><span class="linenos">118</span></a>
</span><span id="DatasetProcessorLFM360K.load_user_table-119"><a href="#DatasetProcessorLFM360K.load_user_table-119"><span class="linenos">119</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-120"><a href="#DatasetProcessorLFM360K.load_user_table-120"><span class="linenos">120</span></a><span class="sd">            the loaded user table on None on failure.</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-121"><a href="#DatasetProcessorLFM360K.load_user_table-121"><span class="linenos">121</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-122"><a href="#DatasetProcessorLFM360K.load_user_table-122"><span class="linenos">122</span></a>        <span class="n">user_table_columns</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-123"><a href="#DatasetProcessorLFM360K.load_user_table-123"><span class="linenos">123</span></a>            <span class="s1">&#39;user_sha&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-124"><a href="#DatasetProcessorLFM360K.load_user_table-124"><span class="linenos">124</span></a>            <span class="s1">&#39;user_gender&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-125"><a href="#DatasetProcessorLFM360K.load_user_table-125"><span class="linenos">125</span></a>            <span class="s1">&#39;user_age&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-126"><a href="#DatasetProcessorLFM360K.load_user_table-126"><span class="linenos">126</span></a>            <span class="s1">&#39;user_country&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-127"><a href="#DatasetProcessorLFM360K.load_user_table-127"><span class="linenos">127</span></a>            <span class="s1">&#39;user_signup&#39;</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-128"><a href="#DatasetProcessorLFM360K.load_user_table-128"><span class="linenos">128</span></a>        <span class="p">]</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-129"><a href="#DatasetProcessorLFM360K.load_user_table-129"><span class="linenos">129</span></a>
</span><span id="DatasetProcessorLFM360K.load_user_table-130"><a href="#DatasetProcessorLFM360K.load_user_table-130"><span class="linenos">130</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-131"><a href="#DatasetProcessorLFM360K.load_user_table-131"><span class="linenos">131</span></a>            <span class="c1"># load original user table</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-132"><a href="#DatasetProcessorLFM360K.load_user_table-132"><span class="linenos">132</span></a>            <span class="n">user_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-133"><a href="#DatasetProcessorLFM360K.load_user_table-133"><span class="linenos">133</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="s1">&#39;usersha1-profile.tsv&#39;</span><span class="p">),</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-134"><a href="#DatasetProcessorLFM360K.load_user_table-134"><span class="linenos">134</span></a>                <span class="n">names</span><span class="o">=</span><span class="n">user_table_columns</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-135"><a href="#DatasetProcessorLFM360K.load_user_table-135"><span class="linenos">135</span></a>                <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-136"><a href="#DatasetProcessorLFM360K.load_user_table-136"><span class="linenos">136</span></a>            <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-137"><a href="#DatasetProcessorLFM360K.load_user_table-137"><span class="linenos">137</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-138"><a href="#DatasetProcessorLFM360K.load_user_table-138"><span class="linenos">138</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-139"><a href="#DatasetProcessorLFM360K.load_user_table-139"><span class="linenos">139</span></a>
</span><span id="DatasetProcessorLFM360K.load_user_table-140"><a href="#DatasetProcessorLFM360K.load_user_table-140"><span class="linenos">140</span></a>        <span class="c1"># mask user age not between 1-100 as NaN</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-141"><a href="#DatasetProcessorLFM360K.load_user_table-141"><span class="linenos">141</span></a>        <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-142"><a href="#DatasetProcessorLFM360K.load_user_table-142"><span class="linenos">142</span></a>        <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-143"><a href="#DatasetProcessorLFM360K.load_user_table-143"><span class="linenos">143</span></a>
</span><span id="DatasetProcessorLFM360K.load_user_table-144"><a href="#DatasetProcessorLFM360K.load_user_table-144"><span class="linenos">144</span></a>        <span class="c1"># convert gender to more user-friendly names</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-145"><a href="#DatasetProcessorLFM360K.load_user_table-145"><span class="linenos">145</span></a>        <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="s1">&#39;Female&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-146"><a href="#DatasetProcessorLFM360K.load_user_table-146"><span class="linenos">146</span></a>
</span><span id="DatasetProcessorLFM360K.load_user_table-147"><a href="#DatasetProcessorLFM360K.load_user_table-147"><span class="linenos">147</span></a>        <span class="c1"># convert country to ISO 3166 Alpha-2 country code</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-148"><a href="#DatasetProcessorLFM360K.load_user_table-148"><span class="linenos">148</span></a>        <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-149"><a href="#DatasetProcessorLFM360K.load_user_table-149"><span class="linenos">149</span></a>            <span class="s1">&#39;Afghanistan&#39;</span><span class="p">:</span> <span class="s1">&#39;AF&#39;</span><span class="p">,</span> <span class="s1">&#39;Albania&#39;</span><span class="p">:</span> <span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;Algeria&#39;</span><span class="p">:</span> <span class="s1">&#39;DZ&#39;</span><span class="p">,</span> <span class="s1">&#39;American Samoa&#39;</span><span class="p">:</span> <span class="s1">&#39;AS&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-150"><a href="#DatasetProcessorLFM360K.load_user_table-150"><span class="linenos">150</span></a>            <span class="s1">&#39;Andorra&#39;</span><span class="p">:</span> <span class="s1">&#39;AD&#39;</span><span class="p">,</span> <span class="s1">&#39;Angola&#39;</span><span class="p">:</span> <span class="s1">&#39;AO&#39;</span><span class="p">,</span> <span class="s1">&#39;Anguilla&#39;</span><span class="p">:</span> <span class="s1">&#39;AI&#39;</span><span class="p">,</span> <span class="s1">&#39;Antarctica&#39;</span><span class="p">:</span> <span class="s1">&#39;AQ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-151"><a href="#DatasetProcessorLFM360K.load_user_table-151"><span class="linenos">151</span></a>            <span class="s1">&#39;Antigua and Barbuda&#39;</span><span class="p">:</span> <span class="s1">&#39;AG&#39;</span><span class="p">,</span> <span class="s1">&#39;Argentina&#39;</span><span class="p">:</span> <span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;Armenia&#39;</span><span class="p">:</span> <span class="s1">&#39;AM&#39;</span><span class="p">,</span> <span class="s1">&#39;Aruba&#39;</span><span class="p">:</span> <span class="s1">&#39;AW&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-152"><a href="#DatasetProcessorLFM360K.load_user_table-152"><span class="linenos">152</span></a>            <span class="s1">&#39;Australia&#39;</span><span class="p">:</span> <span class="s1">&#39;AU&#39;</span><span class="p">,</span> <span class="s1">&#39;Austria&#39;</span><span class="p">:</span> <span class="s1">&#39;AT&#39;</span><span class="p">,</span> <span class="s1">&#39;Azerbaijan&#39;</span><span class="p">:</span> <span class="s1">&#39;AZ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-153"><a href="#DatasetProcessorLFM360K.load_user_table-153"><span class="linenos">153</span></a>            <span class="s1">&#39;Bahamas&#39;</span><span class="p">:</span> <span class="s1">&#39;BS&#39;</span><span class="p">,</span> <span class="s1">&#39;Bahrain&#39;</span><span class="p">:</span> <span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="s1">&#39;Bangladesh&#39;</span><span class="p">:</span> <span class="s1">&#39;BD&#39;</span><span class="p">,</span> <span class="s1">&#39;Barbados&#39;</span><span class="p">:</span> <span class="s1">&#39;BB&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-154"><a href="#DatasetProcessorLFM360K.load_user_table-154"><span class="linenos">154</span></a>            <span class="s1">&#39;Belarus&#39;</span><span class="p">:</span> <span class="s1">&#39;BY&#39;</span><span class="p">,</span> <span class="s1">&#39;Belgium&#39;</span><span class="p">:</span> <span class="s1">&#39;BE&#39;</span><span class="p">,</span> <span class="s1">&#39;Belize&#39;</span><span class="p">:</span> <span class="s1">&#39;BZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Benin&#39;</span><span class="p">:</span> <span class="s1">&#39;BJ&#39;</span><span class="p">,</span> <span class="s1">&#39;Bermuda&#39;</span><span class="p">:</span> <span class="s1">&#39;BM&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-155"><a href="#DatasetProcessorLFM360K.load_user_table-155"><span class="linenos">155</span></a>            <span class="s1">&#39;Bhutan&#39;</span><span class="p">:</span> <span class="s1">&#39;BT&#39;</span><span class="p">,</span> <span class="s1">&#39;Bolivia&#39;</span><span class="p">:</span> <span class="s1">&#39;BO&#39;</span><span class="p">,</span> <span class="s1">&#39;Bosnia and Herzegovina&#39;</span><span class="p">:</span> <span class="s1">&#39;BA&#39;</span><span class="p">,</span> <span class="s1">&#39;Botswana&#39;</span><span class="p">:</span> <span class="s1">&#39;BW&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-156"><a href="#DatasetProcessorLFM360K.load_user_table-156"><span class="linenos">156</span></a>            <span class="s1">&#39;Bouvet Island&#39;</span><span class="p">:</span> <span class="s1">&#39;BV&#39;</span><span class="p">,</span> <span class="s1">&#39;Brazil&#39;</span><span class="p">:</span> <span class="s1">&#39;BR&#39;</span><span class="p">,</span> <span class="s1">&#39;British Indian Ocean Territory&#39;</span><span class="p">:</span> <span class="s1">&#39;IO&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-157"><a href="#DatasetProcessorLFM360K.load_user_table-157"><span class="linenos">157</span></a>            <span class="s1">&#39;Brunei Darussalam&#39;</span><span class="p">:</span> <span class="s1">&#39;BN&#39;</span><span class="p">,</span> <span class="s1">&#39;Bulgaria&#39;</span><span class="p">:</span> <span class="s1">&#39;BG&#39;</span><span class="p">,</span> <span class="s1">&#39;Burkina Faso&#39;</span><span class="p">:</span> <span class="s1">&#39;BF&#39;</span><span class="p">,</span> <span class="s1">&#39;Burundi&#39;</span><span class="p">:</span> <span class="s1">&#39;BI&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-158"><a href="#DatasetProcessorLFM360K.load_user_table-158"><span class="linenos">158</span></a>            <span class="s1">&#39;Cambodia&#39;</span><span class="p">:</span> <span class="s1">&#39;KH&#39;</span><span class="p">,</span> <span class="s1">&#39;Cameroon&#39;</span><span class="p">:</span> <span class="s1">&#39;CM&#39;</span><span class="p">,</span> <span class="s1">&#39;Canada&#39;</span><span class="p">:</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39;Cape Verde&#39;</span><span class="p">:</span> <span class="s1">&#39;CV&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-159"><a href="#DatasetProcessorLFM360K.load_user_table-159"><span class="linenos">159</span></a>            <span class="s1">&#39;Cayman Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;KY&#39;</span><span class="p">,</span> <span class="s1">&#39;Central African Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;CF&#39;</span><span class="p">,</span> <span class="s1">&#39;Chad&#39;</span><span class="p">:</span> <span class="s1">&#39;TD&#39;</span><span class="p">,</span> <span class="s1">&#39;Chile&#39;</span><span class="p">:</span> <span class="s1">&#39;CL&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-160"><a href="#DatasetProcessorLFM360K.load_user_table-160"><span class="linenos">160</span></a>            <span class="s1">&#39;China&#39;</span><span class="p">:</span> <span class="s1">&#39;CN&#39;</span><span class="p">,</span> <span class="s1">&#39;Christmas Island&#39;</span><span class="p">:</span> <span class="s1">&#39;CX&#39;</span><span class="p">,</span> <span class="s1">&#39;Cocos (Keeling) Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;CC&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-161"><a href="#DatasetProcessorLFM360K.load_user_table-161"><span class="linenos">161</span></a>            <span class="s1">&#39;Colombia&#39;</span><span class="p">:</span> <span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;Comoros&#39;</span><span class="p">:</span> <span class="s1">&#39;KM&#39;</span><span class="p">,</span> <span class="s1">&#39;Congo&#39;</span><span class="p">:</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="s1">&#39;Czech Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;CZ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-162"><a href="#DatasetProcessorLFM360K.load_user_table-162"><span class="linenos">162</span></a>            <span class="s1">&#39;Congo, the Democratic Republic of the&#39;</span><span class="p">:</span> <span class="s1">&#39;CD&#39;</span><span class="p">,</span> <span class="s1">&#39;Cook Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;CK&#39;</span><span class="p">,</span> <span class="s1">&#39;Cyprus&#39;</span><span class="p">:</span> <span class="s1">&#39;CY&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-163"><a href="#DatasetProcessorLFM360K.load_user_table-163"><span class="linenos">163</span></a>            <span class="s1">&#39;Costa Rica&#39;</span><span class="p">:</span> <span class="s1">&#39;CR&#39;</span><span class="p">,</span> <span class="s1">&#39;Cote D</span><span class="se">\&#39;</span><span class="s1">Ivoire&#39;</span><span class="p">:</span> <span class="s1">&#39;CI&#39;</span><span class="p">,</span> <span class="s1">&#39;Croatia&#39;</span><span class="p">:</span> <span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Cuba&#39;</span><span class="p">:</span> <span class="s1">&#39;CU&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-164"><a href="#DatasetProcessorLFM360K.load_user_table-164"><span class="linenos">164</span></a>            <span class="s1">&#39;Denmark&#39;</span><span class="p">:</span> <span class="s1">&#39;DK&#39;</span><span class="p">,</span> <span class="s1">&#39;Djibouti&#39;</span><span class="p">:</span> <span class="s1">&#39;DJ&#39;</span><span class="p">,</span> <span class="s1">&#39;Dominica&#39;</span><span class="p">:</span> <span class="s1">&#39;DM&#39;</span><span class="p">,</span> <span class="s1">&#39;Dominican Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;DO&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-165"><a href="#DatasetProcessorLFM360K.load_user_table-165"><span class="linenos">165</span></a>            <span class="s1">&#39;Ecuador&#39;</span><span class="p">:</span> <span class="s1">&#39;EC&#39;</span><span class="p">,</span> <span class="s1">&#39;Egypt&#39;</span><span class="p">:</span> <span class="s1">&#39;EG&#39;</span><span class="p">,</span> <span class="s1">&#39;El Salvador&#39;</span><span class="p">:</span> <span class="s1">&#39;SV&#39;</span><span class="p">,</span> <span class="s1">&#39;Equatorial Guinea&#39;</span><span class="p">:</span> <span class="s1">&#39;GQ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-166"><a href="#DatasetProcessorLFM360K.load_user_table-166"><span class="linenos">166</span></a>            <span class="s1">&#39;Eritrea&#39;</span><span class="p">:</span> <span class="s1">&#39;ER&#39;</span><span class="p">,</span> <span class="s1">&#39;Estonia&#39;</span><span class="p">:</span> <span class="s1">&#39;EE&#39;</span><span class="p">,</span> <span class="s1">&#39;Ethiopia&#39;</span><span class="p">:</span> <span class="s1">&#39;ET&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-167"><a href="#DatasetProcessorLFM360K.load_user_table-167"><span class="linenos">167</span></a>            <span class="s1">&#39;Falkland Islands (Malvinas)&#39;</span><span class="p">:</span> <span class="s1">&#39;FK&#39;</span><span class="p">,</span> <span class="s1">&#39;Faroe Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;FO&#39;</span><span class="p">,</span> <span class="s1">&#39;Fiji&#39;</span><span class="p">:</span> <span class="s1">&#39;FJ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-168"><a href="#DatasetProcessorLFM360K.load_user_table-168"><span class="linenos">168</span></a>            <span class="s1">&#39;Finland&#39;</span><span class="p">:</span> <span class="s1">&#39;FI&#39;</span><span class="p">,</span> <span class="s1">&#39;France&#39;</span><span class="p">:</span> <span class="s1">&#39;FR&#39;</span><span class="p">,</span> <span class="s1">&#39;French Guiana&#39;</span><span class="p">:</span> <span class="s1">&#39;GF&#39;</span><span class="p">,</span> <span class="s1">&#39;French Polynesia&#39;</span><span class="p">:</span> <span class="s1">&#39;PF&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-169"><a href="#DatasetProcessorLFM360K.load_user_table-169"><span class="linenos">169</span></a>            <span class="s1">&#39;French Southern Territories&#39;</span><span class="p">:</span> <span class="s1">&#39;TF&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-170"><a href="#DatasetProcessorLFM360K.load_user_table-170"><span class="linenos">170</span></a>            <span class="s1">&#39;Gabon&#39;</span><span class="p">:</span> <span class="s1">&#39;GA&#39;</span><span class="p">,</span> <span class="s1">&#39;Gambia&#39;</span><span class="p">:</span> <span class="s1">&#39;GM&#39;</span><span class="p">,</span> <span class="s1">&#39;Georgia&#39;</span><span class="p">:</span> <span class="s1">&#39;GE&#39;</span><span class="p">,</span> <span class="s1">&#39;Germany&#39;</span><span class="p">:</span> <span class="s1">&#39;DE&#39;</span><span class="p">,</span> <span class="s1">&#39;Ghana&#39;</span><span class="p">:</span> <span class="s1">&#39;GH&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-171"><a href="#DatasetProcessorLFM360K.load_user_table-171"><span class="linenos">171</span></a>            <span class="s1">&#39;Grenada&#39;</span><span class="p">:</span> <span class="s1">&#39;GD&#39;</span><span class="p">,</span> <span class="s1">&#39;Gibraltar&#39;</span><span class="p">:</span> <span class="s1">&#39;GI&#39;</span><span class="p">,</span> <span class="s1">&#39;Greece&#39;</span><span class="p">:</span> <span class="s1">&#39;GR&#39;</span><span class="p">,</span> <span class="s1">&#39;Greenland&#39;</span><span class="p">:</span> <span class="s1">&#39;GL&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-172"><a href="#DatasetProcessorLFM360K.load_user_table-172"><span class="linenos">172</span></a>            <span class="s1">&#39;Guadeloupe&#39;</span><span class="p">:</span> <span class="s1">&#39;GP&#39;</span><span class="p">,</span> <span class="s1">&#39;Guam&#39;</span><span class="p">:</span> <span class="s1">&#39;GU&#39;</span><span class="p">,</span> <span class="s1">&#39;Guatemala&#39;</span><span class="p">:</span> <span class="s1">&#39;GT&#39;</span><span class="p">,</span> <span class="s1">&#39;Guinea-Bissau&#39;</span><span class="p">:</span> <span class="s1">&#39;GW&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-173"><a href="#DatasetProcessorLFM360K.load_user_table-173"><span class="linenos">173</span></a>            <span class="s1">&#39;Guyana&#39;</span><span class="p">:</span> <span class="s1">&#39;GY&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-174"><a href="#DatasetProcessorLFM360K.load_user_table-174"><span class="linenos">174</span></a>            <span class="s1">&#39;Haiti&#39;</span><span class="p">:</span> <span class="s1">&#39;HT&#39;</span><span class="p">,</span> <span class="s1">&#39;Heard Island and Mcdonald Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;HM&#39;</span><span class="p">,</span> <span class="s1">&#39;Hungary&#39;</span><span class="p">:</span> <span class="s1">&#39;HU&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-175"><a href="#DatasetProcessorLFM360K.load_user_table-175"><span class="linenos">175</span></a>            <span class="s1">&#39;Holy See (Vatican City State)&#39;</span><span class="p">:</span> <span class="s1">&#39;VA&#39;</span><span class="p">,</span> <span class="s1">&#39;Honduras&#39;</span><span class="p">:</span> <span class="s1">&#39;HN&#39;</span><span class="p">,</span> <span class="s1">&#39;Hong Kong&#39;</span><span class="p">:</span> <span class="s1">&#39;HK&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-176"><a href="#DatasetProcessorLFM360K.load_user_table-176"><span class="linenos">176</span></a>            <span class="s1">&#39;Iceland&#39;</span><span class="p">:</span> <span class="s1">&#39;IS&#39;</span><span class="p">,</span> <span class="s1">&#39;India&#39;</span><span class="p">:</span> <span class="s1">&#39;IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Indonesia&#39;</span><span class="p">:</span> <span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Iran, Islamic Republic of&#39;</span><span class="p">:</span> <span class="s1">&#39;IR&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-177"><a href="#DatasetProcessorLFM360K.load_user_table-177"><span class="linenos">177</span></a>            <span class="s1">&#39;Iraq&#39;</span><span class="p">:</span> <span class="s1">&#39;IQ&#39;</span><span class="p">,</span> <span class="s1">&#39;Ireland&#39;</span><span class="p">:</span> <span class="s1">&#39;IE&#39;</span><span class="p">,</span> <span class="s1">&#39;Israel&#39;</span><span class="p">:</span> <span class="s1">&#39;IL&#39;</span><span class="p">,</span> <span class="s1">&#39;Italy&#39;</span><span class="p">:</span> <span class="s1">&#39;IT&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-178"><a href="#DatasetProcessorLFM360K.load_user_table-178"><span class="linenos">178</span></a>            <span class="s1">&#39;Jamaica&#39;</span><span class="p">:</span> <span class="s1">&#39;JM&#39;</span><span class="p">,</span> <span class="s1">&#39;Japan&#39;</span><span class="p">:</span> <span class="s1">&#39;JP&#39;</span><span class="p">,</span> <span class="s1">&#39;Jordan&#39;</span><span class="p">:</span> <span class="s1">&#39;JO&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-179"><a href="#DatasetProcessorLFM360K.load_user_table-179"><span class="linenos">179</span></a>            <span class="s1">&#39;Kazakhstan&#39;</span><span class="p">:</span> <span class="s1">&#39;KZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Kenya&#39;</span><span class="p">:</span> <span class="s1">&#39;KE&#39;</span><span class="p">,</span> <span class="s1">&#39;Kiribati&#39;</span><span class="p">:</span> <span class="s1">&#39;KI&#39;</span><span class="p">,</span> <span class="s1">&#39;Kyrgyzstan&#39;</span><span class="p">:</span> <span class="s1">&#39;KG&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-180"><a href="#DatasetProcessorLFM360K.load_user_table-180"><span class="linenos">180</span></a>            <span class="s1">&#39;Korea, Democratic People</span><span class="se">\&#39;</span><span class="s1">s Republic of&#39;</span><span class="p">:</span><span class="s1">&#39;KP&#39;</span><span class="p">,</span><span class="s1">&#39;Korea, Republic of&#39;</span><span class="p">:</span><span class="s1">&#39;KR&#39;</span><span class="p">,</span><span class="s1">&#39;Kuwait&#39;</span><span class="p">:</span><span class="s1">&#39;KW&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-181"><a href="#DatasetProcessorLFM360K.load_user_table-181"><span class="linenos">181</span></a>            <span class="s1">&#39;Lao People</span><span class="se">\&#39;</span><span class="s1">s Democratic Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;LA&#39;</span><span class="p">,</span><span class="s1">&#39;Latvia&#39;</span><span class="p">:</span> <span class="s1">&#39;LV&#39;</span><span class="p">,</span><span class="s1">&#39;Lebanon&#39;</span><span class="p">:</span> <span class="s1">&#39;LB&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-182"><a href="#DatasetProcessorLFM360K.load_user_table-182"><span class="linenos">182</span></a>            <span class="s1">&#39;Lesotho&#39;</span><span class="p">:</span> <span class="s1">&#39;LS&#39;</span><span class="p">,</span> <span class="s1">&#39;Liberia&#39;</span><span class="p">:</span> <span class="s1">&#39;LR&#39;</span><span class="p">,</span> <span class="s1">&#39;Libyan Arab Jamahiriya&#39;</span><span class="p">:</span> <span class="s1">&#39;LY&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-183"><a href="#DatasetProcessorLFM360K.load_user_table-183"><span class="linenos">183</span></a>            <span class="s1">&#39;Liechtenstein&#39;</span><span class="p">:</span> <span class="s1">&#39;LI&#39;</span><span class="p">,</span> <span class="s1">&#39;Lithuania&#39;</span><span class="p">:</span> <span class="s1">&#39;LT&#39;</span><span class="p">,</span> <span class="s1">&#39;Luxembourg&#39;</span><span class="p">:</span> <span class="s1">&#39;LU&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-184"><a href="#DatasetProcessorLFM360K.load_user_table-184"><span class="linenos">184</span></a>            <span class="s1">&#39;Macao&#39;</span><span class="p">:</span> <span class="s1">&#39;MO&#39;</span><span class="p">,</span> <span class="s1">&#39;Macedonia&#39;</span><span class="p">:</span> <span class="s1">&#39;MK&#39;</span><span class="p">,</span> <span class="s1">&#39;Madagascar&#39;</span><span class="p">:</span> <span class="s1">&#39;MG&#39;</span><span class="p">,</span> <span class="s1">&#39;Mali&#39;</span><span class="p">:</span> <span class="s1">&#39;ML&#39;</span><span class="p">,</span> <span class="s1">&#39;Malta&#39;</span><span class="p">:</span> <span class="s1">&#39;MT&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-185"><a href="#DatasetProcessorLFM360K.load_user_table-185"><span class="linenos">185</span></a>            <span class="s1">&#39;Malaysia&#39;</span><span class="p">:</span> <span class="s1">&#39;MY&#39;</span><span class="p">,</span> <span class="s1">&#39;Malawi&#39;</span><span class="p">:</span> <span class="s1">&#39;MW&#39;</span><span class="p">,</span> <span class="s1">&#39;Maldives&#39;</span><span class="p">:</span> <span class="s1">&#39;MV&#39;</span><span class="p">,</span> <span class="s1">&#39;Mauritania&#39;</span><span class="p">:</span> <span class="s1">&#39;MR&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-186"><a href="#DatasetProcessorLFM360K.load_user_table-186"><span class="linenos">186</span></a>            <span class="s1">&#39;Mauritius&#39;</span><span class="p">:</span> <span class="s1">&#39;MU&#39;</span><span class="p">,</span> <span class="s1">&#39;Marshall Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;MH&#39;</span><span class="p">,</span> <span class="s1">&#39;Martinique&#39;</span><span class="p">:</span> <span class="s1">&#39;MQ&#39;</span><span class="p">,</span> <span class="s1">&#39;Mayotte&#39;</span><span class="p">:</span> <span class="s1">&#39;YT&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-187"><a href="#DatasetProcessorLFM360K.load_user_table-187"><span class="linenos">187</span></a>            <span class="s1">&#39;Mexico&#39;</span><span class="p">:</span> <span class="s1">&#39;MX&#39;</span><span class="p">,</span> <span class="s1">&#39;Micronesia, Federated States of&#39;</span><span class="p">:</span> <span class="s1">&#39;FM&#39;</span><span class="p">,</span><span class="s1">&#39;Moldova&#39;</span><span class="p">:</span> <span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;Monaco&#39;</span><span class="p">:</span> <span class="s1">&#39;MC&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-188"><a href="#DatasetProcessorLFM360K.load_user_table-188"><span class="linenos">188</span></a>            <span class="s1">&#39;Mongolia&#39;</span><span class="p">:</span> <span class="s1">&#39;MN&#39;</span><span class="p">,</span> <span class="s1">&#39;Montenegro&#39;</span><span class="p">:</span> <span class="s1">&#39;ME&#39;</span><span class="p">,</span> <span class="s1">&#39;Montserrat&#39;</span><span class="p">:</span>  <span class="s1">&#39;MS&#39;</span><span class="p">,</span> <span class="s1">&#39;Morocco&#39;</span><span class="p">:</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-189"><a href="#DatasetProcessorLFM360K.load_user_table-189"><span class="linenos">189</span></a>            <span class="s1">&#39;Mozambique&#39;</span><span class="p">:</span> <span class="s1">&#39;MZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Myanmar&#39;</span><span class="p">:</span> <span class="s1">&#39;MM&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-190"><a href="#DatasetProcessorLFM360K.load_user_table-190"><span class="linenos">190</span></a>            <span class="s1">&#39;Namibia&#39;</span><span class="p">:</span> <span class="s1">&#39;NA&#39;</span><span class="p">,</span> <span class="s1">&#39;Nauru&#39;</span><span class="p">:</span> <span class="s1">&#39;NR&#39;</span><span class="p">,</span> <span class="s1">&#39;Nepal&#39;</span><span class="p">:</span> <span class="s1">&#39;NP&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-191"><a href="#DatasetProcessorLFM360K.load_user_table-191"><span class="linenos">191</span></a>            <span class="s1">&#39;Netherlands&#39;</span><span class="p">:</span> <span class="s1">&#39;NL&#39;</span><span class="p">,</span> <span class="s1">&#39;Netherlands Antilles&#39;</span><span class="p">:</span> <span class="s1">&#39;NL&#39;</span><span class="p">,</span> <span class="s1">&#39;New Caledonia&#39;</span><span class="p">:</span> <span class="s1">&#39;NC&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-192"><a href="#DatasetProcessorLFM360K.load_user_table-192"><span class="linenos">192</span></a>            <span class="s1">&#39;New Zealand&#39;</span><span class="p">:</span> <span class="s1">&#39;NZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Nicaragua&#39;</span><span class="p">:</span> <span class="s1">&#39;NI&#39;</span><span class="p">,</span> <span class="s1">&#39;Niger&#39;</span><span class="p">:</span> <span class="s1">&#39;NE&#39;</span><span class="p">,</span> <span class="s1">&#39;Nigeria&#39;</span><span class="p">:</span> <span class="s1">&#39;NG&#39;</span><span class="p">,</span> <span class="s1">&#39;Niue&#39;</span><span class="p">:</span> <span class="s1">&#39;NU&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-193"><a href="#DatasetProcessorLFM360K.load_user_table-193"><span class="linenos">193</span></a>            <span class="s1">&#39;Norfolk Island&#39;</span><span class="p">:</span> <span class="s1">&#39;NF&#39;</span><span class="p">,</span> <span class="s1">&#39;Northern Mariana Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;MP&#39;</span><span class="p">,</span> <span class="s1">&#39;Norway&#39;</span><span class="p">:</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-194"><a href="#DatasetProcessorLFM360K.load_user_table-194"><span class="linenos">194</span></a>            <span class="s1">&#39;Oman&#39;</span><span class="p">:</span> <span class="s1">&#39;OM&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-195"><a href="#DatasetProcessorLFM360K.load_user_table-195"><span class="linenos">195</span></a>            <span class="s1">&#39;Pakistan&#39;</span><span class="p">:</span> <span class="s1">&#39;PK&#39;</span><span class="p">,</span> <span class="s1">&#39;Palau&#39;</span><span class="p">:</span> <span class="s1">&#39;PW&#39;</span><span class="p">,</span><span class="s1">&#39;Palestinian Territory, Occupied&#39;</span><span class="p">:</span> <span class="s1">&#39;PS&#39;</span><span class="p">,</span><span class="s1">&#39;Panama&#39;</span><span class="p">:</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-196"><a href="#DatasetProcessorLFM360K.load_user_table-196"><span class="linenos">196</span></a>            <span class="s1">&#39;Papua New Guinea&#39;</span><span class="p">:</span> <span class="s1">&#39;PG&#39;</span><span class="p">,</span> <span class="s1">&#39;Paraguay&#39;</span><span class="p">:</span> <span class="s1">&#39;PY&#39;</span><span class="p">,</span> <span class="s1">&#39;Peru&#39;</span><span class="p">:</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span> <span class="s1">&#39;Philippines&#39;</span><span class="p">:</span> <span class="s1">&#39;PH&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-197"><a href="#DatasetProcessorLFM360K.load_user_table-197"><span class="linenos">197</span></a>            <span class="s1">&#39;Pitcairn&#39;</span><span class="p">:</span> <span class="s1">&#39;PN&#39;</span><span class="p">,</span> <span class="s1">&#39;Poland&#39;</span><span class="p">:</span> <span class="s1">&#39;PL&#39;</span><span class="p">,</span> <span class="s1">&#39;Portugal&#39;</span><span class="p">:</span> <span class="s1">&#39;PT&#39;</span><span class="p">,</span> <span class="s1">&#39;Puerto Rico&#39;</span><span class="p">:</span> <span class="s1">&#39;PR&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-198"><a href="#DatasetProcessorLFM360K.load_user_table-198"><span class="linenos">198</span></a>            <span class="s1">&#39;Qatar&#39;</span><span class="p">:</span> <span class="s1">&#39;QA&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-199"><a href="#DatasetProcessorLFM360K.load_user_table-199"><span class="linenos">199</span></a>            <span class="s1">&#39;Reunion&#39;</span><span class="p">:</span> <span class="s1">&#39;RE&#39;</span><span class="p">,</span> <span class="s1">&#39;Romania&#39;</span><span class="p">:</span> <span class="s1">&#39;RO&#39;</span><span class="p">,</span> <span class="s1">&#39;Russian Federation&#39;</span><span class="p">:</span> <span class="s1">&#39;RU&#39;</span><span class="p">,</span> <span class="s1">&#39;Rwanda&#39;</span><span class="p">:</span> <span class="s1">&#39;RW&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-200"><a href="#DatasetProcessorLFM360K.load_user_table-200"><span class="linenos">200</span></a>            <span class="s1">&#39;Saint Helena&#39;</span><span class="p">:</span> <span class="s1">&#39;SH&#39;</span><span class="p">,</span> <span class="s1">&#39;Saint Kitts and Nevis&#39;</span><span class="p">:</span> <span class="s1">&#39;KN&#39;</span><span class="p">,</span> <span class="s1">&#39;Saint Lucia&#39;</span><span class="p">:</span> <span class="s1">&#39;LC&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-201"><a href="#DatasetProcessorLFM360K.load_user_table-201"><span class="linenos">201</span></a>            <span class="s1">&#39;Saint Pierre and Miquelon&#39;</span><span class="p">:</span> <span class="s1">&#39;PM&#39;</span><span class="p">,</span> <span class="s1">&#39;Saint Vincent and the Grenadines&#39;</span><span class="p">:</span> <span class="s1">&#39;VC&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-202"><a href="#DatasetProcessorLFM360K.load_user_table-202"><span class="linenos">202</span></a>            <span class="s1">&#39;Samoa&#39;</span><span class="p">:</span> <span class="s1">&#39;WS&#39;</span><span class="p">,</span> <span class="s1">&#39;San Marino&#39;</span><span class="p">:</span> <span class="s1">&#39;SM&#39;</span><span class="p">,</span> <span class="s1">&#39;Sao Tome and Principe&#39;</span><span class="p">:</span> <span class="s1">&#39;ST&#39;</span><span class="p">,</span> <span class="s1">&#39;Saudi Arabia&#39;</span><span class="p">:</span> <span class="s1">&#39;SA&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-203"><a href="#DatasetProcessorLFM360K.load_user_table-203"><span class="linenos">203</span></a>            <span class="s1">&#39;Senegal&#39;</span><span class="p">:</span> <span class="s1">&#39;SN&#39;</span><span class="p">,</span> <span class="s1">&#39;Serbia&#39;</span><span class="p">:</span> <span class="s1">&#39;RS&#39;</span><span class="p">,</span> <span class="s1">&#39;Seychelles&#39;</span><span class="p">:</span> <span class="s1">&#39;SC&#39;</span><span class="p">,</span> <span class="s1">&#39;Sierra Leone&#39;</span><span class="p">:</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-204"><a href="#DatasetProcessorLFM360K.load_user_table-204"><span class="linenos">204</span></a>            <span class="s1">&#39;Singapore&#39;</span><span class="p">:</span> <span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;Solomon Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;SB&#39;</span><span class="p">,</span> <span class="s1">&#39;Somalia&#39;</span><span class="p">:</span> <span class="s1">&#39;SO&#39;</span><span class="p">,</span> <span class="s1">&#39;South Africa&#39;</span><span class="p">:</span> <span class="s1">&#39;ZA&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-205"><a href="#DatasetProcessorLFM360K.load_user_table-205"><span class="linenos">205</span></a>            <span class="s1">&#39;Slovakia&#39;</span><span class="p">:</span> <span class="s1">&#39;SK&#39;</span><span class="p">,</span><span class="s1">&#39;Slovenia&#39;</span><span class="p">:</span> <span class="s1">&#39;SI&#39;</span><span class="p">,</span><span class="s1">&#39;South Georgia and the South Sandwich Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;GS&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-206"><a href="#DatasetProcessorLFM360K.load_user_table-206"><span class="linenos">206</span></a>            <span class="s1">&#39;Spain&#39;</span><span class="p">:</span> <span class="s1">&#39;ES&#39;</span><span class="p">,</span> <span class="s1">&#39;Sri Lanka&#39;</span><span class="p">:</span> <span class="s1">&#39;LK&#39;</span><span class="p">,</span> <span class="s1">&#39;Sudan&#39;</span><span class="p">:</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;Suriname&#39;</span><span class="p">:</span> <span class="s1">&#39;SR&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-207"><a href="#DatasetProcessorLFM360K.load_user_table-207"><span class="linenos">207</span></a>            <span class="s1">&#39;Svalbard and Jan Mayen&#39;</span><span class="p">:</span> <span class="s1">&#39;SJ&#39;</span><span class="p">,</span> <span class="s1">&#39;Syrian Arab Republic&#39;</span><span class="p">:</span> <span class="s1">&#39;SY&#39;</span><span class="p">,</span> <span class="s1">&#39;Swaziland&#39;</span><span class="p">:</span> <span class="s1">&#39;SZ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-208"><a href="#DatasetProcessorLFM360K.load_user_table-208"><span class="linenos">208</span></a>            <span class="s1">&#39;Sweden&#39;</span><span class="p">:</span> <span class="s1">&#39;SE&#39;</span><span class="p">,</span> <span class="s1">&#39;Switzerland&#39;</span><span class="p">:</span> <span class="s1">&#39;CH&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-209"><a href="#DatasetProcessorLFM360K.load_user_table-209"><span class="linenos">209</span></a>            <span class="s1">&#39;Taiwan&#39;</span><span class="p">:</span> <span class="s1">&#39;TW&#39;</span><span class="p">,</span> <span class="s1">&#39;Tajikistan&#39;</span><span class="p">:</span> <span class="s1">&#39;TJ&#39;</span><span class="p">,</span> <span class="s1">&#39;Tanzania, United Republic of&#39;</span><span class="p">:</span> <span class="s1">&#39;TZ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-210"><a href="#DatasetProcessorLFM360K.load_user_table-210"><span class="linenos">210</span></a>            <span class="s1">&#39;Thailand&#39;</span><span class="p">:</span> <span class="s1">&#39;TH&#39;</span><span class="p">,</span> <span class="s1">&#39;Timor-Leste&#39;</span><span class="p">:</span> <span class="s1">&#39;TL&#39;</span><span class="p">,</span> <span class="s1">&#39;Togo&#39;</span><span class="p">:</span> <span class="s1">&#39;TG&#39;</span><span class="p">,</span> <span class="s1">&#39;Tokelau&#39;</span><span class="p">:</span> <span class="s1">&#39;TK&#39;</span><span class="p">,</span> <span class="s1">&#39;Tonga&#39;</span><span class="p">:</span> <span class="s1">&#39;TO&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-211"><a href="#DatasetProcessorLFM360K.load_user_table-211"><span class="linenos">211</span></a>            <span class="s1">&#39;Trinidad and Tobago&#39;</span><span class="p">:</span> <span class="s1">&#39;TT&#39;</span><span class="p">,</span> <span class="s1">&#39;Tunisia&#39;</span><span class="p">:</span> <span class="s1">&#39;TN&#39;</span><span class="p">,</span> <span class="s1">&#39;Turkey&#39;</span><span class="p">:</span> <span class="s1">&#39;TR&#39;</span><span class="p">,</span> <span class="s1">&#39;Turkmenistan&#39;</span><span class="p">:</span> <span class="s1">&#39;TM&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-212"><a href="#DatasetProcessorLFM360K.load_user_table-212"><span class="linenos">212</span></a>            <span class="s1">&#39;Turks and Caicos Islands&#39;</span><span class="p">:</span> <span class="s1">&#39;TC&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuvalu&#39;</span><span class="p">:</span> <span class="s1">&#39;TV&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-213"><a href="#DatasetProcessorLFM360K.load_user_table-213"><span class="linenos">213</span></a>            <span class="s1">&#39;Uganda&#39;</span><span class="p">:</span> <span class="s1">&#39;UG&#39;</span><span class="p">,</span> <span class="s1">&#39;Ukraine&#39;</span><span class="p">:</span> <span class="s1">&#39;UA&#39;</span><span class="p">,</span> <span class="s1">&#39;United Arab Emirates&#39;</span><span class="p">:</span> <span class="s1">&#39;AE&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-214"><a href="#DatasetProcessorLFM360K.load_user_table-214"><span class="linenos">214</span></a>            <span class="s1">&#39;United Kingdom&#39;</span><span class="p">:</span><span class="s1">&#39;GB&#39;</span><span class="p">,</span><span class="s1">&#39;United States&#39;</span><span class="p">:</span><span class="s1">&#39;US&#39;</span><span class="p">,</span><span class="s1">&#39;United States Minor Outlying Islands&#39;</span><span class="p">:</span><span class="s1">&#39;UM&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-215"><a href="#DatasetProcessorLFM360K.load_user_table-215"><span class="linenos">215</span></a>            <span class="s1">&#39;Uruguay&#39;</span><span class="p">:</span> <span class="s1">&#39;UY&#39;</span><span class="p">,</span> <span class="s1">&#39;Uzbekistan&#39;</span><span class="p">:</span> <span class="s1">&#39;UZ&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-216"><a href="#DatasetProcessorLFM360K.load_user_table-216"><span class="linenos">216</span></a>            <span class="s1">&#39;Vanuatu&#39;</span><span class="p">:</span> <span class="s1">&#39;VU&#39;</span><span class="p">,</span> <span class="s1">&#39;Venezuela&#39;</span><span class="p">:</span> <span class="s1">&#39;VE&#39;</span><span class="p">,</span> <span class="s1">&#39;Viet Nam&#39;</span><span class="p">:</span> <span class="s1">&#39;VN&#39;</span><span class="p">,</span> <span class="s1">&#39;Virgin Islands, British&#39;</span><span class="p">:</span> <span class="s1">&#39;VG&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-217"><a href="#DatasetProcessorLFM360K.load_user_table-217"><span class="linenos">217</span></a>            <span class="s1">&#39;Virgin Islands, U.s.&#39;</span><span class="p">:</span> <span class="s1">&#39;VI&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-218"><a href="#DatasetProcessorLFM360K.load_user_table-218"><span class="linenos">218</span></a>            <span class="s1">&#39;Yemen&#39;</span><span class="p">:</span> <span class="s1">&#39;YE&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-219"><a href="#DatasetProcessorLFM360K.load_user_table-219"><span class="linenos">219</span></a>            <span class="s1">&#39;Wallis and Futuna&#39;</span><span class="p">:</span> <span class="s1">&#39;WF&#39;</span><span class="p">,</span> <span class="s1">&#39;Western Sahara&#39;</span><span class="p">:</span> <span class="s1">&#39;EH&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-220"><a href="#DatasetProcessorLFM360K.load_user_table-220"><span class="linenos">220</span></a>            <span class="s1">&#39;Zambia&#39;</span><span class="p">:</span> <span class="s1">&#39;ZM&#39;</span><span class="p">,</span> <span class="s1">&#39;Zimbabwe&#39;</span><span class="p">:</span> <span class="s1">&#39;ZW&#39;</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-221"><a href="#DatasetProcessorLFM360K.load_user_table-221"><span class="linenos">221</span></a>        <span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.load_user_table-222"><a href="#DatasetProcessorLFM360K.load_user_table-222"><span class="linenos">222</span></a>
</span><span id="DatasetProcessorLFM360K.load_user_table-223"><a href="#DatasetProcessorLFM360K.load_user_table-223"><span class="linenos">223</span></a>        <span class="k">return</span> <span class="n">user_table</span>
</span></pre></div>


            <div class="docstring"><p>Load the original user table.</p>

<p>Changes the contents of the age and gender columns to be more user-friendly,
and the contents of the country column to ISO 3166 Alpha-2 country codes.</p>

<p>Returns:
    the loaded user table on None on failure.</p>
</div>


                            </div>
                            <div id="DatasetProcessorLFM360K.process_artist_table" class="classattr">
                                        <input id="DatasetProcessorLFM360K.process_artist_table-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">process_artist_table</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="n">src</span><span class="o">.</span><span class="n">fairreckitlib</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">DatasetTableConfig</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DatasetProcessorLFM360K.process_artist_table-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatasetProcessorLFM360K.process_artist_table"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatasetProcessorLFM360K.process_artist_table-225"><a href="#DatasetProcessorLFM360K.process_artist_table-225"><span class="linenos">225</span></a>    <span class="k">def</span> <span class="nf">process_artist_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetTableConfig</span><span class="p">]:</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-226"><a href="#DatasetProcessorLFM360K.process_artist_table-226"><span class="linenos">226</span></a>        <span class="sd">&quot;&quot;&quot;Process the artist table.</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-227"><a href="#DatasetProcessorLFM360K.process_artist_table-227"><span class="linenos">227</span></a>
</span><span id="DatasetProcessorLFM360K.process_artist_table-228"><a href="#DatasetProcessorLFM360K.process_artist_table-228"><span class="linenos">228</span></a><span class="sd">        Creates the artist table with the musicbrainzID and gender information when available.</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-229"><a href="#DatasetProcessorLFM360K.process_artist_table-229"><span class="linenos">229</span></a>
</span><span id="DatasetProcessorLFM360K.process_artist_table-230"><a href="#DatasetProcessorLFM360K.process_artist_table-230"><span class="linenos">230</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-231"><a href="#DatasetProcessorLFM360K.process_artist_table-231"><span class="linenos">231</span></a><span class="sd">            the artist table configuration or None on failure.</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-232"><a href="#DatasetProcessorLFM360K.process_artist_table-232"><span class="linenos">232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-233"><a href="#DatasetProcessorLFM360K.process_artist_table-233"><span class="linenos">233</span></a>        <span class="n">artist_key</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;artist_id&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-234"><a href="#DatasetProcessorLFM360K.process_artist_table-234"><span class="linenos">234</span></a>        <span class="n">artist_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-235"><a href="#DatasetProcessorLFM360K.process_artist_table-235"><span class="linenos">235</span></a>
</span><span id="DatasetProcessorLFM360K.process_artist_table-236"><a href="#DatasetProcessorLFM360K.process_artist_table-236"><span class="linenos">236</span></a>        <span class="c1"># connect artist id to name</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-237"><a href="#DatasetProcessorLFM360K.process_artist_table-237"><span class="linenos">237</span></a>        <span class="n">artist_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-238"><a href="#DatasetProcessorLFM360K.process_artist_table-238"><span class="linenos">238</span></a>            <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">artist_list</span><span class="p">)),</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-239"><a href="#DatasetProcessorLFM360K.process_artist_table-239"><span class="linenos">239</span></a>            <span class="n">columns</span><span class="o">=</span><span class="n">artist_key</span> <span class="o">+</span> <span class="n">artist_columns</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-240"><a href="#DatasetProcessorLFM360K.process_artist_table-240"><span class="linenos">240</span></a>        <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-241"><a href="#DatasetProcessorLFM360K.process_artist_table-241"><span class="linenos">241</span></a>
</span><span id="DatasetProcessorLFM360K.process_artist_table-242"><a href="#DatasetProcessorLFM360K.process_artist_table-242"><span class="linenos">242</span></a>        <span class="c1"># merge the artist musicbrainzID on name</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-243"><a href="#DatasetProcessorLFM360K.process_artist_table-243"><span class="linenos">243</span></a>        <span class="n">artist_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">artist_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;artist_name&#39;</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-244"><a href="#DatasetProcessorLFM360K.process_artist_table-244"><span class="linenos">244</span></a>        <span class="n">artist_table</span><span class="p">[</span><span class="s1">&#39;artist_mbID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-245"><a href="#DatasetProcessorLFM360K.process_artist_table-245"><span class="linenos">245</span></a>        <span class="n">artist_columns</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;artist_mbID&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-246"><a href="#DatasetProcessorLFM360K.process_artist_table-246"><span class="linenos">246</span></a>
</span><span id="DatasetProcessorLFM360K.process_artist_table-247"><a href="#DatasetProcessorLFM360K.process_artist_table-247"><span class="linenos">247</span></a>        <span class="n">artist_gender</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_artist_gender_json</span><span class="p">()</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-248"><a href="#DatasetProcessorLFM360K.process_artist_table-248"><span class="linenos">248</span></a>        <span class="k">if</span> <span class="n">artist_gender</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-249"><a href="#DatasetProcessorLFM360K.process_artist_table-249"><span class="linenos">249</span></a>            <span class="c1"># merge artists with gender and update columns</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-250"><a href="#DatasetProcessorLFM360K.process_artist_table-250"><span class="linenos">250</span></a>            <span class="n">artist_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">artist_table</span><span class="p">,</span> <span class="n">artist_gender</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;artist_mbID&#39;</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-251"><a href="#DatasetProcessorLFM360K.process_artist_table-251"><span class="linenos">251</span></a>            <span class="n">artist_columns</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;artist_gender&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-252"><a href="#DatasetProcessorLFM360K.process_artist_table-252"><span class="linenos">252</span></a>
</span><span id="DatasetProcessorLFM360K.process_artist_table-253"><a href="#DatasetProcessorLFM360K.process_artist_table-253"><span class="linenos">253</span></a>        <span class="c1"># create artist table configuration</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-254"><a href="#DatasetProcessorLFM360K.process_artist_table-254"><span class="linenos">254</span></a>        <span class="n">artist_table_config</span> <span class="o">=</span> <span class="n">create_dataset_table_config</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-255"><a href="#DatasetProcessorLFM360K.process_artist_table-255"><span class="linenos">255</span></a>            <span class="n">TABLE_FILE_PREFIX</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s1">&#39;_artists.tsv.bz2&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-256"><a href="#DatasetProcessorLFM360K.process_artist_table-256"><span class="linenos">256</span></a>            <span class="n">artist_key</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-257"><a href="#DatasetProcessorLFM360K.process_artist_table-257"><span class="linenos">257</span></a>            <span class="n">artist_columns</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-258"><a href="#DatasetProcessorLFM360K.process_artist_table-258"><span class="linenos">258</span></a>            <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;bz2&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-259"><a href="#DatasetProcessorLFM360K.process_artist_table-259"><span class="linenos">259</span></a>            <span class="n">num_records</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">artist_list</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-260"><a href="#DatasetProcessorLFM360K.process_artist_table-260"><span class="linenos">260</span></a>        <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-261"><a href="#DatasetProcessorLFM360K.process_artist_table-261"><span class="linenos">261</span></a>
</span><span id="DatasetProcessorLFM360K.process_artist_table-262"><a href="#DatasetProcessorLFM360K.process_artist_table-262"><span class="linenos">262</span></a>        <span class="c1"># store the generated artist table</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-263"><a href="#DatasetProcessorLFM360K.process_artist_table-263"><span class="linenos">263</span></a>        <span class="n">artist_table_config</span><span class="o">.</span><span class="n">save_table</span><span class="p">(</span><span class="n">artist_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_artist_table-264"><a href="#DatasetProcessorLFM360K.process_artist_table-264"><span class="linenos">264</span></a>
</span><span id="DatasetProcessorLFM360K.process_artist_table-265"><a href="#DatasetProcessorLFM360K.process_artist_table-265"><span class="linenos">265</span></a>        <span class="k">return</span> <span class="n">artist_table_config</span>
</span></pre></div>


            <div class="docstring"><p>Process the artist table.</p>

<p>Creates the artist table with the musicbrainzID and gender information when available.</p>

<p>Returns:
    the artist table configuration or None on failure.</p>
</div>


                            </div>
                            <div id="DatasetProcessorLFM360K.process_user_artist_matrix" class="classattr">
                                        <input id="DatasetProcessorLFM360K.process_user_artist_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">process_user_artist_matrix</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="n">src</span><span class="o">.</span><span class="n">fairreckitlib</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">DatasetMatrixConfig</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DatasetProcessorLFM360K.process_user_artist_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatasetProcessorLFM360K.process_user_artist_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-267"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-267"><span class="linenos">267</span></a>    <span class="k">def</span> <span class="nf">process_user_artist_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetMatrixConfig</span><span class="p">]:</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-268"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-268"><span class="linenos">268</span></a>        <span class="sd">&quot;&quot;&quot;Process the user-artist-count matrix.</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-269"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-269"><span class="linenos">269</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-270"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-270"><span class="linenos">270</span></a><span class="sd">        The user-item matrix is stored in a file that also contains a musicbrainzID.</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-271"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-271"><span class="linenos">271</span></a><span class="sd">        The users are hashes and the items are names, both are converted to integers</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-272"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-272"><span class="linenos">272</span></a><span class="sd">        to comply to the CSR compatible format. In addition, any rows that contain</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-273"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-273"><span class="linenos">273</span></a><span class="sd">        corrupt data are removed in the process.</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-274"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-274"><span class="linenos">274</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-275"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-275"><span class="linenos">275</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-276"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-276"><span class="linenos">276</span></a><span class="sd">            the matrix configuration or None on failure.</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-277"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-278"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-278"><span class="linenos">278</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-279"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-279"><span class="linenos">279</span></a>            <span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-280"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-280"><span class="linenos">280</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="s1">&#39;usersha1-artmbid-artname-plays.tsv&#39;</span><span class="p">),</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-281"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-281"><span class="linenos">281</span></a>                <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_mbID&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_name&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_count&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-282"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-282"><span class="linenos">282</span></a>            <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-283"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-283"><span class="linenos">283</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-284"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-284"><span class="linenos">284</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-285"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-285"><span class="linenos">285</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-286"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-286"><span class="linenos">286</span></a>        <span class="c1"># remove rows from a user that is not a hash</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-287"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-287"><span class="linenos">287</span></a>        <span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;sep 20, 2008&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-288"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-288"><span class="linenos">288</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-289"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-289"><span class="linenos">289</span></a>        <span class="c1"># map users/items to category and ratings to be floating-point</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-290"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-290"><span class="linenos">290</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-291"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-291"><span class="linenos">291</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-292"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-292"><span class="linenos">292</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;matrix_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;matrix_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-293"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-293"><span class="linenos">293</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-294"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-294"><span class="linenos">294</span></a>        <span class="c1"># remove rows that contain items that failed to map to category</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-295"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-295"><span class="linenos">295</span></a>        <span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-296"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-296"><span class="linenos">296</span></a>        <span class="c1"># remove rows that have unusable ratings</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-297"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-297"><span class="linenos">297</span></a>        <span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;matrix_count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-298"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-298"><span class="linenos">298</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-299"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-299"><span class="linenos">299</span></a>        <span class="n">dataframe</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_name&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-300"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-300"><span class="linenos">300</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-301"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-301"><span class="linenos">301</span></a>        <span class="c1"># extract user/item indirection arrays</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-302"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-302"><span class="linenos">302</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">user_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-303"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-303"><span class="linenos">303</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-304"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-304"><span class="linenos">304</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-305"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-305"><span class="linenos">305</span></a>        <span class="c1"># extract artist name/musicbrainzID combinations</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-306"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_mbID&#39;</span><span class="p">]]</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-307"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-307"><span class="linenos">307</span></a>        <span class="c1"># remove duplicates combinations</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-308"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-308"><span class="linenos">308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-309"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-309"><span class="linenos">309</span></a>        <span class="c1"># remove duplicates where the artist has more than one musicbrainzID</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-310"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">artist_mb_id</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;artist_name&#39;</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-311"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-311"><span class="linenos">311</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-312"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-312"><span class="linenos">312</span></a>        <span class="c1"># add the correct user/item integers</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-313"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-313"><span class="linenos">313</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;user_sha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-314"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-314"><span class="linenos">314</span></a>        <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;artist_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-315"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-315"><span class="linenos">315</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-316"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-316"><span class="linenos">316</span></a>        <span class="c1"># create matrix by removing other columns</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-317"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-317"><span class="linenos">317</span></a>        <span class="n">user_artist_matrix</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_id&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_count&#39;</span><span class="p">]]</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-318"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-318"><span class="linenos">318</span></a>        <span class="n">user_artist_matrix_table_config</span> <span class="o">=</span> <span class="n">create_dataset_table_config</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-319"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-319"><span class="linenos">319</span></a>            <span class="n">TABLE_FILE_PREFIX</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s1">&#39;_user-artist-count_matrix.tsv.bz2&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-320"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-320"><span class="linenos">320</span></a>            <span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_id&#39;</span><span class="p">],</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-321"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-321"><span class="linenos">321</span></a>            <span class="p">[</span><span class="s1">&#39;matrix_count&#39;</span><span class="p">],</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-322"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-322"><span class="linenos">322</span></a>            <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;bz2&#39;</span><span class="p">,</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-323"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-323"><span class="linenos">323</span></a>            <span class="n">foreign_keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;artist_id&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-324"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-324"><span class="linenos">324</span></a>        <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-325"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-325"><span class="linenos">325</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-326"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-326"><span class="linenos">326</span></a>        <span class="c1"># store the resulting matrix</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-327"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-327"><span class="linenos">327</span></a>        <span class="n">user_artist_matrix_table_config</span><span class="o">.</span><span class="n">save_table</span><span class="p">(</span><span class="n">user_artist_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-328"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-328"><span class="linenos">328</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_artist_matrix-329"><a href="#DatasetProcessorLFM360K.process_user_artist_matrix-329"><span class="linenos">329</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_matrix</span><span class="p">(</span><span class="n">user_artist_matrix_table_config</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Process the user-artist-count matrix.</p>

<p>The user-item matrix is stored in a file that also contains a musicbrainzID.
The users are hashes and the items are names, both are converted to integers
to comply to the CSR compatible format. In addition, any rows that contain
corrupt data are removed in the process.</p>

<p>Returns:
    the matrix configuration or None on failure.</p>
</div>


                            </div>
                            <div id="DatasetProcessorLFM360K.process_user_table" class="classattr">
                                        <input id="DatasetProcessorLFM360K.process_user_table-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">process_user_table</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="n">src</span><span class="o">.</span><span class="n">fairreckitlib</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">DatasetTableConfig</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DatasetProcessorLFM360K.process_user_table-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatasetProcessorLFM360K.process_user_table"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatasetProcessorLFM360K.process_user_table-331"><a href="#DatasetProcessorLFM360K.process_user_table-331"><span class="linenos">331</span></a>    <span class="k">def</span> <span class="nf">process_user_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetTableConfig</span><span class="p">]:</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-332"><a href="#DatasetProcessorLFM360K.process_user_table-332"><span class="linenos">332</span></a>        <span class="sd">&quot;&quot;&quot;Process the user table.</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-333"><a href="#DatasetProcessorLFM360K.process_user_table-333"><span class="linenos">333</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_table-334"><a href="#DatasetProcessorLFM360K.process_user_table-334"><span class="linenos">334</span></a><span class="sd">        Extends the original user table with unique user ids.</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-335"><a href="#DatasetProcessorLFM360K.process_user_table-335"><span class="linenos">335</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_table-336"><a href="#DatasetProcessorLFM360K.process_user_table-336"><span class="linenos">336</span></a><span class="sd">        Returns:</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-337"><a href="#DatasetProcessorLFM360K.process_user_table-337"><span class="linenos">337</span></a><span class="sd">            the user table configuration or None on failure.</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-338"><a href="#DatasetProcessorLFM360K.process_user_table-338"><span class="linenos">338</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-339"><a href="#DatasetProcessorLFM360K.process_user_table-339"><span class="linenos">339</span></a>        <span class="n">user_table_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_user_table_config</span><span class="p">()</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-340"><a href="#DatasetProcessorLFM360K.process_user_table-340"><span class="linenos">340</span></a>        <span class="c1"># connect user id to sha</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-341"><a href="#DatasetProcessorLFM360K.process_user_table-341"><span class="linenos">341</span></a>        <span class="n">user_sha_ids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-342"><a href="#DatasetProcessorLFM360K.process_user_table-342"><span class="linenos">342</span></a>            <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_list</span><span class="p">)),</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-343"><a href="#DatasetProcessorLFM360K.process_user_table-343"><span class="linenos">343</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;user_sha&#39;</span><span class="p">]</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-344"><a href="#DatasetProcessorLFM360K.process_user_table-344"><span class="linenos">344</span></a>        <span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-345"><a href="#DatasetProcessorLFM360K.process_user_table-345"><span class="linenos">345</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_table-346"><a href="#DatasetProcessorLFM360K.process_user_table-346"><span class="linenos">346</span></a>        <span class="c1"># load original user table and when available, add it to user id/sha</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-347"><a href="#DatasetProcessorLFM360K.process_user_table-347"><span class="linenos">347</span></a>        <span class="n">user_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_user_table</span><span class="p">()</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-348"><a href="#DatasetProcessorLFM360K.process_user_table-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="n">user_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-349"><a href="#DatasetProcessorLFM360K.process_user_table-349"><span class="linenos">349</span></a>            <span class="n">user_table</span> <span class="o">=</span> <span class="n">user_sha_ids</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-350"><a href="#DatasetProcessorLFM360K.process_user_table-350"><span class="linenos">350</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-351"><a href="#DatasetProcessorLFM360K.process_user_table-351"><span class="linenos">351</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">user_table</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-352"><a href="#DatasetProcessorLFM360K.process_user_table-352"><span class="linenos">352</span></a>                <span class="n">user_table_config</span><span class="o">.</span><span class="n">columns</span> <span class="o">+=</span> <span class="p">[</span><span class="n">user_table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-353"><a href="#DatasetProcessorLFM360K.process_user_table-353"><span class="linenos">353</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_table-354"><a href="#DatasetProcessorLFM360K.process_user_table-354"><span class="linenos">354</span></a>            <span class="c1"># join user table with user ids</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-355"><a href="#DatasetProcessorLFM360K.process_user_table-355"><span class="linenos">355</span></a>            <span class="n">user_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">user_sha_ids</span><span class="p">,</span> <span class="n">user_table</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;user_sha&#39;</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-356"><a href="#DatasetProcessorLFM360K.process_user_table-356"><span class="linenos">356</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_table-357"><a href="#DatasetProcessorLFM360K.process_user_table-357"><span class="linenos">357</span></a>            <span class="c1"># fill unknown user age with -1 and cast back to int</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-358"><a href="#DatasetProcessorLFM360K.process_user_table-358"><span class="linenos">358</span></a>            <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-359"><a href="#DatasetProcessorLFM360K.process_user_table-359"><span class="linenos">359</span></a>            <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_table</span><span class="p">[</span><span class="s1">&#39;user_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-360"><a href="#DatasetProcessorLFM360K.process_user_table-360"><span class="linenos">360</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_table-361"><a href="#DatasetProcessorLFM360K.process_user_table-361"><span class="linenos">361</span></a>        <span class="c1"># store the generated user table</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-362"><a href="#DatasetProcessorLFM360K.process_user_table-362"><span class="linenos">362</span></a>        <span class="n">user_table_config</span><span class="o">.</span><span class="n">save_table</span><span class="p">(</span><span class="n">user_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_dir</span><span class="p">)</span>
</span><span id="DatasetProcessorLFM360K.process_user_table-363"><a href="#DatasetProcessorLFM360K.process_user_table-363"><span class="linenos">363</span></a>
</span><span id="DatasetProcessorLFM360K.process_user_table-364"><a href="#DatasetProcessorLFM360K.process_user_table-364"><span class="linenos">364</span></a>        <span class="k">return</span> <span class="n">user_table_config</span>
</span></pre></div>


            <div class="docstring"><p>Process the user table.</p>

<p>Extends the original user table with unique user ids.</p>

<p>Returns:
    the user table configuration or None on failure.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="dataset_processor_lfm.html#DatasetProcessorLFM">src.fairreckitlib.data.set.processor.dataset_processor_lfm.DatasetProcessorLFM</a></dt>
                                <dd id="DatasetProcessorLFM360K.get_event_configs" class="function"><a href="dataset_processor_lfm.html#DatasetProcessorLFM.get_event_configs">get_event_configs</a></dd>
                <dd id="DatasetProcessorLFM360K.process_listening_events" class="function"><a href="dataset_processor_lfm.html#DatasetProcessorLFM.process_listening_events">process_listening_events</a></dd>
                <dd id="DatasetProcessorLFM360K.process_matrix" class="function"><a href="dataset_processor_lfm.html#DatasetProcessorLFM.process_matrix">process_matrix</a></dd>

            </div>
            <div><dt><a href="dataset_processor_base.html#DatasetProcessorBase">src.fairreckitlib.data.set.processor.dataset_processor_base.DatasetProcessorBase</a></dt>
                                <dd id="DatasetProcessorLFM360K.run_event_table_processors" class="function"><a href="dataset_processor_base.html#DatasetProcessorBase.run_event_table_processors">run_event_table_processors</a></dd>
                <dd id="DatasetProcessorLFM360K.run_matrix_table_processors" class="function"><a href="dataset_processor_base.html#DatasetProcessorBase.run_matrix_table_processors">run_matrix_table_processors</a></dd>
                <dd id="DatasetProcessorLFM360K.run_table_processors" class="function"><a href="dataset_processor_base.html#DatasetProcessorBase.run_table_processors">run_table_processors</a></dd>
                <dd id="DatasetProcessorLFM360K.run" class="function"><a href="dataset_processor_base.html#DatasetProcessorBase.run">run</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">${doc.signature}:</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>